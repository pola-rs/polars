<meta http-equiv="refresh" content="0; url=https://docs.pola.rs/api/python/stable/reference/expressions/index.html">

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" sizes="32x32" href="https://raw.githubusercontent.com/pola-rs/polars-static/master/icons/favicon-32x32.png" type="image/png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/pola-rs/polars-static/master/icons/touchicon-180x180.png" type="image/png">
    <title>Expressions &#8212; Polars  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=676d18ee" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script src="../../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=ccdb6887"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/expressions/index';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.14.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.pola.rs/docs/python/dev/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.20';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <script data-domain="docs.pola.rs,combined.pola.rs" defer="defer" src="https://plausible.io/js/script.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Aggregation" href="aggregation.html" />
    <link rel="prev" title="polars.Series.dt.year" href="../series/api/polars.Series.dt.year.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="https://raw.githubusercontent.com/pola-rs/polars-static/master/logos/polars-logo-dark-medium.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="https://raw.githubusercontent.com/pola-rs/polars-static/master/logos/polars-logo-dimmed-medium.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Python API reference
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://docs.pola.rs/user-guide/">
                    User guide
                  </a>
                </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="versionswitcherbutton" type="button" role="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="listbox" aria-controls="versionswitcherlist" aria-label="Version switcher list">
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="versionswitcherlist" class="version-switcher__menu dropdown-menu list-group-flush py-0" role="listbox" aria-labelledby="versionswitcherbutton">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pola-rs/polars" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/4UfP5cfBE7" title="Discord" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Discord</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/DataPolars" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Python API reference
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://docs.pola.rs/user-guide/">
                    User guide
                  </a>
                </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="versionswitcherbutton" type="button" role="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="listbox" aria-controls="versionswitcherlist" aria-label="Version switcher list">
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="versionswitcherlist" class="version-switcher__menu dropdown-menu list-group-flush py-0" role="listbox" aria-labelledby="versionswitcherbutton">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pola-rs/polars" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/4UfP5cfBE7" title="Discord" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Discord</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/DataPolars" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../dataframe/index.html">DataFrame</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dataframe/aggregation.html">Aggregation</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.count.html">polars.DataFrame.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.max.html">polars.DataFrame.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.max_horizontal.html">polars.DataFrame.max_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.mean.html">polars.DataFrame.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.mean_horizontal.html">polars.DataFrame.mean_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.median.html">polars.DataFrame.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.min.html">polars.DataFrame.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.min_horizontal.html">polars.DataFrame.min_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.product.html">polars.DataFrame.product</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.quantile.html">polars.DataFrame.quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.std.html">polars.DataFrame.std</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.sum.html">polars.DataFrame.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.sum_horizontal.html">polars.DataFrame.sum_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.var.html">polars.DataFrame.var</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dataframe/attributes.html">Attributes</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.columns.html">polars.DataFrame.columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.dtypes.html">polars.DataFrame.dtypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.flags.html">polars.DataFrame.flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.height.html">polars.DataFrame.height</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.schema.html">polars.DataFrame.schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.shape.html">polars.DataFrame.shape</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.width.html">polars.DataFrame.width</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dataframe/computation.html">Computation</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.fold.html">polars.DataFrame.fold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.hash_rows.html">polars.DataFrame.hash_rows</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dataframe/descriptive.html">Descriptive</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.approx_n_unique.html">polars.DataFrame.approx_n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.describe.html">polars.DataFrame.describe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.estimated_size.html">polars.DataFrame.estimated_size</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.glimpse.html">polars.DataFrame.glimpse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.is_duplicated.html">polars.DataFrame.is_duplicated</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.is_empty.html">polars.DataFrame.is_empty</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.is_unique.html">polars.DataFrame.is_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.n_chunks.html">polars.DataFrame.n_chunks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.n_unique.html">polars.DataFrame.n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.null_count.html">polars.DataFrame.null_count</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dataframe/export.html">Export</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.__dataframe__.html">polars.DataFrame.__dataframe__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.to_arrow.html">polars.DataFrame.to_arrow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.to_dict.html">polars.DataFrame.to_dict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.to_dicts.html">polars.DataFrame.to_dicts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.to_init_repr.html">polars.DataFrame.to_init_repr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.to_jax.html">polars.DataFrame.to_jax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.to_numpy.html">polars.DataFrame.to_numpy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.to_pandas.html">polars.DataFrame.to_pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.to_struct.html">polars.DataFrame.to_struct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.to_torch.html">polars.DataFrame.to_torch</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dataframe/group_by.html">GroupBy</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.__iter__.html">polars.dataframe.group_by.GroupBy.__iter__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.agg.html">polars.dataframe.group_by.GroupBy.agg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.all.html">polars.dataframe.group_by.GroupBy.all</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.apply.html">polars.dataframe.group_by.GroupBy.apply</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.count.html">polars.dataframe.group_by.GroupBy.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.first.html">polars.dataframe.group_by.GroupBy.first</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.head.html">polars.dataframe.group_by.GroupBy.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.last.html">polars.dataframe.group_by.GroupBy.last</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.len.html">polars.dataframe.group_by.GroupBy.len</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.map_groups.html">polars.dataframe.group_by.GroupBy.map_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.max.html">polars.dataframe.group_by.GroupBy.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.mean.html">polars.dataframe.group_by.GroupBy.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.median.html">polars.dataframe.group_by.GroupBy.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.min.html">polars.dataframe.group_by.GroupBy.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.n_unique.html">polars.dataframe.group_by.GroupBy.n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.quantile.html">polars.dataframe.group_by.GroupBy.quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.sum.html">polars.dataframe.group_by.GroupBy.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.dataframe.group_by.GroupBy.tail.html">polars.dataframe.group_by.GroupBy.tail</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dataframe/modify_select.html">Manipulation/selection</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.bottom_k.html">polars.DataFrame.bottom_k</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.cast.html">polars.DataFrame.cast</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.clear.html">polars.DataFrame.clear</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.clone.html">polars.DataFrame.clone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.drop.html">polars.DataFrame.drop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.drop_in_place.html">polars.DataFrame.drop_in_place</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.drop_nulls.html">polars.DataFrame.drop_nulls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.explode.html">polars.DataFrame.explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.extend.html">polars.DataFrame.extend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.fill_nan.html">polars.DataFrame.fill_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.fill_null.html">polars.DataFrame.fill_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.filter.html">polars.DataFrame.filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.find_idx_by_name.html">polars.DataFrame.find_idx_by_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.gather_every.html">polars.DataFrame.gather_every</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.get_column.html">polars.DataFrame.get_column</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.get_column_index.html">polars.DataFrame.get_column_index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.get_columns.html">polars.DataFrame.get_columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.group_by.html">polars.DataFrame.group_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.group_by_dynamic.html">polars.DataFrame.group_by_dynamic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.group_by_rolling.html">polars.DataFrame.group_by_rolling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.groupby.html">polars.DataFrame.groupby</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.groupby_dynamic.html">polars.DataFrame.groupby_dynamic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.groupby_rolling.html">polars.DataFrame.groupby_rolling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.head.html">polars.DataFrame.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.hstack.html">polars.DataFrame.hstack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.insert_at_idx.html">polars.DataFrame.insert_at_idx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.insert_column.html">polars.DataFrame.insert_column</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.interpolate.html">polars.DataFrame.interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.item.html">polars.DataFrame.item</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.iter_columns.html">polars.DataFrame.iter_columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.iter_rows.html">polars.DataFrame.iter_rows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.iter_slices.html">polars.DataFrame.iter_slices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.join.html">polars.DataFrame.join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.join_asof.html">polars.DataFrame.join_asof</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.limit.html">polars.DataFrame.limit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.melt.html">polars.DataFrame.melt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.merge_sorted.html">polars.DataFrame.merge_sorted</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.partition_by.html">polars.DataFrame.partition_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.pipe.html">polars.DataFrame.pipe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.pivot.html">polars.DataFrame.pivot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.rechunk.html">polars.DataFrame.rechunk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.rename.html">polars.DataFrame.rename</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.replace.html">polars.DataFrame.replace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.replace_at_idx.html">polars.DataFrame.replace_at_idx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.replace_column.html">polars.DataFrame.replace_column</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.reverse.html">polars.DataFrame.reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.rolling.html">polars.DataFrame.rolling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.row.html">polars.DataFrame.row</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.rows.html">polars.DataFrame.rows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.rows_by_key.html">polars.DataFrame.rows_by_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.sample.html">polars.DataFrame.sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.select.html">polars.DataFrame.select</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.select_seq.html">polars.DataFrame.select_seq</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.set_sorted.html">polars.DataFrame.set_sorted</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.shift.html">polars.DataFrame.shift</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.shift_and_fill.html">polars.DataFrame.shift_and_fill</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.shrink_to_fit.html">polars.DataFrame.shrink_to_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.slice.html">polars.DataFrame.slice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.sort.html">polars.DataFrame.sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.sql.html">polars.DataFrame.sql</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.tail.html">polars.DataFrame.tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.take_every.html">polars.DataFrame.take_every</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.to_dummies.html">polars.DataFrame.to_dummies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.to_series.html">polars.DataFrame.to_series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.top_k.html">polars.DataFrame.top_k</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.transpose.html">polars.DataFrame.transpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.unique.html">polars.DataFrame.unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.unnest.html">polars.DataFrame.unnest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.unstack.html">polars.DataFrame.unstack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.update.html">polars.DataFrame.update</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.upsample.html">polars.DataFrame.upsample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.vstack.html">polars.DataFrame.vstack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.with_columns.html">polars.DataFrame.with_columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.with_columns_seq.html">polars.DataFrame.with_columns_seq</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.with_row_count.html">polars.DataFrame.with_row_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.with_row_index.html">polars.DataFrame.with_row_index</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dataframe/miscellaneous.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.apply.html">polars.DataFrame.apply</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.corr.html">polars.DataFrame.corr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.equals.html">polars.DataFrame.equals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.frame_equal.html">polars.DataFrame.frame_equal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.lazy.html">polars.DataFrame.lazy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.map_rows.html">polars.DataFrame.map_rows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.deserialize.html">polars.DataFrame.deserialize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dataframe/api/polars.DataFrame.serialize.html">polars.DataFrame.serialize</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dataframe/plot.html">Plot</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../lazyframe/index.html">LazyFrame</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../lazyframe/aggregation.html">Aggregation</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.count.html">polars.LazyFrame.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.max.html">polars.LazyFrame.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.mean.html">polars.LazyFrame.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.median.html">polars.LazyFrame.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.min.html">polars.LazyFrame.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.null_count.html">polars.LazyFrame.null_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.quantile.html">polars.LazyFrame.quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.std.html">polars.LazyFrame.std</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.sum.html">polars.LazyFrame.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.var.html">polars.LazyFrame.var</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../lazyframe/attributes.html">Attributes</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.columns.html">polars.LazyFrame.columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.dtypes.html">polars.LazyFrame.dtypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.schema.html">polars.LazyFrame.schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.width.html">polars.LazyFrame.width</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../lazyframe/descriptive.html">Descriptive</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.describe.html">polars.LazyFrame.describe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.explain.html">polars.LazyFrame.explain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.show_graph.html">polars.LazyFrame.show_graph</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../lazyframe/group_by.html">GroupBy</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.agg.html">polars.lazyframe.group_by.LazyGroupBy.agg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.all.html">polars.lazyframe.group_by.LazyGroupBy.all</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.apply.html">polars.lazyframe.group_by.LazyGroupBy.apply</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.count.html">polars.lazyframe.group_by.LazyGroupBy.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.first.html">polars.lazyframe.group_by.LazyGroupBy.first</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.head.html">polars.lazyframe.group_by.LazyGroupBy.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.last.html">polars.lazyframe.group_by.LazyGroupBy.last</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.len.html">polars.lazyframe.group_by.LazyGroupBy.len</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.map_groups.html">polars.lazyframe.group_by.LazyGroupBy.map_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.max.html">polars.lazyframe.group_by.LazyGroupBy.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.mean.html">polars.lazyframe.group_by.LazyGroupBy.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.median.html">polars.lazyframe.group_by.LazyGroupBy.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.min.html">polars.lazyframe.group_by.LazyGroupBy.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.n_unique.html">polars.lazyframe.group_by.LazyGroupBy.n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.quantile.html">polars.lazyframe.group_by.LazyGroupBy.quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.sum.html">polars.lazyframe.group_by.LazyGroupBy.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.lazyframe.group_by.LazyGroupBy.tail.html">polars.lazyframe.group_by.LazyGroupBy.tail</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../lazyframe/modify_select.html">Manipulation/selection</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.approx_n_unique.html">polars.LazyFrame.approx_n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.bottom_k.html">polars.LazyFrame.bottom_k</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.cast.html">polars.LazyFrame.cast</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.clear.html">polars.LazyFrame.clear</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.clone.html">polars.LazyFrame.clone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.drop.html">polars.LazyFrame.drop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.drop_nulls.html">polars.LazyFrame.drop_nulls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.explode.html">polars.LazyFrame.explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.fill_nan.html">polars.LazyFrame.fill_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.fill_null.html">polars.LazyFrame.fill_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.filter.html">polars.LazyFrame.filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.first.html">polars.LazyFrame.first</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.gather_every.html">polars.LazyFrame.gather_every</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.group_by.html">polars.LazyFrame.group_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.group_by_dynamic.html">polars.LazyFrame.group_by_dynamic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.group_by_rolling.html">polars.LazyFrame.group_by_rolling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.groupby.html">polars.LazyFrame.groupby</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.groupby_dynamic.html">polars.LazyFrame.groupby_dynamic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.groupby_rolling.html">polars.LazyFrame.groupby_rolling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.head.html">polars.LazyFrame.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.inspect.html">polars.LazyFrame.inspect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.interpolate.html">polars.LazyFrame.interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.join.html">polars.LazyFrame.join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.join_asof.html">polars.LazyFrame.join_asof</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.last.html">polars.LazyFrame.last</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.limit.html">polars.LazyFrame.limit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.melt.html">polars.LazyFrame.melt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.merge_sorted.html">polars.LazyFrame.merge_sorted</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.rename.html">polars.LazyFrame.rename</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.reverse.html">polars.LazyFrame.reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.rolling.html">polars.LazyFrame.rolling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.select.html">polars.LazyFrame.select</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.select_seq.html">polars.LazyFrame.select_seq</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.set_sorted.html">polars.LazyFrame.set_sorted</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.shift.html">polars.LazyFrame.shift</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.shift_and_fill.html">polars.LazyFrame.shift_and_fill</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.slice.html">polars.LazyFrame.slice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.sort.html">polars.LazyFrame.sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.sql.html">polars.LazyFrame.sql</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.tail.html">polars.LazyFrame.tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.take_every.html">polars.LazyFrame.take_every</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.top_k.html">polars.LazyFrame.top_k</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.unique.html">polars.LazyFrame.unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.unnest.html">polars.LazyFrame.unnest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.update.html">polars.LazyFrame.update</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.with_columns.html">polars.LazyFrame.with_columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.with_columns_seq.html">polars.LazyFrame.with_columns_seq</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.with_context.html">polars.LazyFrame.with_context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.with_row_count.html">polars.LazyFrame.with_row_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.with_row_index.html">polars.LazyFrame.with_row_index</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../lazyframe/miscellaneous.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.cache.html">polars.LazyFrame.cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.collect.html">polars.LazyFrame.collect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.collect_async.html">polars.LazyFrame.collect_async</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.fetch.html">polars.LazyFrame.fetch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.lazy.html">polars.LazyFrame.lazy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.map.html">polars.LazyFrame.map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.map_batches.html">polars.LazyFrame.map_batches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.pipe.html">polars.LazyFrame.pipe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.profile.html">polars.LazyFrame.profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.deserialize.html">polars.LazyFrame.deserialize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lazyframe/api/polars.LazyFrame.serialize.html">polars.LazyFrame.serialize</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../series/index.html">Series</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/aggregation.html">Aggregation</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arg_max.html">polars.Series.arg_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arg_min.html">polars.Series.arg_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.implode.html">polars.Series.implode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.max.html">polars.Series.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.mean.html">polars.Series.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.median.html">polars.Series.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.min.html">polars.Series.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.mode.html">polars.Series.mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.nan_max.html">polars.Series.nan_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.nan_min.html">polars.Series.nan_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.product.html">polars.Series.product</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.quantile.html">polars.Series.quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.std.html">polars.Series.std</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.sum.html">polars.Series.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.var.html">polars.Series.var</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/array.html">Array</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.max.html">polars.Series.arr.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.min.html">polars.Series.arr.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.median.html">polars.Series.arr.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.sum.html">polars.Series.arr.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.std.html">polars.Series.arr.std</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.to_list.html">polars.Series.arr.to_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.unique.html">polars.Series.arr.unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.n_unique.html">polars.Series.arr.n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.var.html">polars.Series.arr.var</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.all.html">polars.Series.arr.all</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.any.html">polars.Series.arr.any</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.sort.html">polars.Series.arr.sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.reverse.html">polars.Series.arr.reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.arg_min.html">polars.Series.arr.arg_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.arg_max.html">polars.Series.arr.arg_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.get.html">polars.Series.arr.get</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.first.html">polars.Series.arr.first</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.last.html">polars.Series.arr.last</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.join.html">polars.Series.arr.join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.explode.html">polars.Series.arr.explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.contains.html">polars.Series.arr.contains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.count_matches.html">polars.Series.arr.count_matches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.to_struct.html">polars.Series.arr.to_struct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arr.shift.html">polars.Series.arr.shift</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/attributes.html">Attributes</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dtype.html">polars.Series.dtype</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.inner_dtype.html">polars.Series.inner_dtype</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.name.html">polars.Series.name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.shape.html">polars.Series.shape</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.flags.html">polars.Series.flags</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/binary.html">Binary</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.bin.contains.html">polars.Series.bin.contains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.bin.decode.html">polars.Series.bin.decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.bin.encode.html">polars.Series.bin.encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.bin.ends_with.html">polars.Series.bin.ends_with</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.bin.starts_with.html">polars.Series.bin.starts_with</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/boolean.html">Boolean</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.all.html">polars.Series.all</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.any.html">polars.Series.any</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.not_.html">polars.Series.not_</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/categories.html">Categories</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cat.get_categories.html">polars.Series.cat.get_categories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cat.is_local.html">polars.Series.cat.is_local</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cat.set_ordering.html">polars.Series.cat.set_ordering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cat.to_local.html">polars.Series.cat.to_local</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cat.uses_lexical_ordering.html">polars.Series.cat.uses_lexical_ordering</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/computation.html">Computation</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.abs.html">polars.Series.abs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arccos.html">polars.Series.arccos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arccosh.html">polars.Series.arccosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arcsin.html">polars.Series.arcsin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arcsinh.html">polars.Series.arcsinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arctan.html">polars.Series.arctan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arctanh.html">polars.Series.arctanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arg_true.html">polars.Series.arg_true</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arg_unique.html">polars.Series.arg_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cbrt.html">polars.Series.cbrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cos.html">polars.Series.cos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cosh.html">polars.Series.cosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cot.html">polars.Series.cot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cum_count.html">polars.Series.cum_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cum_max.html">polars.Series.cum_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cum_min.html">polars.Series.cum_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cum_prod.html">polars.Series.cum_prod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cum_sum.html">polars.Series.cum_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cummax.html">polars.Series.cummax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cummin.html">polars.Series.cummin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cumprod.html">polars.Series.cumprod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cumsum.html">polars.Series.cumsum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cumulative_eval.html">polars.Series.cumulative_eval</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.diff.html">polars.Series.diff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dot.html">polars.Series.dot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.entropy.html">polars.Series.entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.ewm_mean.html">polars.Series.ewm_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.ewm_mean_by.html">polars.Series.ewm_mean_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.ewm_std.html">polars.Series.ewm_std</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.ewm_var.html">polars.Series.ewm_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.exp.html">polars.Series.exp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.hash.html">polars.Series.hash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.hist.html">polars.Series.hist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_between.html">polars.Series.is_between</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.kurtosis.html">polars.Series.kurtosis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.log.html">polars.Series.log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.log10.html">polars.Series.log10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.log1p.html">polars.Series.log1p</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.map_dict.html">polars.Series.map_dict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.pct_change.html">polars.Series.pct_change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.peak_max.html">polars.Series.peak_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.peak_min.html">polars.Series.peak_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rank.html">polars.Series.rank</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.replace.html">polars.Series.replace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rolling_apply.html">polars.Series.rolling_apply</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rolling_map.html">polars.Series.rolling_map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rolling_max.html">polars.Series.rolling_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rolling_mean.html">polars.Series.rolling_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rolling_median.html">polars.Series.rolling_median</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rolling_min.html">polars.Series.rolling_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rolling_quantile.html">polars.Series.rolling_quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rolling_skew.html">polars.Series.rolling_skew</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rolling_std.html">polars.Series.rolling_std</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rolling_sum.html">polars.Series.rolling_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rolling_var.html">polars.Series.rolling_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.search_sorted.html">polars.Series.search_sorted</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.sign.html">polars.Series.sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.sin.html">polars.Series.sin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.sinh.html">polars.Series.sinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.skew.html">polars.Series.skew</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.sqrt.html">polars.Series.sqrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.tan.html">polars.Series.tan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.tanh.html">polars.Series.tanh</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/descriptive.html">Descriptive</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.chunk_lengths.html">polars.Series.chunk_lengths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.describe.html">polars.Series.describe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.estimated_size.html">polars.Series.estimated_size</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.has_nulls.html">polars.Series.has_nulls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.has_validity.html">polars.Series.has_validity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_boolean.html">polars.Series.is_boolean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_duplicated.html">polars.Series.is_duplicated</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_empty.html">polars.Series.is_empty</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_finite.html">polars.Series.is_finite</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_first.html">polars.Series.is_first</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_first_distinct.html">polars.Series.is_first_distinct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_float.html">polars.Series.is_float</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_in.html">polars.Series.is_in</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_infinite.html">polars.Series.is_infinite</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_integer.html">polars.Series.is_integer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_last.html">polars.Series.is_last</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_last_distinct.html">polars.Series.is_last_distinct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_nan.html">polars.Series.is_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_not_nan.html">polars.Series.is_not_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_not_null.html">polars.Series.is_not_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_null.html">polars.Series.is_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_numeric.html">polars.Series.is_numeric</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_sorted.html">polars.Series.is_sorted</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_temporal.html">polars.Series.is_temporal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_unique.html">polars.Series.is_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.is_utf8.html">polars.Series.is_utf8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.len.html">polars.Series.len</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.lower_bound.html">polars.Series.lower_bound</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.n_chunks.html">polars.Series.n_chunks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.n_unique.html">polars.Series.n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.null_count.html">polars.Series.null_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.unique_counts.html">polars.Series.unique_counts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.upper_bound.html">polars.Series.upper_bound</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.value_counts.html">polars.Series.value_counts</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/export.html">Export</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.to_arrow.html">polars.Series.to_arrow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.to_frame.html">polars.Series.to_frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.to_jax.html">polars.Series.to_jax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.to_list.html">polars.Series.to_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.to_numpy.html">polars.Series.to_numpy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.to_pandas.html">polars.Series.to_pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.to_init_repr.html">polars.Series.to_init_repr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.to_torch.html">polars.Series.to_torch</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/list.html">List</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.all.html">polars.Series.list.all</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.any.html">polars.Series.list.any</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.drop_nulls.html">polars.Series.list.drop_nulls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.arg_max.html">polars.Series.list.arg_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.arg_min.html">polars.Series.list.arg_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.concat.html">polars.Series.list.concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.contains.html">polars.Series.list.contains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.count_match.html">polars.Series.list.count_match</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.count_matches.html">polars.Series.list.count_matches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.diff.html">polars.Series.list.diff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.eval.html">polars.Series.list.eval</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.explode.html">polars.Series.list.explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.first.html">polars.Series.list.first</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.gather.html">polars.Series.list.gather</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.get.html">polars.Series.list.get</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.head.html">polars.Series.list.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.join.html">polars.Series.list.join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.last.html">polars.Series.list.last</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.len.html">polars.Series.list.len</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.lengths.html">polars.Series.list.lengths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.max.html">polars.Series.list.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.mean.html">polars.Series.list.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.median.html">polars.Series.list.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.min.html">polars.Series.list.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.reverse.html">polars.Series.list.reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.sample.html">polars.Series.list.sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.set_difference.html">polars.Series.list.set_difference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.set_intersection.html">polars.Series.list.set_intersection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.set_symmetric_difference.html">polars.Series.list.set_symmetric_difference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.set_union.html">polars.Series.list.set_union</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.shift.html">polars.Series.list.shift</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.slice.html">polars.Series.list.slice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.sort.html">polars.Series.list.sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.std.html">polars.Series.list.std</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.sum.html">polars.Series.list.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.tail.html">polars.Series.list.tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.take.html">polars.Series.list.take</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.to_array.html">polars.Series.list.to_array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.to_struct.html">polars.Series.list.to_struct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.unique.html">polars.Series.list.unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.n_unique.html">polars.Series.list.n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.var.html">polars.Series.list.var</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.list.gather_every.html">polars.Series.list.gather_every</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/modify_select.html">Manipulation/selection</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.alias.html">polars.Series.alias</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.append.html">polars.Series.append</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.arg_sort.html">polars.Series.arg_sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.bottom_k.html">polars.Series.bottom_k</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cast.html">polars.Series.cast</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.ceil.html">polars.Series.ceil</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.clear.html">polars.Series.clear</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.clip.html">polars.Series.clip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.clip_max.html">polars.Series.clip_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.clip_min.html">polars.Series.clip_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.clone.html">polars.Series.clone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.cut.html">polars.Series.cut</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.drop_nans.html">polars.Series.drop_nans</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.drop_nulls.html">polars.Series.drop_nulls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.explode.html">polars.Series.explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.extend.html">polars.Series.extend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.extend_constant.html">polars.Series.extend_constant</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.fill_nan.html">polars.Series.fill_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.fill_null.html">polars.Series.fill_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.filter.html">polars.Series.filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.floor.html">polars.Series.floor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.gather.html">polars.Series.gather</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.gather_every.html">polars.Series.gather_every</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.head.html">polars.Series.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.interpolate.html">polars.Series.interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.interpolate_by.html">polars.Series.interpolate_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.item.html">polars.Series.item</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.limit.html">polars.Series.limit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.new_from_index.html">polars.Series.new_from_index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.qcut.html">polars.Series.qcut</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rechunk.html">polars.Series.rechunk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rename.html">polars.Series.rename</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.reshape.html">polars.Series.reshape</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.reverse.html">polars.Series.reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rle.html">polars.Series.rle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.rle_id.html">polars.Series.rle_id</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.round.html">polars.Series.round</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.round_sig_figs.html">polars.Series.round_sig_figs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.sample.html">polars.Series.sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.scatter.html">polars.Series.scatter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.set.html">polars.Series.set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.set_at_idx.html">polars.Series.set_at_idx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.shift.html">polars.Series.shift</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.shift_and_fill.html">polars.Series.shift_and_fill</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.shrink_dtype.html">polars.Series.shrink_dtype</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.shrink_to_fit.html">polars.Series.shrink_to_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.shuffle.html">polars.Series.shuffle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.slice.html">polars.Series.slice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.sort.html">polars.Series.sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.tail.html">polars.Series.tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.take.html">polars.Series.take</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.take_every.html">polars.Series.take_every</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.to_dummies.html">polars.Series.to_dummies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.top_k.html">polars.Series.top_k</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.unique.html">polars.Series.unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.view.html">polars.Series.view</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.zip_with.html">polars.Series.zip_with</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/miscellaneous.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.apply.html">polars.Series.apply</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.equals.html">polars.Series.equals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.map_elements.html">polars.Series.map_elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.reinterpret.html">polars.Series.reinterpret</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.series_equal.html">polars.Series.series_equal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.set_sorted.html">polars.Series.set_sorted</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.to_physical.html">polars.Series.to_physical</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.get_chunks.html">polars.Series.get_chunks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../series/plot.html">Plot</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/string.html">String</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-30"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.concat.html">polars.Series.str.concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.contains.html">polars.Series.str.contains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.contains_any.html">polars.Series.str.contains_any</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.count_match.html">polars.Series.str.count_match</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.count_matches.html">polars.Series.str.count_matches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.decode.html">polars.Series.str.decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.encode.html">polars.Series.str.encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.ends_with.html">polars.Series.str.ends_with</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.explode.html">polars.Series.str.explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.extract.html">polars.Series.str.extract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.extract_all.html">polars.Series.str.extract_all</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.extract_groups.html">polars.Series.str.extract_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.find.html">polars.Series.str.find</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.head.html">polars.Series.str.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.json_decode.html">polars.Series.str.json_decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.json_extract.html">polars.Series.str.json_extract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.json_path_match.html">polars.Series.str.json_path_match</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.len_bytes.html">polars.Series.str.len_bytes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.len_chars.html">polars.Series.str.len_chars</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.lengths.html">polars.Series.str.lengths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.ljust.html">polars.Series.str.ljust</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.lstrip.html">polars.Series.str.lstrip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.n_chars.html">polars.Series.str.n_chars</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.pad_end.html">polars.Series.str.pad_end</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.pad_start.html">polars.Series.str.pad_start</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.parse_int.html">polars.Series.str.parse_int</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.replace.html">polars.Series.str.replace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.replace_all.html">polars.Series.str.replace_all</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.replace_many.html">polars.Series.str.replace_many</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.reverse.html">polars.Series.str.reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.rjust.html">polars.Series.str.rjust</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.rstrip.html">polars.Series.str.rstrip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.slice.html">polars.Series.str.slice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.split.html">polars.Series.str.split</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.split_exact.html">polars.Series.str.split_exact</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.splitn.html">polars.Series.str.splitn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.starts_with.html">polars.Series.str.starts_with</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.strip.html">polars.Series.str.strip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.strip_chars.html">polars.Series.str.strip_chars</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.strip_chars_start.html">polars.Series.str.strip_chars_start</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.strip_chars_end.html">polars.Series.str.strip_chars_end</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.strip_prefix.html">polars.Series.str.strip_prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.strip_suffix.html">polars.Series.str.strip_suffix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.strptime.html">polars.Series.str.strptime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.tail.html">polars.Series.str.tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.to_date.html">polars.Series.str.to_date</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.to_datetime.html">polars.Series.str.to_datetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.to_decimal.html">polars.Series.str.to_decimal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.to_integer.html">polars.Series.str.to_integer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.to_lowercase.html">polars.Series.str.to_lowercase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.to_time.html">polars.Series.str.to_time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.to_titlecase.html">polars.Series.str.to_titlecase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.to_uppercase.html">polars.Series.str.to_uppercase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.str.zfill.html">polars.Series.str.zfill</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/struct.html">Struct</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-31"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.struct.field.html">polars.Series.struct.field</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.struct.json_encode.html">polars.Series.struct.json_encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.struct.rename_fields.html">polars.Series.struct.rename_fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.struct.unnest.html">polars.Series.struct.unnest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.struct.fields.html">polars.Series.struct.fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.struct.schema.html">polars.Series.struct.schema</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../series/temporal.html">Temporal</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-32"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.add_business_days.html">polars.Series.dt.add_business_days</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.base_utc_offset.html">polars.Series.dt.base_utc_offset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.cast_time_unit.html">polars.Series.dt.cast_time_unit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.century.html">polars.Series.dt.century</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.combine.html">polars.Series.dt.combine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.convert_time_zone.html">polars.Series.dt.convert_time_zone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.date.html">polars.Series.dt.date</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.datetime.html">polars.Series.dt.datetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.day.html">polars.Series.dt.day</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.days.html">polars.Series.dt.days</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.dst_offset.html">polars.Series.dt.dst_offset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.epoch.html">polars.Series.dt.epoch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.hour.html">polars.Series.dt.hour</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.hours.html">polars.Series.dt.hours</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.is_leap_year.html">polars.Series.dt.is_leap_year</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.iso_year.html">polars.Series.dt.iso_year</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.max.html">polars.Series.dt.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.mean.html">polars.Series.dt.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.median.html">polars.Series.dt.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.microsecond.html">polars.Series.dt.microsecond</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.microseconds.html">polars.Series.dt.microseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.millennium.html">polars.Series.dt.millennium</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.millisecond.html">polars.Series.dt.millisecond</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.milliseconds.html">polars.Series.dt.milliseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.min.html">polars.Series.dt.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.minute.html">polars.Series.dt.minute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.minutes.html">polars.Series.dt.minutes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.month.html">polars.Series.dt.month</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.month_end.html">polars.Series.dt.month_end</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.month_start.html">polars.Series.dt.month_start</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.nanosecond.html">polars.Series.dt.nanosecond</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.nanoseconds.html">polars.Series.dt.nanoseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.offset_by.html">polars.Series.dt.offset_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.ordinal_day.html">polars.Series.dt.ordinal_day</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.quarter.html">polars.Series.dt.quarter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.replace_time_zone.html">polars.Series.dt.replace_time_zone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.round.html">polars.Series.dt.round</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.second.html">polars.Series.dt.second</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.seconds.html">polars.Series.dt.seconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.strftime.html">polars.Series.dt.strftime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.time.html">polars.Series.dt.time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.timestamp.html">polars.Series.dt.timestamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.to_string.html">polars.Series.dt.to_string</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.total_days.html">polars.Series.dt.total_days</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.total_hours.html">polars.Series.dt.total_hours</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.total_microseconds.html">polars.Series.dt.total_microseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.total_milliseconds.html">polars.Series.dt.total_milliseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.total_minutes.html">polars.Series.dt.total_minutes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.total_nanoseconds.html">polars.Series.dt.total_nanoseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.total_seconds.html">polars.Series.dt.total_seconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.truncate.html">polars.Series.dt.truncate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.week.html">polars.Series.dt.week</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.weekday.html">polars.Series.dt.weekday</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.with_time_unit.html">polars.Series.dt.with_time_unit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../series/api/polars.Series.dt.year.html">polars.Series.dt.year</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Expressions</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-33"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="aggregation.html">Aggregation</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-34"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.agg_groups.html">polars.Expr.agg_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arg_max.html">polars.Expr.arg_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arg_min.html">polars.Expr.arg_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.count.html">polars.Expr.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.first.html">polars.Expr.first</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.implode.html">polars.Expr.implode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.last.html">polars.Expr.last</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.len.html">polars.Expr.len</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.max.html">polars.Expr.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.mean.html">polars.Expr.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.median.html">polars.Expr.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.min.html">polars.Expr.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.nan_max.html">polars.Expr.nan_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.nan_min.html">polars.Expr.nan_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.product.html">polars.Expr.product</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.quantile.html">polars.Expr.quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.std.html">polars.Expr.std</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.sum.html">polars.Expr.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.var.html">polars.Expr.var</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="array.html">Array</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-35"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.max.html">polars.Expr.arr.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.min.html">polars.Expr.arr.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.median.html">polars.Expr.arr.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.sum.html">polars.Expr.arr.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.std.html">polars.Expr.arr.std</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.to_list.html">polars.Expr.arr.to_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.unique.html">polars.Expr.arr.unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.n_unique.html">polars.Expr.arr.n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.var.html">polars.Expr.arr.var</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.all.html">polars.Expr.arr.all</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.any.html">polars.Expr.arr.any</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.sort.html">polars.Expr.arr.sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.reverse.html">polars.Expr.arr.reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.arg_min.html">polars.Expr.arr.arg_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.arg_max.html">polars.Expr.arr.arg_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.get.html">polars.Expr.arr.get</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.first.html">polars.Expr.arr.first</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.last.html">polars.Expr.arr.last</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.join.html">polars.Expr.arr.join</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.explode.html">polars.Expr.arr.explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.contains.html">polars.Expr.arr.contains</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.count_matches.html">polars.Expr.arr.count_matches</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.to_struct.html">polars.Expr.arr.to_struct</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arr.shift.html">polars.Expr.arr.shift</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="binary.html">Binary</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-36"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.bin.contains.html">polars.Expr.bin.contains</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.bin.decode.html">polars.Expr.bin.decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.bin.encode.html">polars.Expr.bin.encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.bin.ends_with.html">polars.Expr.bin.ends_with</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.bin.starts_with.html">polars.Expr.bin.starts_with</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="boolean.html">Boolean</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-37"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.all.html">polars.Expr.all</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.any.html">polars.Expr.any</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.has_nulls.html">polars.Expr.has_nulls</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_between.html">polars.Expr.is_between</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_duplicated.html">polars.Expr.is_duplicated</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_finite.html">polars.Expr.is_finite</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_first.html">polars.Expr.is_first</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_first_distinct.html">polars.Expr.is_first_distinct</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_in.html">polars.Expr.is_in</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_infinite.html">polars.Expr.is_infinite</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_last.html">polars.Expr.is_last</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_last_distinct.html">polars.Expr.is_last_distinct</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_nan.html">polars.Expr.is_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_not.html">polars.Expr.is_not</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_not_nan.html">polars.Expr.is_not_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_not_null.html">polars.Expr.is_not_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_null.html">polars.Expr.is_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.is_unique.html">polars.Expr.is_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.not_.html">polars.Expr.not_</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="categories.html">Categories</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-38"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cat.get_categories.html">polars.Expr.cat.get_categories</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cat.set_ordering.html">polars.Expr.cat.set_ordering</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="columns.html">Columns / names</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-39"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.alias.html">polars.Expr.alias</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.exclude.html">polars.Expr.exclude</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.keep_name.html">polars.Expr.keep_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.map_alias.html">polars.Expr.map_alias</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.prefix.html">polars.Expr.prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.suffix.html">polars.Expr.suffix</a></li>
<li class="toctree-l3"><a class="reference internal" href="col.html">polars.col</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="computation.html">Computation</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-40"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.abs.html">polars.Expr.abs</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.approx_n_unique.html">polars.Expr.approx_n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arccos.html">polars.Expr.arccos</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arccosh.html">polars.Expr.arccosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arcsin.html">polars.Expr.arcsin</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arcsinh.html">polars.Expr.arcsinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arctan.html">polars.Expr.arctan</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arctanh.html">polars.Expr.arctanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arg_unique.html">polars.Expr.arg_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cbrt.html">polars.Expr.cbrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cos.html">polars.Expr.cos</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cosh.html">polars.Expr.cosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cot.html">polars.Expr.cot</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cum_count.html">polars.Expr.cum_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cum_max.html">polars.Expr.cum_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cum_min.html">polars.Expr.cum_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cum_prod.html">polars.Expr.cum_prod</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cum_sum.html">polars.Expr.cum_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cumcount.html">polars.Expr.cumcount</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cummax.html">polars.Expr.cummax</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cummin.html">polars.Expr.cummin</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cumprod.html">polars.Expr.cumprod</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cumsum.html">polars.Expr.cumsum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cumulative_eval.html">polars.Expr.cumulative_eval</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.degrees.html">polars.Expr.degrees</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.diff.html">polars.Expr.diff</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dot.html">polars.Expr.dot</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.entropy.html">polars.Expr.entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.ewm_mean.html">polars.Expr.ewm_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.ewm_mean_by.html">polars.Expr.ewm_mean_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.ewm_std.html">polars.Expr.ewm_std</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.ewm_var.html">polars.Expr.ewm_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.exp.html">polars.Expr.exp</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.hash.html">polars.Expr.hash</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.hist.html">polars.Expr.hist</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.kurtosis.html">polars.Expr.kurtosis</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.log.html">polars.Expr.log</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.log10.html">polars.Expr.log10</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.log1p.html">polars.Expr.log1p</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.mode.html">polars.Expr.mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.n_unique.html">polars.Expr.n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.null_count.html">polars.Expr.null_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.pct_change.html">polars.Expr.pct_change</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.peak_max.html">polars.Expr.peak_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.peak_min.html">polars.Expr.peak_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.radians.html">polars.Expr.radians</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rank.html">polars.Expr.rank</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_apply.html">polars.Expr.rolling_apply</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_map.html">polars.Expr.rolling_map</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_max.html">polars.Expr.rolling_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_max_by.html">polars.Expr.rolling_max_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_mean.html">polars.Expr.rolling_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_mean_by.html">polars.Expr.rolling_mean_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_median.html">polars.Expr.rolling_median</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_median_by.html">polars.Expr.rolling_median_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_min.html">polars.Expr.rolling_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_min_by.html">polars.Expr.rolling_min_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_quantile.html">polars.Expr.rolling_quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_quantile_by.html">polars.Expr.rolling_quantile_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_skew.html">polars.Expr.rolling_skew</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_std.html">polars.Expr.rolling_std</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_std_by.html">polars.Expr.rolling_std_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_sum.html">polars.Expr.rolling_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_sum_by.html">polars.Expr.rolling_sum_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_var.html">polars.Expr.rolling_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling_var_by.html">polars.Expr.rolling_var_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.search_sorted.html">polars.Expr.search_sorted</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.sign.html">polars.Expr.sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.sin.html">polars.Expr.sin</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.sinh.html">polars.Expr.sinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.skew.html">polars.Expr.skew</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.sqrt.html">polars.Expr.sqrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.tan.html">polars.Expr.tan</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.tanh.html">polars.Expr.tanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.unique.html">polars.Expr.unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.unique_counts.html">polars.Expr.unique_counts</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.value_counts.html">polars.Expr.value_counts</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="functions.html">Functions</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-41"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.all.html">polars.all</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.all_horizontal.html">polars.all_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.any.html">polars.any</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.any_horizontal.html">polars.any_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.apply.html">polars.apply</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.approx_n_unique.html">polars.approx_n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.arange.html">polars.arange</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.arctan2.html">polars.arctan2</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.arctan2d.html">polars.arctan2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.arg_sort_by.html">polars.arg_sort_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.arg_where.html">polars.arg_where</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.business_day_count.html">polars.business_day_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.coalesce.html">polars.coalesce</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.concat_list.html">polars.concat_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.concat_str.html">polars.concat_str</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.corr.html">polars.corr</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.count.html">polars.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.cov.html">polars.cov</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.cum_count.html">polars.cum_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.cum_fold.html">polars.cum_fold</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.cum_reduce.html">polars.cum_reduce</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.cum_sum.html">polars.cum_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.cum_sum_horizontal.html">polars.cum_sum_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.cumfold.html">polars.cumfold</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.cumreduce.html">polars.cumreduce</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.cumsum.html">polars.cumsum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.cumsum_horizontal.html">polars.cumsum_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.date.html">polars.date</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.datetime.html">polars.datetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.date_range.html">polars.date_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.date_ranges.html">polars.date_ranges</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.datetime_range.html">polars.datetime_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.datetime_ranges.html">polars.datetime_ranges</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.duration.html">polars.duration</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.element.html">polars.element</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.exclude.html">polars.exclude</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.first.html">polars.first</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.fold.html">polars.fold</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.format.html">polars.format</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.from_epoch.html">polars.from_epoch</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.groups.html">polars.groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.head.html">polars.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.implode.html">polars.implode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.int_range.html">polars.int_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.int_ranges.html">polars.int_ranges</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.last.html">polars.last</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.len.html">polars.len</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.lit.html">polars.lit</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.map.html">polars.map</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.map_batches.html">polars.map_batches</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.map_groups.html">polars.map_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.max.html">polars.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.max_horizontal.html">polars.max_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.mean.html">polars.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.mean_horizontal.html">polars.mean_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.median.html">polars.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.min.html">polars.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.min_horizontal.html">polars.min_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.n_unique.html">polars.n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.nth.html">polars.nth</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.ones.html">polars.ones</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.quantile.html">polars.quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.reduce.html">polars.reduce</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.repeat.html">polars.repeat</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.rolling_corr.html">polars.rolling_corr</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.rolling_cov.html">polars.rolling_cov</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.select.html">polars.select</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.std.html">polars.std</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.struct.html">polars.struct</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.sum.html">polars.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.sum_horizontal.html">polars.sum_horizontal</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.sql_expr.html">polars.sql_expr</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.tail.html">polars.tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.time.html">polars.time</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.time_range.html">polars.time_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.time_ranges.html">polars.time_ranges</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.var.html">polars.var</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.when.html">polars.when</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.zeros.html">polars.zeros</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.all.html">polars.Expr.all</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.any.html">polars.Expr.any</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.apply.html">polars.Expr.apply</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.approx_n_unique.html">polars.Expr.approx_n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.count.html">polars.Expr.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cumsum.html">polars.Expr.cumsum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.exclude.html">polars.Expr.exclude</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.first.html">polars.Expr.first</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.head.html">polars.Expr.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.implode.html">polars.Expr.implode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.map.html">polars.Expr.map</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.map_batches.html">polars.Expr.map_batches</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.map_elements.html">polars.Expr.map_elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.max.html">polars.Expr.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.mean.html">polars.Expr.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.median.html">polars.Expr.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.min.html">polars.Expr.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.n_unique.html">polars.Expr.n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.quantile.html">polars.Expr.quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.std.html">polars.Expr.std</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.sum.html">polars.Expr.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.tail.html">polars.Expr.tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.var.html">polars.Expr.var</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="list.html">List</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-42"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.all.html">polars.Expr.list.all</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.any.html">polars.Expr.list.any</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.drop_nulls.html">polars.Expr.list.drop_nulls</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.arg_max.html">polars.Expr.list.arg_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.arg_min.html">polars.Expr.list.arg_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.concat.html">polars.Expr.list.concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.contains.html">polars.Expr.list.contains</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.count_match.html">polars.Expr.list.count_match</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.count_matches.html">polars.Expr.list.count_matches</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.diff.html">polars.Expr.list.diff</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.eval.html">polars.Expr.list.eval</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.explode.html">polars.Expr.list.explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.first.html">polars.Expr.list.first</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.gather.html">polars.Expr.list.gather</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.get.html">polars.Expr.list.get</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.head.html">polars.Expr.list.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.join.html">polars.Expr.list.join</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.last.html">polars.Expr.list.last</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.len.html">polars.Expr.list.len</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.lengths.html">polars.Expr.list.lengths</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.max.html">polars.Expr.list.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.mean.html">polars.Expr.list.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.median.html">polars.Expr.list.median</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.min.html">polars.Expr.list.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.reverse.html">polars.Expr.list.reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.sample.html">polars.Expr.list.sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.set_difference.html">polars.Expr.list.set_difference</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.set_intersection.html">polars.Expr.list.set_intersection</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.set_symmetric_difference.html">polars.Expr.list.set_symmetric_difference</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.set_union.html">polars.Expr.list.set_union</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.shift.html">polars.Expr.list.shift</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.slice.html">polars.Expr.list.slice</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.sort.html">polars.Expr.list.sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.std.html">polars.Expr.list.std</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.sum.html">polars.Expr.list.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.tail.html">polars.Expr.list.tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.take.html">polars.Expr.list.take</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.to_array.html">polars.Expr.list.to_array</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.to_struct.html">polars.Expr.list.to_struct</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.unique.html">polars.Expr.list.unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.n_unique.html">polars.Expr.list.n_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.var.html">polars.Expr.list.var</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.list.gather_every.html">polars.Expr.list.gather_every</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="modify_select.html">Manipulation/selection</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-43"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.append.html">polars.Expr.append</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arg_sort.html">polars.Expr.arg_sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.arg_true.html">polars.Expr.arg_true</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.backward_fill.html">polars.Expr.backward_fill</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.bottom_k.html">polars.Expr.bottom_k</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.bottom_k_by.html">polars.Expr.bottom_k_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cast.html">polars.Expr.cast</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.ceil.html">polars.Expr.ceil</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.clip.html">polars.Expr.clip</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.clip_max.html">polars.Expr.clip_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.clip_min.html">polars.Expr.clip_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.cut.html">polars.Expr.cut</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.drop_nans.html">polars.Expr.drop_nans</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.drop_nulls.html">polars.Expr.drop_nulls</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.explode.html">polars.Expr.explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.extend_constant.html">polars.Expr.extend_constant</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.fill_nan.html">polars.Expr.fill_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.fill_null.html">polars.Expr.fill_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.filter.html">polars.Expr.filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.flatten.html">polars.Expr.flatten</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.floor.html">polars.Expr.floor</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.forward_fill.html">polars.Expr.forward_fill</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.gather.html">polars.Expr.gather</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.gather_every.html">polars.Expr.gather_every</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.get.html">polars.Expr.get</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.head.html">polars.Expr.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.inspect.html">polars.Expr.inspect</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.interpolate.html">polars.Expr.interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.interpolate_by.html">polars.Expr.interpolate_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.limit.html">polars.Expr.limit</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.lower_bound.html">polars.Expr.lower_bound</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.map_dict.html">polars.Expr.map_dict</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.pipe.html">polars.Expr.pipe</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.qcut.html">polars.Expr.qcut</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rechunk.html">polars.Expr.rechunk</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.reinterpret.html">polars.Expr.reinterpret</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.repeat_by.html">polars.Expr.repeat_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.replace.html">polars.Expr.replace</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.reshape.html">polars.Expr.reshape</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.reverse.html">polars.Expr.reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rle.html">polars.Expr.rle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rle_id.html">polars.Expr.rle_id</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.round.html">polars.Expr.round</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.round_sig_figs.html">polars.Expr.round_sig_figs</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.sample.html">polars.Expr.sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.shift.html">polars.Expr.shift</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.shift_and_fill.html">polars.Expr.shift_and_fill</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.shrink_dtype.html">polars.Expr.shrink_dtype</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.shuffle.html">polars.Expr.shuffle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.slice.html">polars.Expr.slice</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.sort.html">polars.Expr.sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.sort_by.html">polars.Expr.sort_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.tail.html">polars.Expr.tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.take.html">polars.Expr.take</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.take_every.html">polars.Expr.take_every</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.to_physical.html">polars.Expr.to_physical</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.top_k.html">polars.Expr.top_k</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.top_k_by.html">polars.Expr.top_k_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.upper_bound.html">polars.Expr.upper_bound</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.where.html">polars.Expr.where</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="meta.html">Meta</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-44"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.eq.html">polars.Expr.meta.eq</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.has_multiple_outputs.html">polars.Expr.meta.has_multiple_outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.is_column_selection.html">polars.Expr.meta.is_column_selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.is_regex_projection.html">polars.Expr.meta.is_regex_projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.ne.html">polars.Expr.meta.ne</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.output_name.html">polars.Expr.meta.output_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.pop.html">polars.Expr.meta.pop</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.root_names.html">polars.Expr.meta.root_names</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.serialize.html">polars.Expr.meta.serialize</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.tree_format.html">polars.Expr.meta.tree_format</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.undo_aliases.html">polars.Expr.meta.undo_aliases</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.meta.write_json.html">polars.Expr.meta.write_json</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="miscellaneous.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-45"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.deserialize.html">polars.Expr.deserialize</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.from_json.html">polars.Expr.from_json</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.set_sorted.html">polars.Expr.set_sorted</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="name.html">Name</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-46"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.name.keep.html">polars.Expr.name.keep</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.name.map.html">polars.Expr.name.map</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.name.prefix.html">polars.Expr.name.prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.name.suffix.html">polars.Expr.name.suffix</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.name.to_lowercase.html">polars.Expr.name.to_lowercase</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.name.to_uppercase.html">polars.Expr.name.to_uppercase</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.name.map_fields.html">polars.Expr.name.map_fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.name.prefix_fields.html">polars.Expr.name.prefix_fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.name.suffix_fields.html">polars.Expr.name.suffix_fields</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="operators.html">Operators</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-47"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.and_.html">polars.Expr.and_</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.or_.html">polars.Expr.or_</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.eq.html">polars.Expr.eq</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.eq_missing.html">polars.Expr.eq_missing</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.ge.html">polars.Expr.ge</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.gt.html">polars.Expr.gt</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.le.html">polars.Expr.le</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.lt.html">polars.Expr.lt</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.ne.html">polars.Expr.ne</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.ne_missing.html">polars.Expr.ne_missing</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.add.html">polars.Expr.add</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.floordiv.html">polars.Expr.floordiv</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.mod.html">polars.Expr.mod</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.mul.html">polars.Expr.mul</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.neg.html">polars.Expr.neg</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.sub.html">polars.Expr.sub</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.truediv.html">polars.Expr.truediv</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.pow.html">polars.Expr.pow</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.xor.html">polars.Expr.xor</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="string.html">String</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-48"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.concat.html">polars.Expr.str.concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.contains.html">polars.Expr.str.contains</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.contains_any.html">polars.Expr.str.contains_any</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.count_match.html">polars.Expr.str.count_match</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.count_matches.html">polars.Expr.str.count_matches</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.decode.html">polars.Expr.str.decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.encode.html">polars.Expr.str.encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.ends_with.html">polars.Expr.str.ends_with</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.explode.html">polars.Expr.str.explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.extract.html">polars.Expr.str.extract</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.extract_all.html">polars.Expr.str.extract_all</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.extract_groups.html">polars.Expr.str.extract_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.find.html">polars.Expr.str.find</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.head.html">polars.Expr.str.head</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.json_decode.html">polars.Expr.str.json_decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.json_extract.html">polars.Expr.str.json_extract</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.json_path_match.html">polars.Expr.str.json_path_match</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.len_bytes.html">polars.Expr.str.len_bytes</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.len_chars.html">polars.Expr.str.len_chars</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.lengths.html">polars.Expr.str.lengths</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.ljust.html">polars.Expr.str.ljust</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.lstrip.html">polars.Expr.str.lstrip</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.n_chars.html">polars.Expr.str.n_chars</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.pad_end.html">polars.Expr.str.pad_end</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.pad_start.html">polars.Expr.str.pad_start</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.parse_int.html">polars.Expr.str.parse_int</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.replace.html">polars.Expr.str.replace</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.replace_all.html">polars.Expr.str.replace_all</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.replace_many.html">polars.Expr.str.replace_many</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.reverse.html">polars.Expr.str.reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.rjust.html">polars.Expr.str.rjust</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.rstrip.html">polars.Expr.str.rstrip</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.slice.html">polars.Expr.str.slice</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.split.html">polars.Expr.str.split</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.split_exact.html">polars.Expr.str.split_exact</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.splitn.html">polars.Expr.str.splitn</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.starts_with.html">polars.Expr.str.starts_with</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.strip.html">polars.Expr.str.strip</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.strip_chars.html">polars.Expr.str.strip_chars</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.strip_chars_start.html">polars.Expr.str.strip_chars_start</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.strip_chars_end.html">polars.Expr.str.strip_chars_end</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.strip_prefix.html">polars.Expr.str.strip_prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.strip_suffix.html">polars.Expr.str.strip_suffix</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.strptime.html">polars.Expr.str.strptime</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.tail.html">polars.Expr.str.tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.to_date.html">polars.Expr.str.to_date</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.to_datetime.html">polars.Expr.str.to_datetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.to_decimal.html">polars.Expr.str.to_decimal</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.to_integer.html">polars.Expr.str.to_integer</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.to_lowercase.html">polars.Expr.str.to_lowercase</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.to_titlecase.html">polars.Expr.str.to_titlecase</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.to_time.html">polars.Expr.str.to_time</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.to_uppercase.html">polars.Expr.str.to_uppercase</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.str.zfill.html">polars.Expr.str.zfill</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="struct.html">Struct</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-49"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.struct.field.html">polars.Expr.struct.field</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.struct.json_encode.html">polars.Expr.struct.json_encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.struct.rename_fields.html">polars.Expr.struct.rename_fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.struct.with_fields.html">polars.Expr.struct.with_fields</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="temporal.html">Temporal</a><input class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-50"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.add_business_days.html">polars.Expr.dt.add_business_days</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.base_utc_offset.html">polars.Expr.dt.base_utc_offset</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.cast_time_unit.html">polars.Expr.dt.cast_time_unit</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.century.html">polars.Expr.dt.century</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.combine.html">polars.Expr.dt.combine</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.convert_time_zone.html">polars.Expr.dt.convert_time_zone</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.date.html">polars.Expr.dt.date</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.datetime.html">polars.Expr.dt.datetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.day.html">polars.Expr.dt.day</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.days.html">polars.Expr.dt.days</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.dst_offset.html">polars.Expr.dt.dst_offset</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.epoch.html">polars.Expr.dt.epoch</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.hour.html">polars.Expr.dt.hour</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.hours.html">polars.Expr.dt.hours</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.is_leap_year.html">polars.Expr.dt.is_leap_year</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.iso_year.html">polars.Expr.dt.iso_year</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.microsecond.html">polars.Expr.dt.microsecond</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.microseconds.html">polars.Expr.dt.microseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.millennium.html">polars.Expr.dt.millennium</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.millisecond.html">polars.Expr.dt.millisecond</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.milliseconds.html">polars.Expr.dt.milliseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.minute.html">polars.Expr.dt.minute</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.minutes.html">polars.Expr.dt.minutes</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.month.html">polars.Expr.dt.month</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.month_end.html">polars.Expr.dt.month_end</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.month_start.html">polars.Expr.dt.month_start</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.nanosecond.html">polars.Expr.dt.nanosecond</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.nanoseconds.html">polars.Expr.dt.nanoseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.offset_by.html">polars.Expr.dt.offset_by</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.ordinal_day.html">polars.Expr.dt.ordinal_day</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.quarter.html">polars.Expr.dt.quarter</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.replace_time_zone.html">polars.Expr.dt.replace_time_zone</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.round.html">polars.Expr.dt.round</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.second.html">polars.Expr.dt.second</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.seconds.html">polars.Expr.dt.seconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.strftime.html">polars.Expr.dt.strftime</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.time.html">polars.Expr.dt.time</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.timestamp.html">polars.Expr.dt.timestamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.to_string.html">polars.Expr.dt.to_string</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.total_days.html">polars.Expr.dt.total_days</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.total_hours.html">polars.Expr.dt.total_hours</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.total_microseconds.html">polars.Expr.dt.total_microseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.total_milliseconds.html">polars.Expr.dt.total_milliseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.total_minutes.html">polars.Expr.dt.total_minutes</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.total_nanoseconds.html">polars.Expr.dt.total_nanoseconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.total_seconds.html">polars.Expr.dt.total_seconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.truncate.html">polars.Expr.dt.truncate</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.week.html">polars.Expr.dt.week</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.weekday.html">polars.Expr.dt.weekday</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.with_time_unit.html">polars.Expr.dt.with_time_unit</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.dt.year.html">polars.Expr.dt.year</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="window.html">Window</a><input class="toctree-checkbox" id="toctree-checkbox-51" name="toctree-checkbox-51" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-51"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.over.html">polars.Expr.over</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/polars.Expr.rolling.html">polars.Expr.rolling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../selectors.html">Selectors</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../functions.html">Functions</a><input class="toctree-checkbox" id="toctree-checkbox-52" name="toctree-checkbox-52" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-52"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.from_arrow.html">polars.from_arrow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.from_dataframe.html">polars.from_dataframe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.from_dict.html">polars.from_dict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.from_dicts.html">polars.from_dicts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.from_numpy.html">polars.from_numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.from_pandas.html">polars.from_pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.from_records.html">polars.from_records</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.from_repr.html">polars.from_repr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.align_frames.html">polars.align_frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.concat.html">polars.concat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.collect_all.html">polars.collect_all</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.collect_all_async.html">polars.collect_all_async</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.set_random_seed.html">polars.set_random_seed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.StringCache.html">polars.StringCache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.enable_string_cache.html">polars.enable_string_cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.disable_string_cache.html">polars.disable_string_cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.using_string_cache.html">polars.using_string_cache</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../datatypes.html">Data types</a><input class="toctree-checkbox" id="toctree-checkbox-53" name="toctree-checkbox-53" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-53"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.DataType.html">polars.datatypes.DataType</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Decimal.html">polars.datatypes.Decimal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Float32.html">polars.datatypes.Float32</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Float64.html">polars.datatypes.Float64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Int8.html">polars.datatypes.Int8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Int16.html">polars.datatypes.Int16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Int32.html">polars.datatypes.Int32</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Int64.html">polars.datatypes.Int64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.UInt8.html">polars.datatypes.UInt8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.UInt16.html">polars.datatypes.UInt16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.UInt32.html">polars.datatypes.UInt32</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.UInt64.html">polars.datatypes.UInt64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Date.html">polars.datatypes.Date</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Datetime.html">polars.datatypes.Datetime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Duration.html">polars.datatypes.Duration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Time.html">polars.datatypes.Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Array.html">polars.datatypes.Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.List.html">polars.datatypes.List</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Struct.html">polars.datatypes.Struct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.String.html">polars.datatypes.String</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Categorical.html">polars.datatypes.Categorical</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Enum.html">polars.datatypes.Enum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Utf8.html">polars.datatypes.Utf8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Binary.html">polars.datatypes.Binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Boolean.html">polars.datatypes.Boolean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Null.html">polars.datatypes.Null</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Object.html">polars.datatypes.Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.datatypes.Unknown.html">polars.datatypes.Unknown</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../io.html">Input/output</a><input class="toctree-checkbox" id="toctree-checkbox-54" name="toctree-checkbox-54" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-54"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_avro.html">polars.read_avro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.DataFrame.write_avro.html">polars.DataFrame.write_avro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_clipboard.html">polars.read_clipboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.DataFrame.write_clipboard.html">polars.DataFrame.write_clipboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_csv.html">polars.read_csv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_csv_batched.html">polars.read_csv_batched</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.scan_csv.html">polars.scan_csv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.DataFrame.write_csv.html">polars.DataFrame.write_csv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.LazyFrame.sink_csv.html">polars.LazyFrame.sink_csv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.io.csv.batched_reader.BatchedCsvReader.next_batches.html">polars.io.csv.batched_reader.BatchedCsvReader.next_batches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_database.html">polars.read_database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_database_uri.html">polars.read_database_uri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.DataFrame.write_database.html">polars.DataFrame.write_database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_delta.html">polars.read_delta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.scan_delta.html">polars.scan_delta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.DataFrame.write_delta.html">polars.DataFrame.write_delta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_excel.html">polars.read_excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_ods.html">polars.read_ods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.DataFrame.write_excel.html">polars.DataFrame.write_excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_ipc.html">polars.read_ipc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_ipc_schema.html">polars.read_ipc_schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_ipc_stream.html">polars.read_ipc_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.scan_ipc.html">polars.scan_ipc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.DataFrame.write_ipc.html">polars.DataFrame.write_ipc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.DataFrame.write_ipc_stream.html">polars.DataFrame.write_ipc_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.LazyFrame.sink_ipc.html">polars.LazyFrame.sink_ipc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.scan_iceberg.html">polars.scan_iceberg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_json.html">polars.read_json</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_ndjson.html">polars.read_ndjson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.scan_ndjson.html">polars.scan_ndjson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.DataFrame.write_json.html">polars.DataFrame.write_json</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.DataFrame.write_ndjson.html">polars.DataFrame.write_ndjson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.LazyFrame.sink_ndjson.html">polars.LazyFrame.sink_ndjson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_parquet.html">polars.read_parquet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.read_parquet_schema.html">polars.read_parquet_schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.scan_parquet.html">polars.scan_parquet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.DataFrame.write_parquet.html">polars.DataFrame.write_parquet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.LazyFrame.sink_parquet.html">polars.LazyFrame.sink_parquet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.scan_pyarrow_dataset.html">polars.scan_pyarrow_dataset</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../config.html">Config</a><input class="toctree-checkbox" id="toctree-checkbox-55" name="toctree-checkbox-55" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-55"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.activate_decimals.html">polars.Config.activate_decimals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_ascii_tables.html">polars.Config.set_ascii_tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_auto_structify.html">polars.Config.set_auto_structify</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_decimal_separator.html">polars.Config.set_decimal_separator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_float_precision.html">polars.Config.set_float_precision</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_fmt_float.html">polars.Config.set_fmt_float</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_fmt_str_lengths.html">polars.Config.set_fmt_str_lengths</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_fmt_table_cell_list_len.html">polars.Config.set_fmt_table_cell_list_len</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_streaming_chunk_size.html">polars.Config.set_streaming_chunk_size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_cell_alignment.html">polars.Config.set_tbl_cell_alignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_cell_numeric_alignment.html">polars.Config.set_tbl_cell_numeric_alignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_cols.html">polars.Config.set_tbl_cols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_column_data_type_inline.html">polars.Config.set_tbl_column_data_type_inline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_dataframe_shape_below.html">polars.Config.set_tbl_dataframe_shape_below</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_formatting.html">polars.Config.set_tbl_formatting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_hide_column_data_types.html">polars.Config.set_tbl_hide_column_data_types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_hide_column_names.html">polars.Config.set_tbl_hide_column_names</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_hide_dataframe_shape.html">polars.Config.set_tbl_hide_dataframe_shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_hide_dtype_separator.html">polars.Config.set_tbl_hide_dtype_separator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_rows.html">polars.Config.set_tbl_rows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_tbl_width_chars.html">polars.Config.set_tbl_width_chars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_thousands_separator.html">polars.Config.set_thousands_separator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_trim_decimal_zeros.html">polars.Config.set_trim_decimal_zeros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.set_verbose.html">polars.Config.set_verbose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.load.html">polars.Config.load</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.load_from_file.html">polars.Config.load_from_file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.save.html">polars.Config.save</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.save_to_file.html">polars.Config.save_to_file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.state.html">polars.Config.state</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.Config.restore_defaults.html">polars.Config.restore_defaults</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">Extending the API</a><input class="toctree-checkbox" id="toctree-checkbox-56" name="toctree-checkbox-56" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-56"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.api.register_expr_namespace.html">polars.api.register_expr_namespace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.api.register_dataframe_namespace.html">polars.api.register_dataframe_namespace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.api.register_lazyframe_namespace.html">polars.api.register_lazyframe_namespace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.api.register_series_namespace.html">polars.api.register_series_namespace</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../sql/index.html">SQL Interface</a><input class="toctree-checkbox" id="toctree-checkbox-57" name="toctree-checkbox-57" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-57"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../sql/python_api.html">Python API</a><input class="toctree-checkbox" id="toctree-checkbox-58" name="toctree-checkbox-58" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-58"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../sql/api/polars.SQLContext.execute.html">polars.SQLContext.execute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/api/polars.SQLContext.register.html">polars.SQLContext.register</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/api/polars.SQLContext.register_globals.html">polars.SQLContext.register_globals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/api/polars.SQLContext.register_many.html">polars.SQLContext.register_many</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/api/polars.SQLContext.unregister.html">polars.SQLContext.unregister</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/api/polars.SQLContext.tables.html">polars.SQLContext.tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sql/clauses.html">SQL Clauses</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../sql/functions/index.html">SQL Functions</a><input class="toctree-checkbox" id="toctree-checkbox-59" name="toctree-checkbox-59" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-59"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../sql/functions/aggregate.html">Aggregate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/functions/array.html">Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/functions/conditional.html">Conditional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/functions/math.html">Math</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/functions/string.html">String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/functions/temporal.html">Temporal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/functions/trigonometry.html">Trigonometry</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sql/set_operations.html">Set Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sql/table_operations.html">Table Operations</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../exceptions.html">Exceptions</a><input class="toctree-checkbox" id="toctree-checkbox-60" name="toctree-checkbox-60" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-60"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.ArrowError.html">polars.exceptions.ArrowError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.ColumnNotFoundError.html">polars.exceptions.ColumnNotFoundError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.ComputeError.html">polars.exceptions.ComputeError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.DuplicateError.html">polars.exceptions.DuplicateError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.InvalidOperationError.html">polars.exceptions.InvalidOperationError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.NoDataError.html">polars.exceptions.NoDataError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.NoRowsReturnedError.html">polars.exceptions.NoRowsReturnedError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.PolarsError.html">polars.exceptions.PolarsError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.PolarsPanicError.html">polars.exceptions.PolarsPanicError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.RowsError.html">polars.exceptions.RowsError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.SchemaError.html">polars.exceptions.SchemaError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.SchemaFieldNotFoundError.html">polars.exceptions.SchemaFieldNotFoundError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.ShapeError.html">polars.exceptions.ShapeError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.StructFieldNotFoundError.html">polars.exceptions.StructFieldNotFoundError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.exceptions.TooManyRowsReturnedError.html">polars.exceptions.TooManyRowsReturnedError</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../testing.html">Testing</a><input class="toctree-checkbox" id="toctree-checkbox-61" name="toctree-checkbox-61" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-61"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.assert_frame_equal.html">polars.testing.assert_frame_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.assert_frame_not_equal.html">polars.testing.assert_frame_not_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.assert_series_equal.html">polars.testing.assert_series_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.assert_series_not_equal.html">polars.testing.assert_series_not_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.parametric.dataframes.html">polars.testing.parametric.dataframes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.parametric.dtypes.html">polars.testing.parametric.dtypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.parametric.lists.html">polars.testing.parametric.lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.parametric.series.html">polars.testing.parametric.series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.parametric.column.html">polars.testing.parametric.column</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.parametric.columns.html">polars.testing.parametric.columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.parametric.create_list_strategy.html">polars.testing.parametric.create_list_strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.parametric.load_profile.html">polars.testing.parametric.load_profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.testing.parametric.set_profile.html">polars.testing.parametric.set_profile</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../metadata.html">Metadata</a><input class="toctree-checkbox" id="toctree-checkbox-62" name="toctree-checkbox-62" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-62"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.build_info.html">polars.build_info</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.get_index_type.html">polars.get_index_type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.show_versions.html">polars.show_versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.thread_pool_size.html">polars.thread_pool_size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/polars.threadpool_size.html">polars.threadpool_size</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Python API reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Expressions</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="expressions">
<h1>Expressions<a class="headerlink" href="#expressions" title="Link to this heading">#</a></h1>
<p>This page gives an overview of all public Polars expressions.</p>
<div class="toctree-wrapper compound">
</div>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">polars.</span></span><span class="sig-name descname"><span class="pre">Expr</span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L118-L12342"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Expressions that can be used in various contexts.</p>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.abs.html#polars.Expr.abs" title="polars.Expr.abs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">abs</span></code></a></p></td>
<td><p>Compute absolute values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.add.html#polars.Expr.add" title="polars.Expr.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add</span></code></a></p></td>
<td><p>Method equivalent of addition operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">+</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.agg_groups.html#polars.Expr.agg_groups" title="polars.Expr.agg_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">agg_groups</span></code></a></p></td>
<td><p>Get the group indexes of the group by operation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.alias.html#polars.Expr.alias" title="polars.Expr.alias"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alias</span></code></a></p></td>
<td><p>Rename the expression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.all.html#polars.Expr.all" title="polars.Expr.all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all</span></code></a></p></td>
<td><p>Return whether all values in the column are <code class="code docutils literal notranslate"><span class="pre">True</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.and_.html#polars.Expr.and_" title="polars.Expr.and_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">and_</span></code></a></p></td>
<td><p>Method equivalent of bitwise &quot;and&quot; operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">&amp;</span> <span class="pre">other</span> <span class="pre">&amp;</span> <span class="pre">...</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.any.html#polars.Expr.any" title="polars.Expr.any"><code class="xref py py-obj docutils literal notranslate"><span class="pre">any</span></code></a></p></td>
<td><p>Return whether any of the values in the column are <code class="code docutils literal notranslate"><span class="pre">True</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.append.html#polars.Expr.append" title="polars.Expr.append"><code class="xref py py-obj docutils literal notranslate"><span class="pre">append</span></code></a></p></td>
<td><p>Append expressions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.apply.html#polars.Expr.apply" title="polars.Expr.apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code></a></p></td>
<td><p>Apply a custom/user-defined function (UDF) in a GroupBy or Projection context.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.approx_n_unique.html#polars.Expr.approx_n_unique" title="polars.Expr.approx_n_unique"><code class="xref py py-obj docutils literal notranslate"><span class="pre">approx_n_unique</span></code></a></p></td>
<td><p>Approximate count of unique values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.arccos.html#polars.Expr.arccos" title="polars.Expr.arccos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arccos</span></code></a></p></td>
<td><p>Compute the element-wise value for the inverse cosine.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.arccosh.html#polars.Expr.arccosh" title="polars.Expr.arccosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arccosh</span></code></a></p></td>
<td><p>Compute the element-wise value for the inverse hyperbolic cosine.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.arcsin.html#polars.Expr.arcsin" title="polars.Expr.arcsin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arcsin</span></code></a></p></td>
<td><p>Compute the element-wise value for the inverse sine.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.arcsinh.html#polars.Expr.arcsinh" title="polars.Expr.arcsinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arcsinh</span></code></a></p></td>
<td><p>Compute the element-wise value for the inverse hyperbolic sine.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.arctan.html#polars.Expr.arctan" title="polars.Expr.arctan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arctan</span></code></a></p></td>
<td><p>Compute the element-wise value for the inverse tangent.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.arctanh.html#polars.Expr.arctanh" title="polars.Expr.arctanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arctanh</span></code></a></p></td>
<td><p>Compute the element-wise value for the inverse hyperbolic tangent.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.arg_max.html#polars.Expr.arg_max" title="polars.Expr.arg_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arg_max</span></code></a></p></td>
<td><p>Get the index of the maximal value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.arg_min.html#polars.Expr.arg_min" title="polars.Expr.arg_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arg_min</span></code></a></p></td>
<td><p>Get the index of the minimal value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.arg_sort.html#polars.Expr.arg_sort" title="polars.Expr.arg_sort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arg_sort</span></code></a></p></td>
<td><p>Get the index values that would sort this column.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.arg_true.html#polars.Expr.arg_true" title="polars.Expr.arg_true"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arg_true</span></code></a></p></td>
<td><p>Return indices where expression evaluates <code class="code docutils literal notranslate"><span class="pre">True</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.arg_unique.html#polars.Expr.arg_unique" title="polars.Expr.arg_unique"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arg_unique</span></code></a></p></td>
<td><p>Get index of first unique value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.backward_fill.html#polars.Expr.backward_fill" title="polars.Expr.backward_fill"><code class="xref py py-obj docutils literal notranslate"><span class="pre">backward_fill</span></code></a></p></td>
<td><p>Fill missing values with the next to be seen values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.bottom_k.html#polars.Expr.bottom_k" title="polars.Expr.bottom_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bottom_k</span></code></a></p></td>
<td><p>Return the <code class="code docutils literal notranslate"><span class="pre">k</span></code> smallest elements.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.bottom_k_by.html#polars.Expr.bottom_k_by" title="polars.Expr.bottom_k_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bottom_k_by</span></code></a></p></td>
<td><p>Return the elements corresponding to the <code class="code docutils literal notranslate"><span class="pre">k</span></code> smallest elements of the <code class="code docutils literal notranslate"><span class="pre">by</span></code> column(s).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.cast.html#polars.Expr.cast" title="polars.Expr.cast"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cast</span></code></a></p></td>
<td><p>Cast between data types.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.cbrt.html#polars.Expr.cbrt" title="polars.Expr.cbrt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cbrt</span></code></a></p></td>
<td><p>Compute the cube root of the elements.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.ceil.html#polars.Expr.ceil" title="polars.Expr.ceil"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ceil</span></code></a></p></td>
<td><p>Rounds up to the nearest integer value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.clip.html#polars.Expr.clip" title="polars.Expr.clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clip</span></code></a></p></td>
<td><p>Set values outside the given boundaries to the boundary value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.clip_max.html#polars.Expr.clip_max" title="polars.Expr.clip_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clip_max</span></code></a></p></td>
<td><p>Clip (limit) the values in an array to a <code class="code docutils literal notranslate"><span class="pre">max</span></code> boundary.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.clip_min.html#polars.Expr.clip_min" title="polars.Expr.clip_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clip_min</span></code></a></p></td>
<td><p>Clip (limit) the values in an array to a <code class="code docutils literal notranslate"><span class="pre">min</span></code> boundary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.cos.html#polars.Expr.cos" title="polars.Expr.cos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cos</span></code></a></p></td>
<td><p>Compute the element-wise value for the cosine.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.cosh.html#polars.Expr.cosh" title="polars.Expr.cosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cosh</span></code></a></p></td>
<td><p>Compute the element-wise value for the hyperbolic cosine.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.cot.html#polars.Expr.cot" title="polars.Expr.cot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cot</span></code></a></p></td>
<td><p>Compute the element-wise value for the cotangent.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.count.html#polars.Expr.count" title="polars.Expr.count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count</span></code></a></p></td>
<td><p>Return the number of non-null elements in the column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.cum_count.html#polars.Expr.cum_count" title="polars.Expr.cum_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cum_count</span></code></a></p></td>
<td><p>Return the cumulative count of the non-null values in the column.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.cum_max.html#polars.Expr.cum_max" title="polars.Expr.cum_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cum_max</span></code></a></p></td>
<td><p>Get an array with the cumulative max computed at every element.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.cum_min.html#polars.Expr.cum_min" title="polars.Expr.cum_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cum_min</span></code></a></p></td>
<td><p>Get an array with the cumulative min computed at every element.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.cum_prod.html#polars.Expr.cum_prod" title="polars.Expr.cum_prod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cum_prod</span></code></a></p></td>
<td><p>Get an array with the cumulative product computed at every element.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.cum_sum.html#polars.Expr.cum_sum" title="polars.Expr.cum_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cum_sum</span></code></a></p></td>
<td><p>Get an array with the cumulative sum computed at every element.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.cumcount.html#polars.Expr.cumcount" title="polars.Expr.cumcount"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cumcount</span></code></a></p></td>
<td><p>Get an array with the cumulative count computed at every element.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.cummax.html#polars.Expr.cummax" title="polars.Expr.cummax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cummax</span></code></a></p></td>
<td><p>Get an array with the cumulative max computed at every element.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.cummin.html#polars.Expr.cummin" title="polars.Expr.cummin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cummin</span></code></a></p></td>
<td><p>Get an array with the cumulative min computed at every element.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.cumprod.html#polars.Expr.cumprod" title="polars.Expr.cumprod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cumprod</span></code></a></p></td>
<td><p>Get an array with the cumulative product computed at every element.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.cumsum.html#polars.Expr.cumsum" title="polars.Expr.cumsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cumsum</span></code></a></p></td>
<td><p>Get an array with the cumulative sum computed at every element.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.cumulative_eval.html#polars.Expr.cumulative_eval" title="polars.Expr.cumulative_eval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cumulative_eval</span></code></a></p></td>
<td><p>Run an expression over a sliding window that increases <code class="code docutils literal notranslate"><span class="pre">1</span></code> slot every iteration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.cut.html#polars.Expr.cut" title="polars.Expr.cut"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cut</span></code></a></p></td>
<td><p>Bin continuous values into discrete categories.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.degrees.html#polars.Expr.degrees" title="polars.Expr.degrees"><code class="xref py py-obj docutils literal notranslate"><span class="pre">degrees</span></code></a></p></td>
<td><p>Convert from radians to degrees.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.deserialize.html#polars.Expr.deserialize" title="polars.Expr.deserialize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deserialize</span></code></a></p></td>
<td><p>Read a serialized expression from a file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.diff.html#polars.Expr.diff" title="polars.Expr.diff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">diff</span></code></a></p></td>
<td><p>Calculate the first discrete difference between shifted items.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.dot.html#polars.Expr.dot" title="polars.Expr.dot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dot</span></code></a></p></td>
<td><p>Compute the dot/inner product between two Expressions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.drop_nans.html#polars.Expr.drop_nans" title="polars.Expr.drop_nans"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_nans</span></code></a></p></td>
<td><p>Drop all floating point NaN values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.drop_nulls.html#polars.Expr.drop_nulls" title="polars.Expr.drop_nulls"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_nulls</span></code></a></p></td>
<td><p>Drop all null values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.entropy.html#polars.Expr.entropy" title="polars.Expr.entropy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">entropy</span></code></a></p></td>
<td><p>Computes the entropy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.eq.html#polars.Expr.eq" title="polars.Expr.eq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eq</span></code></a></p></td>
<td><p>Method equivalent of equality operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">==</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.eq_missing.html#polars.Expr.eq_missing" title="polars.Expr.eq_missing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eq_missing</span></code></a></p></td>
<td><p>Method equivalent of equality operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">==</span> <span class="pre">other</span></code> where <code class="code docutils literal notranslate"><span class="pre">None</span> <span class="pre">==</span> <span class="pre">None</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.ewm_mean.html#polars.Expr.ewm_mean" title="polars.Expr.ewm_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ewm_mean</span></code></a></p></td>
<td><p>Exponentially-weighted moving average.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.ewm_mean_by.html#polars.Expr.ewm_mean_by" title="polars.Expr.ewm_mean_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ewm_mean_by</span></code></a></p></td>
<td><p>Calculate time-based exponentially weighted moving average.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.ewm_std.html#polars.Expr.ewm_std" title="polars.Expr.ewm_std"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ewm_std</span></code></a></p></td>
<td><p>Exponentially-weighted moving standard deviation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.ewm_var.html#polars.Expr.ewm_var" title="polars.Expr.ewm_var"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ewm_var</span></code></a></p></td>
<td><p>Exponentially-weighted moving variance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.exclude.html#polars.Expr.exclude" title="polars.Expr.exclude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exclude</span></code></a></p></td>
<td><p>Exclude columns from a multi-column expression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.exp.html#polars.Expr.exp" title="polars.Expr.exp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exp</span></code></a></p></td>
<td><p>Compute the exponential, element-wise.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.explode.html#polars.Expr.explode" title="polars.Expr.explode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">explode</span></code></a></p></td>
<td><p>Explode a list expression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.extend_constant.html#polars.Expr.extend_constant" title="polars.Expr.extend_constant"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extend_constant</span></code></a></p></td>
<td><p>Extremely fast method for extending the Series with 'n' copies of a value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.fill_nan.html#polars.Expr.fill_nan" title="polars.Expr.fill_nan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_nan</span></code></a></p></td>
<td><p>Fill floating point NaN value with a fill value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.fill_null.html#polars.Expr.fill_null" title="polars.Expr.fill_null"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_null</span></code></a></p></td>
<td><p>Fill null values using the specified value or strategy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.filter.html#polars.Expr.filter" title="polars.Expr.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a></p></td>
<td><p>Filter the expression based on one or more predicate expressions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.first.html#polars.Expr.first" title="polars.Expr.first"><code class="xref py py-obj docutils literal notranslate"><span class="pre">first</span></code></a></p></td>
<td><p>Get the first value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.flatten.html#polars.Expr.flatten" title="polars.Expr.flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flatten</span></code></a></p></td>
<td><p>Flatten a list or string column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.floor.html#polars.Expr.floor" title="polars.Expr.floor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">floor</span></code></a></p></td>
<td><p>Rounds down to the nearest integer value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.floordiv.html#polars.Expr.floordiv" title="polars.Expr.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">floordiv</span></code></a></p></td>
<td><p>Method equivalent of integer division operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">//</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.forward_fill.html#polars.Expr.forward_fill" title="polars.Expr.forward_fill"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward_fill</span></code></a></p></td>
<td><p>Fill missing values with the latest seen values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.from_json.html#polars.Expr.from_json" title="polars.Expr.from_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_json</span></code></a></p></td>
<td><p>Read an expression from a JSON encoded string to construct an Expression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.gather.html#polars.Expr.gather" title="polars.Expr.gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gather</span></code></a></p></td>
<td><p>Take values by index.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.gather_every.html#polars.Expr.gather_every" title="polars.Expr.gather_every"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gather_every</span></code></a></p></td>
<td><p>Take every nth value in the Series and return as a new Series.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.ge.html#polars.Expr.ge" title="polars.Expr.ge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ge</span></code></a></p></td>
<td><p>Method equivalent of &quot;greater than or equal&quot; operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">&gt;=</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.get.html#polars.Expr.get" title="polars.Expr.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get</span></code></a></p></td>
<td><p>Return a single value by index.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.gt.html#polars.Expr.gt" title="polars.Expr.gt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gt</span></code></a></p></td>
<td><p>Method equivalent of &quot;greater than&quot; operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">&gt;</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.has_nulls.html#polars.Expr.has_nulls" title="polars.Expr.has_nulls"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_nulls</span></code></a></p></td>
<td><p>Check whether the expression contains one or more null values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.hash.html#polars.Expr.hash" title="polars.Expr.hash"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hash</span></code></a></p></td>
<td><p>Hash the elements in the selection.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.head.html#polars.Expr.head" title="polars.Expr.head"><code class="xref py py-obj docutils literal notranslate"><span class="pre">head</span></code></a></p></td>
<td><p>Get the first <code class="code docutils literal notranslate"><span class="pre">n</span></code> rows.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.hist.html#polars.Expr.hist" title="polars.Expr.hist"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hist</span></code></a></p></td>
<td><p>Bin values into buckets and count their occurrences.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.implode.html#polars.Expr.implode" title="polars.Expr.implode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">implode</span></code></a></p></td>
<td><p>Aggregate values into a list.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.inspect.html#polars.Expr.inspect" title="polars.Expr.inspect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inspect</span></code></a></p></td>
<td><p>Print the value that this expression evaluates to and pass on the value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.interpolate.html#polars.Expr.interpolate" title="polars.Expr.interpolate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interpolate</span></code></a></p></td>
<td><p>Fill null values using interpolation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.interpolate_by.html#polars.Expr.interpolate_by" title="polars.Expr.interpolate_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interpolate_by</span></code></a></p></td>
<td><p>Fill null values using interpolation based on another column.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.is_between.html#polars.Expr.is_between" title="polars.Expr.is_between"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_between</span></code></a></p></td>
<td><p>Check if this expression is between the given lower and upper bounds.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.is_duplicated.html#polars.Expr.is_duplicated" title="polars.Expr.is_duplicated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_duplicated</span></code></a></p></td>
<td><p>Return a boolean mask indicating duplicated values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.is_finite.html#polars.Expr.is_finite" title="polars.Expr.is_finite"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_finite</span></code></a></p></td>
<td><p>Returns a boolean Series indicating which values are finite.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.is_first.html#polars.Expr.is_first" title="polars.Expr.is_first"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_first</span></code></a></p></td>
<td><p>Return a boolean mask indicating the first occurrence of each distinct value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.is_first_distinct.html#polars.Expr.is_first_distinct" title="polars.Expr.is_first_distinct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_first_distinct</span></code></a></p></td>
<td><p>Return a boolean mask indicating the first occurrence of each distinct value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.is_in.html#polars.Expr.is_in" title="polars.Expr.is_in"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_in</span></code></a></p></td>
<td><p>Check if elements of this expression are present in the other Series.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.is_infinite.html#polars.Expr.is_infinite" title="polars.Expr.is_infinite"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_infinite</span></code></a></p></td>
<td><p>Returns a boolean Series indicating which values are infinite.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.is_last.html#polars.Expr.is_last" title="polars.Expr.is_last"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_last</span></code></a></p></td>
<td><p>Return a boolean mask indicating the last occurrence of each distinct value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.is_last_distinct.html#polars.Expr.is_last_distinct" title="polars.Expr.is_last_distinct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_last_distinct</span></code></a></p></td>
<td><p>Return a boolean mask indicating the last occurrence of each distinct value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.is_nan.html#polars.Expr.is_nan" title="polars.Expr.is_nan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_nan</span></code></a></p></td>
<td><p>Returns a boolean Series indicating which values are NaN.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.is_not.html#polars.Expr.is_not" title="polars.Expr.is_not"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_not</span></code></a></p></td>
<td><p>Negate a boolean expression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.is_not_nan.html#polars.Expr.is_not_nan" title="polars.Expr.is_not_nan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_not_nan</span></code></a></p></td>
<td><p>Returns a boolean Series indicating which values are not NaN.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.is_not_null.html#polars.Expr.is_not_null" title="polars.Expr.is_not_null"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_not_null</span></code></a></p></td>
<td><p>Returns a boolean Series indicating which values are not null.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.is_null.html#polars.Expr.is_null" title="polars.Expr.is_null"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_null</span></code></a></p></td>
<td><p>Returns a boolean Series indicating which values are null.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.is_unique.html#polars.Expr.is_unique" title="polars.Expr.is_unique"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_unique</span></code></a></p></td>
<td><p>Get mask of unique values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.keep_name.html#polars.Expr.keep_name" title="polars.Expr.keep_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">keep_name</span></code></a></p></td>
<td><p>Keep the original root name of the expression.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.kurtosis.html#polars.Expr.kurtosis" title="polars.Expr.kurtosis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kurtosis</span></code></a></p></td>
<td><p>Compute the kurtosis (Fisher or Pearson) of a dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.last.html#polars.Expr.last" title="polars.Expr.last"><code class="xref py py-obj docutils literal notranslate"><span class="pre">last</span></code></a></p></td>
<td><p>Get the last value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.le.html#polars.Expr.le" title="polars.Expr.le"><code class="xref py py-obj docutils literal notranslate"><span class="pre">le</span></code></a></p></td>
<td><p>Method equivalent of &quot;less than or equal&quot; operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">&lt;=</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.len.html#polars.Expr.len" title="polars.Expr.len"><code class="xref py py-obj docutils literal notranslate"><span class="pre">len</span></code></a></p></td>
<td><p>Return the number of elements in the column.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.limit.html#polars.Expr.limit" title="polars.Expr.limit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">limit</span></code></a></p></td>
<td><p>Get the first <code class="code docutils literal notranslate"><span class="pre">n</span></code> rows (alias for <a class="reference internal" href="api/polars.Expr.head.html#polars.Expr.head" title="polars.Expr.head"><code class="xref py py-func docutils literal notranslate"><span class="pre">Expr.head()</span></code></a>).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.log.html#polars.Expr.log" title="polars.Expr.log"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log</span></code></a></p></td>
<td><p>Compute the logarithm to a given base.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.log10.html#polars.Expr.log10" title="polars.Expr.log10"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log10</span></code></a></p></td>
<td><p>Compute the base 10 logarithm of the input array, element-wise.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.log1p.html#polars.Expr.log1p" title="polars.Expr.log1p"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log1p</span></code></a></p></td>
<td><p>Compute the natural logarithm of each element plus one.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.lower_bound.html#polars.Expr.lower_bound" title="polars.Expr.lower_bound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lower_bound</span></code></a></p></td>
<td><p>Calculate the lower bound.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.lt.html#polars.Expr.lt" title="polars.Expr.lt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lt</span></code></a></p></td>
<td><p>Method equivalent of &quot;less than&quot; operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">&lt;</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.map.html#polars.Expr.map" title="polars.Expr.map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">map</span></code></a></p></td>
<td><p>Apply a custom python function to a Series or sequence of Series.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.map_alias.html#polars.Expr.map_alias" title="polars.Expr.map_alias"><code class="xref py py-obj docutils literal notranslate"><span class="pre">map_alias</span></code></a></p></td>
<td><p>Rename the output of an expression by mapping a function over the root name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.map_batches.html#polars.Expr.map_batches" title="polars.Expr.map_batches"><code class="xref py py-obj docutils literal notranslate"><span class="pre">map_batches</span></code></a></p></td>
<td><p>Apply a custom python function to a whole Series or sequence of Series.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.map_dict.html#polars.Expr.map_dict" title="polars.Expr.map_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">map_dict</span></code></a></p></td>
<td><p>Replace values in column according to remapping dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.map_elements.html#polars.Expr.map_elements" title="polars.Expr.map_elements"><code class="xref py py-obj docutils literal notranslate"><span class="pre">map_elements</span></code></a></p></td>
<td><p>Map a custom/user-defined function (UDF) to each element of a column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.max.html#polars.Expr.max" title="polars.Expr.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">max</span></code></a></p></td>
<td><p>Get maximum value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.mean.html#polars.Expr.mean" title="polars.Expr.mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean</span></code></a></p></td>
<td><p>Get mean value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.median.html#polars.Expr.median" title="polars.Expr.median"><code class="xref py py-obj docutils literal notranslate"><span class="pre">median</span></code></a></p></td>
<td><p>Get median value using linear interpolation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.min.html#polars.Expr.min" title="polars.Expr.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">min</span></code></a></p></td>
<td><p>Get minimum value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.mod.html#polars.Expr.mod" title="polars.Expr.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mod</span></code></a></p></td>
<td><p>Method equivalent of modulus operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">%</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.mode.html#polars.Expr.mode" title="polars.Expr.mode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mode</span></code></a></p></td>
<td><p>Compute the most occurring value(s).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.mul.html#polars.Expr.mul" title="polars.Expr.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mul</span></code></a></p></td>
<td><p>Method equivalent of multiplication operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">*</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.n_unique.html#polars.Expr.n_unique" title="polars.Expr.n_unique"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_unique</span></code></a></p></td>
<td><p>Count unique values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.nan_max.html#polars.Expr.nan_max" title="polars.Expr.nan_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nan_max</span></code></a></p></td>
<td><p>Get maximum value, but propagate/poison encountered NaN values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.nan_min.html#polars.Expr.nan_min" title="polars.Expr.nan_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nan_min</span></code></a></p></td>
<td><p>Get minimum value, but propagate/poison encountered NaN values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.ne.html#polars.Expr.ne" title="polars.Expr.ne"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ne</span></code></a></p></td>
<td><p>Method equivalent of inequality operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">!=</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.ne_missing.html#polars.Expr.ne_missing" title="polars.Expr.ne_missing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ne_missing</span></code></a></p></td>
<td><p>Method equivalent of equality operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">!=</span> <span class="pre">other</span></code> where <code class="code docutils literal notranslate"><span class="pre">None</span> <span class="pre">==</span> <span class="pre">None</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.neg.html#polars.Expr.neg" title="polars.Expr.neg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">neg</span></code></a></p></td>
<td><p>Method equivalent of unary minus operator <code class="code docutils literal notranslate"><span class="pre">-expr</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.not_.html#polars.Expr.not_" title="polars.Expr.not_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">not_</span></code></a></p></td>
<td><p>Negate a boolean expression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.null_count.html#polars.Expr.null_count" title="polars.Expr.null_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">null_count</span></code></a></p></td>
<td><p>Count null values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.or_.html#polars.Expr.or_" title="polars.Expr.or_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">or_</span></code></a></p></td>
<td><p>Method equivalent of bitwise &quot;or&quot; operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">|</span> <span class="pre">other</span> <span class="pre">|</span> <span class="pre">...</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.over.html#polars.Expr.over" title="polars.Expr.over"><code class="xref py py-obj docutils literal notranslate"><span class="pre">over</span></code></a></p></td>
<td><p>Compute expressions over the given groups.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.pct_change.html#polars.Expr.pct_change" title="polars.Expr.pct_change"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pct_change</span></code></a></p></td>
<td><p>Computes percentage change between values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.peak_max.html#polars.Expr.peak_max" title="polars.Expr.peak_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">peak_max</span></code></a></p></td>
<td><p>Get a boolean mask of the local maximum peaks.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.peak_min.html#polars.Expr.peak_min" title="polars.Expr.peak_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">peak_min</span></code></a></p></td>
<td><p>Get a boolean mask of the local minimum peaks.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.pipe.html#polars.Expr.pipe" title="polars.Expr.pipe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pipe</span></code></a></p></td>
<td><p>Offers a structured way to apply a sequence of user-defined functions (UDFs).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.pow.html#polars.Expr.pow" title="polars.Expr.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pow</span></code></a></p></td>
<td><p>Method equivalent of exponentiation operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">**</span> <span class="pre">exponent</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.prefix.html#polars.Expr.prefix" title="polars.Expr.prefix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prefix</span></code></a></p></td>
<td><p>Add a prefix to the root column name of the expression.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.product.html#polars.Expr.product" title="polars.Expr.product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">product</span></code></a></p></td>
<td><p>Compute the product of an expression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.qcut.html#polars.Expr.qcut" title="polars.Expr.qcut"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qcut</span></code></a></p></td>
<td><p>Bin continuous values into discrete categories based on their quantiles.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.quantile.html#polars.Expr.quantile" title="polars.Expr.quantile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">quantile</span></code></a></p></td>
<td><p>Get quantile value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.radians.html#polars.Expr.radians" title="polars.Expr.radians"><code class="xref py py-obj docutils literal notranslate"><span class="pre">radians</span></code></a></p></td>
<td><p>Convert from degrees to radians.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rank.html#polars.Expr.rank" title="polars.Expr.rank"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rank</span></code></a></p></td>
<td><p>Assign ranks to data, dealing with ties appropriately.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rechunk.html#polars.Expr.rechunk" title="polars.Expr.rechunk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rechunk</span></code></a></p></td>
<td><p>Create a single chunk of memory for this Series.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_plugin</span></code></p></td>
<td><p>Register a plugin function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.reinterpret.html#polars.Expr.reinterpret" title="polars.Expr.reinterpret"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reinterpret</span></code></a></p></td>
<td><p>Reinterpret the underlying bits as a signed/unsigned integer.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.repeat_by.html#polars.Expr.repeat_by" title="polars.Expr.repeat_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">repeat_by</span></code></a></p></td>
<td><p>Repeat the elements in this Series as specified in the given expression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.replace.html#polars.Expr.replace" title="polars.Expr.replace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">replace</span></code></a></p></td>
<td><p>Replace values by different values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.reshape.html#polars.Expr.reshape" title="polars.Expr.reshape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reshape</span></code></a></p></td>
<td><p>Reshape this Expr to a flat Series or a Series of Lists.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.reverse.html#polars.Expr.reverse" title="polars.Expr.reverse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reverse</span></code></a></p></td>
<td><p>Reverse the selection.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rle.html#polars.Expr.rle" title="polars.Expr.rle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rle</span></code></a></p></td>
<td><p>Compress the column data using run-length encoding.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rle_id.html#polars.Expr.rle_id" title="polars.Expr.rle_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rle_id</span></code></a></p></td>
<td><p>Get a distinct integer ID for each run of identical values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rolling.html#polars.Expr.rolling" title="polars.Expr.rolling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling</span></code></a></p></td>
<td><p>Create rolling groups based on a temporal or integer column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rolling_apply.html#polars.Expr.rolling_apply" title="polars.Expr.rolling_apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_apply</span></code></a></p></td>
<td><p>Apply a custom rolling window function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rolling_map.html#polars.Expr.rolling_map" title="polars.Expr.rolling_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_map</span></code></a></p></td>
<td><p>Compute a custom rolling window function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rolling_max.html#polars.Expr.rolling_max" title="polars.Expr.rolling_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_max</span></code></a></p></td>
<td><p>Apply a rolling max (moving max) over the values in this array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rolling_max_by.html#polars.Expr.rolling_max_by" title="polars.Expr.rolling_max_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_max_by</span></code></a></p></td>
<td><p>Apply a rolling max based on another column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rolling_mean.html#polars.Expr.rolling_mean" title="polars.Expr.rolling_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_mean</span></code></a></p></td>
<td><p>Apply a rolling mean (moving mean) over the values in this array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rolling_mean_by.html#polars.Expr.rolling_mean_by" title="polars.Expr.rolling_mean_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_mean_by</span></code></a></p></td>
<td><p>Apply a rolling mean based on another column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rolling_median.html#polars.Expr.rolling_median" title="polars.Expr.rolling_median"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_median</span></code></a></p></td>
<td><p>Compute a rolling median.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rolling_median_by.html#polars.Expr.rolling_median_by" title="polars.Expr.rolling_median_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_median_by</span></code></a></p></td>
<td><p>Compute a rolling median based on another column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rolling_min.html#polars.Expr.rolling_min" title="polars.Expr.rolling_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_min</span></code></a></p></td>
<td><p>Apply a rolling min (moving min) over the values in this array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rolling_min_by.html#polars.Expr.rolling_min_by" title="polars.Expr.rolling_min_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_min_by</span></code></a></p></td>
<td><p>Apply a rolling min based on another column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rolling_quantile.html#polars.Expr.rolling_quantile" title="polars.Expr.rolling_quantile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_quantile</span></code></a></p></td>
<td><p>Compute a rolling quantile.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rolling_quantile_by.html#polars.Expr.rolling_quantile_by" title="polars.Expr.rolling_quantile_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_quantile_by</span></code></a></p></td>
<td><p>Compute a rolling quantile based on another column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rolling_skew.html#polars.Expr.rolling_skew" title="polars.Expr.rolling_skew"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_skew</span></code></a></p></td>
<td><p>Compute a rolling skew.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rolling_std.html#polars.Expr.rolling_std" title="polars.Expr.rolling_std"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_std</span></code></a></p></td>
<td><p>Compute a rolling standard deviation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rolling_std_by.html#polars.Expr.rolling_std_by" title="polars.Expr.rolling_std_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_std_by</span></code></a></p></td>
<td><p>Compute a rolling standard deviation based on another column.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rolling_sum.html#polars.Expr.rolling_sum" title="polars.Expr.rolling_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_sum</span></code></a></p></td>
<td><p>Apply a rolling sum (moving sum) over the values in this array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rolling_sum_by.html#polars.Expr.rolling_sum_by" title="polars.Expr.rolling_sum_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_sum_by</span></code></a></p></td>
<td><p>Apply a rolling sum based on another column.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.rolling_var.html#polars.Expr.rolling_var" title="polars.Expr.rolling_var"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_var</span></code></a></p></td>
<td><p>Compute a rolling variance.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.rolling_var_by.html#polars.Expr.rolling_var_by" title="polars.Expr.rolling_var_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_var_by</span></code></a></p></td>
<td><p>Compute a rolling variance based on another column.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.round.html#polars.Expr.round" title="polars.Expr.round"><code class="xref py py-obj docutils literal notranslate"><span class="pre">round</span></code></a></p></td>
<td><p>Round underlying floating point data by <code class="code docutils literal notranslate"><span class="pre">decimals</span></code> digits.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.round_sig_figs.html#polars.Expr.round_sig_figs" title="polars.Expr.round_sig_figs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">round_sig_figs</span></code></a></p></td>
<td><p>Round to a number of significant figures.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.sample.html#polars.Expr.sample" title="polars.Expr.sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code></a></p></td>
<td><p>Sample from this expression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.search_sorted.html#polars.Expr.search_sorted" title="polars.Expr.search_sorted"><code class="xref py py-obj docutils literal notranslate"><span class="pre">search_sorted</span></code></a></p></td>
<td><p>Find indices where elements should be inserted to maintain order.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.set_sorted.html#polars.Expr.set_sorted" title="polars.Expr.set_sorted"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_sorted</span></code></a></p></td>
<td><p>Flags the expression as 'sorted'.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.shift.html#polars.Expr.shift" title="polars.Expr.shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift</span></code></a></p></td>
<td><p>Shift values by the given number of indices.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.shift_and_fill.html#polars.Expr.shift_and_fill" title="polars.Expr.shift_and_fill"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift_and_fill</span></code></a></p></td>
<td><p>Shift values by the given number of places and fill the resulting null values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.shrink_dtype.html#polars.Expr.shrink_dtype" title="polars.Expr.shrink_dtype"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shrink_dtype</span></code></a></p></td>
<td><p>Shrink numeric columns to the minimal required datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.shuffle.html#polars.Expr.shuffle" title="polars.Expr.shuffle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shuffle</span></code></a></p></td>
<td><p>Shuffle the contents of this expression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.sign.html#polars.Expr.sign" title="polars.Expr.sign"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sign</span></code></a></p></td>
<td><p>Compute the element-wise indication of the sign.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.sin.html#polars.Expr.sin" title="polars.Expr.sin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sin</span></code></a></p></td>
<td><p>Compute the element-wise value for the sine.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.sinh.html#polars.Expr.sinh" title="polars.Expr.sinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sinh</span></code></a></p></td>
<td><p>Compute the element-wise value for the hyperbolic sine.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.skew.html#polars.Expr.skew" title="polars.Expr.skew"><code class="xref py py-obj docutils literal notranslate"><span class="pre">skew</span></code></a></p></td>
<td><p>Compute the sample skewness of a data set.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.slice.html#polars.Expr.slice" title="polars.Expr.slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">slice</span></code></a></p></td>
<td><p>Get a slice of this expression.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.sort.html#polars.Expr.sort" title="polars.Expr.sort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sort</span></code></a></p></td>
<td><p>Sort this column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.sort_by.html#polars.Expr.sort_by" title="polars.Expr.sort_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sort_by</span></code></a></p></td>
<td><p>Sort this column by the ordering of other columns.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.sqrt.html#polars.Expr.sqrt" title="polars.Expr.sqrt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sqrt</span></code></a></p></td>
<td><p>Compute the square root of the elements.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.std.html#polars.Expr.std" title="polars.Expr.std"><code class="xref py py-obj docutils literal notranslate"><span class="pre">std</span></code></a></p></td>
<td><p>Get standard deviation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.sub.html#polars.Expr.sub" title="polars.Expr.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sub</span></code></a></p></td>
<td><p>Method equivalent of subtraction operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">-</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.suffix.html#polars.Expr.suffix" title="polars.Expr.suffix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">suffix</span></code></a></p></td>
<td><p>Add a suffix to the root column name of the expression.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.sum.html#polars.Expr.sum" title="polars.Expr.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum</span></code></a></p></td>
<td><p>Get sum value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.tail.html#polars.Expr.tail" title="polars.Expr.tail"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tail</span></code></a></p></td>
<td><p>Get the last <code class="code docutils literal notranslate"><span class="pre">n</span></code> rows.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.take.html#polars.Expr.take" title="polars.Expr.take"><code class="xref py py-obj docutils literal notranslate"><span class="pre">take</span></code></a></p></td>
<td><p>Take values by index.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.take_every.html#polars.Expr.take_every" title="polars.Expr.take_every"><code class="xref py py-obj docutils literal notranslate"><span class="pre">take_every</span></code></a></p></td>
<td><p>Take every nth value in the Series and return as a new Series.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.tan.html#polars.Expr.tan" title="polars.Expr.tan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tan</span></code></a></p></td>
<td><p>Compute the element-wise value for the tangent.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.tanh.html#polars.Expr.tanh" title="polars.Expr.tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tanh</span></code></a></p></td>
<td><p>Compute the element-wise value for the hyperbolic tangent.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.to_physical.html#polars.Expr.to_physical" title="polars.Expr.to_physical"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_physical</span></code></a></p></td>
<td><p>Cast to physical representation of the logical dtype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.top_k.html#polars.Expr.top_k" title="polars.Expr.top_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">top_k</span></code></a></p></td>
<td><p>Return the <code class="code docutils literal notranslate"><span class="pre">k</span></code> largest elements.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.top_k_by.html#polars.Expr.top_k_by" title="polars.Expr.top_k_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">top_k_by</span></code></a></p></td>
<td><p>Return the elements corresponding to the <code class="code docutils literal notranslate"><span class="pre">k</span></code> largest elements of the <code class="code docutils literal notranslate"><span class="pre">by</span></code> column(s).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.truediv.html#polars.Expr.truediv" title="polars.Expr.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">truediv</span></code></a></p></td>
<td><p>Method equivalent of float division operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">/</span> <span class="pre">other</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.unique.html#polars.Expr.unique" title="polars.Expr.unique"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unique</span></code></a></p></td>
<td><p>Get unique values of this expression.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.unique_counts.html#polars.Expr.unique_counts" title="polars.Expr.unique_counts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unique_counts</span></code></a></p></td>
<td><p>Return a count of the unique values in the order of appearance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.upper_bound.html#polars.Expr.upper_bound" title="polars.Expr.upper_bound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">upper_bound</span></code></a></p></td>
<td><p>Calculate the upper bound.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.value_counts.html#polars.Expr.value_counts" title="polars.Expr.value_counts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">value_counts</span></code></a></p></td>
<td><p>Count the occurrences of unique values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.var.html#polars.Expr.var" title="polars.Expr.var"><code class="xref py py-obj docutils literal notranslate"><span class="pre">var</span></code></a></p></td>
<td><p>Get variance.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/polars.Expr.where.html#polars.Expr.where" title="polars.Expr.where"><code class="xref py py-obj docutils literal notranslate"><span class="pre">where</span></code></a></p></td>
<td><p>Filter a single column.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/polars.Expr.xor.html#polars.Expr.xor" title="polars.Expr.xor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xor</span></code></a></p></td>
<td><p>Method equivalent of bitwise exclusive-or operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">^</span> <span class="pre">other</span></code>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L9786-L9812"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute absolute values.</p>
<p>Same as <code class="code docutils literal notranslate"><span class="pre">abs(expr)</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">())</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> A   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 1.0 </span>
<span class="go"> 0.0 </span>
<span class="go"> 1.0 </span>
<span class="go"> 2.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5700-L5744"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of addition operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">+</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>numeric or string value; accepts expression input.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x+int&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_prod</span><span class="p">())</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x+expr&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> x    x+int  x+expr </span>
<span class="go"> ---  ---    ---    </span>
<span class="go"> i64  i64    i64    </span>
<span class="go"></span>
<span class="go"> 1    3      2      </span>
<span class="go"> 2    4      4      </span>
<span class="go"> 3    5      9      </span>
<span class="go"> 4    6      28     </span>
<span class="go"> 5    7      125    </span>
<span class="go"></span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">],</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">]}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;xyz&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 4)</span>
<span class="go"></span>
<span class="go"> x    y    z    xyz </span>
<span class="go"> ---  ---  ---  --- </span>
<span class="go"> str  str  str  str </span>
<span class="go"></span>
<span class="go"> a    b    c    abc </span>
<span class="go"> d    e    f    def </span>
<span class="go"> g    h    i    ghi </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">agg_groups</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1297-L1329"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get the group indexes of the group by operation.</p>
<p>Should be used in aggregation context only.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">... </span>            <span class="s2">&quot;one&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;one&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;one&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;two&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;two&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;two&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">94</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">maintain_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg_groups</span><span class="p">())</span>
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> group  value     </span>
<span class="go"> ---    ---       </span>
<span class="go"> str    list[u32] </span>
<span class="go"></span>
<span class="go"> one    [0, 1, 2] </span>
<span class="go"> two    [3, 4, 5] </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">alias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L653-L711"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Rename the expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong></dt><dd><p>The new name.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.map.html#polars.map" title="polars.map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">map</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.prefix.html#polars.Expr.prefix" title="polars.Expr.prefix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prefix</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.suffix.html#polars.Expr.suffix" title="polars.Expr.suffix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">suffix</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Rename an expression to avoid overwriting an existing column.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">to_uppercase</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (3, 3)</span>
<span class="go"></span>
<span class="go"> a    b    c   </span>
<span class="go"> ---  ---  --- </span>
<span class="go"> i64  str  str </span>
<span class="go"></span>
<span class="go"> 11   x    X   </span>
<span class="go"> 12   y    Y   </span>
<span class="go"> 13   z    Z   </span>
<span class="go"></span>
</pre></div>
</div>
<p>Overwrite the default name of literal columns to prevent errors due to duplicate
column names.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (3, 4)</span>
<span class="go"></span>
<span class="go"> a    b    c     d   </span>
<span class="go"> ---  ---  ---   --- </span>
<span class="go"> i64  str  bool  f64 </span>
<span class="go"></span>
<span class="go"> 1    x    true  4.0 </span>
<span class="go"> 2    y    true  4.0 </span>
<span class="go"> 3    z    true  4.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_nulls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L479-L537"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return whether all values in the column are <code class="code docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Only works on columns of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not to be confused with the function <a class="reference internal" href="api/polars.all.html#polars.all" title="polars.all"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.all()</span></code></a>,
which can be used to select all columns.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ignore_nulls</strong></dt><dd><p>Ignore null values (default).</p>
<p>If set to <code class="code docutils literal notranslate"><span class="pre">False</span></code>, <a class="reference external" href="https://en.wikipedia.org/wiki/Three-valued_logic">Kleene logic</a> is used to deal with nulls:
if the column contains any null values and no <code class="code docutils literal notranslate"><span class="pre">True</span></code> values,
the output is null.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">shape: (1, 3)</span>
<span class="go"></span>
<span class="go"> a     b      c    </span>
<span class="go"> ---   ---    ---  </span>
<span class="go"> bool  bool   bool </span>
<span class="go"></span>
<span class="go"> true  false  true </span>
<span class="go"></span>
</pre></div>
</div>
<p>Enable Kleene logic by setting <code class="code docutils literal notranslate"><span class="pre">ignore_nulls=False</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">ignore_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">shape: (1, 3)</span>
<span class="go"></span>
<span class="go"> a     b      c    </span>
<span class="go"> ---   ---    ---  </span>
<span class="go"> bool  bool   bool </span>
<span class="go"></span>
<span class="go"> true  false  null </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">and_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5331-L5372"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of bitwise and operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">&amp;</span> <span class="pre">other</span> <span class="pre">&amp;</span> <span class="pre">...</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>*others</strong></dt><dd><p>One or more integer or boolean expressions to evaluate/combine.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.75</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">and_</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 1)</span>
<span class="go"></span>
<span class="go"> all   </span>
<span class="go"> ---   </span>
<span class="go"> bool  </span>
<span class="go"></span>
<span class="go"> true  </span>
<span class="go"> true  </span>
<span class="go"> true  </span>
<span class="go"> false </span>
<span class="go"> false </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">any</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_nulls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L423-L477"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return whether any of the values in the column are <code class="code docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Only works on columns of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ignore_nulls</strong></dt><dd><p>Ignore null values (default).</p>
<p>If set to <code class="code docutils literal notranslate"><span class="pre">False</span></code>, <a class="reference external" href="https://en.wikipedia.org/wiki/Three-valued_logic">Kleene logic</a> is used to deal with nulls:
if the column contains any null values and no <code class="code docutils literal notranslate"><span class="pre">True</span></code> values,
the output is null.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">())</span>
<span class="go">shape: (1, 3)</span>
<span class="go"></span>
<span class="go"> a     b      c     </span>
<span class="go"> ---   ---    ---   </span>
<span class="go"> bool  bool   bool  </span>
<span class="go"></span>
<span class="go"> true  false  false </span>
<span class="go"></span>
</pre></div>
</div>
<p>Enable Kleene logic by setting <code class="code docutils literal notranslate"><span class="pre">ignore_nulls=False</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">ignore_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">shape: (1, 3)</span>
<span class="go"></span>
<span class="go"> a     b      c    </span>
<span class="go"> ---   ---    ---  </span>
<span class="go"> bool  bool   bool </span>
<span class="go"></span>
<span class="go"> true  false  null </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upcast</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1426-L1459"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Append expressions.</p>
<p>This is done by adding the chunks of <code class="code docutils literal notranslate"><span class="pre">other</span></code> to this <code class="code docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>Expression to append.</p>
</dd>
<dt><strong>upcast</strong></dt><dd><p>Cast both <code class="code docutils literal notranslate"><span class="pre">Series</span></code> to the same supertype.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> a    b    </span>
<span class="go"> ---  ---  </span>
<span class="go"> i64  i64  </span>
<span class="go"></span>
<span class="go"> 8    null </span>
<span class="go"> 10   4    </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">return_dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PolarsDataType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">skip_nulls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">pass_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MapElementsStrategy</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'thread_local'</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11760-L11807"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a custom/user-defined function (UDF) in a GroupBy or Projection context.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.0: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.map_elements.html#polars.Expr.map_elements" title="polars.Expr.map_elements"><code class="xref py py-func docutils literal notranslate"><span class="pre">Expr.map_elements()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>function</strong></dt><dd><p>Lambda/ function to apply.</p>
</dd>
<dt><strong>return_dtype</strong></dt><dd><p>Dtype of the output Series.
If not set, the dtype will be
<code class="code docutils literal notranslate"><span class="pre">polars.Unknown</span></code>.</p>
</dd>
<dt><strong>skip_nulls</strong></dt><dd><p>Dont apply the function over values
that contain nulls. This is faster.</p>
</dd>
<dt><strong>pass_name</strong></dt><dd><p>Pass the Series name to the custom function
This is more expensive.</p>
</dd>
<dt><strong>strategy</strong><span class="classifier">{thread_local, threading}</span></dt><dd><p>This functionality is in <code class="code docutils literal notranslate"><span class="pre">alpha</span></code> stage. This may be removed
/changed without it being considered a breaking change.</p>
<ul class="simple">
<li><p>thread_local: run the python function on a single thread.</p></li>
<li><p>threading: run the python function on separate threads. Use with
care as this can slow performance. This might only speed up
your code if the amount of work per element is significant
and the python function releases the GIL (e.g. via calling
a c function)</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">approx_n_unique</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3601-L3633"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Approximate count of unique values.</p>
<p>This is done using the HyperLogLog++ algorithm for cardinality estimation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">approx_n_unique</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> n   </span>
<span class="go"> --- </span>
<span class="go"> u32 </span>
<span class="go"></span>
<span class="go"> 2   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">exact</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">n_unique</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">approx</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">approx_n_unique</span><span class="p">(),</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (1, 2)</span>
<span class="go"></span>
<span class="go"> exact  approx </span>
<span class="go"> ---    ---    </span>
<span class="go"> u32    u32    </span>
<span class="go"></span>
<span class="go"> 1000   1005   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">arccos</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10346-L10368"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the inverse cosine.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arccos</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 1.570796 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">arccosh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10490-L10512"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the inverse hyperbolic cosine.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arccosh</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 0.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">arcsin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10322-L10344"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the inverse sine.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arcsin</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 1.570796 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">arcsinh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10466-L10488"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the inverse hyperbolic sine.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 0.881374 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">arctan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10370-L10392"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the inverse tangent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arctan</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 0.785398 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">arctanh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10514-L10536"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the inverse hyperbolic tangent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arctanh</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> inf </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">arg_max</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L2684-L2705"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get the index of the maximal value.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arg_max</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> u32 </span>
<span class="go"></span>
<span class="go"> 2   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">arg_min</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L2707-L2728"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get the index of the minimal value.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arg_min</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> u32 </span>
<span class="go"></span>
<span class="go"> 1   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">arg_sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descending</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nulls_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L2627-L2682"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get the index values that would sort this column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>descending</strong></dt><dd><p>Sort in descending (descending) order.</p>
</dd>
<dt><strong>nulls_last</strong></dt><dd><p>Place null values last instead of first.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">UInt32</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.gather.html#polars.Expr.gather" title="polars.Expr.gather"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Expr.gather</span></code></a></dt><dd><p>Take values by index.</p>
</dd>
<dt><a class="reference internal" href="api/polars.Expr.rank.html#polars.Expr.rank" title="polars.Expr.rank"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Expr.rank</span></code></a></dt><dd><p>Get the rank of each row.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arg_sort</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> u32 </span>
<span class="go"></span>
<span class="go"> 1   </span>
<span class="go"> 0   </span>
<span class="go"> 2   </span>
<span class="go"></span>
</pre></div>
</div>
<p>Use gather to apply the arg sort to other columns.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arg_sort</span><span class="p">()))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> b   </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 2   </span>
<span class="go"> 1   </span>
<span class="go"> 3   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">arg_true</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L539-L567"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return indices where expression evaluates <code class="code docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Modifies number of rows returned, so will fail in combination with other
expressions. Use as only expression in <code class="code docutils literal notranslate"><span class="pre">select</span></code> / <code class="code docutils literal notranslate"><span class="pre">with_columns</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../series/api/polars.Series.arg_true.html#polars.Series.arg_true" title="polars.Series.arg_true"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Series.arg_true</span></code></a></dt><dd><p>Return indices where Series is True</p>
</dd>
<dt><a class="reference internal" href="api/polars.arg_where.html#polars.arg_where" title="polars.arg_where"><code class="xref py py-obj docutils literal notranslate"><span class="pre">polars.arg_where</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">arg_true</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> u32 </span>
<span class="go"></span>
<span class="go"> 0   </span>
<span class="go"> 1   </span>
<span class="go"> 3   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">arg_unique</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3685-L3719"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get index of first unique value.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arg_unique</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> u32 </span>
<span class="go"></span>
<span class="go"> 0   </span>
<span class="go"> 1   </span>
<span class="go"> 2   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">arg_unique</span><span class="p">())</span>
<span class="go">shape: (2, 1)</span>
<span class="go"></span>
<span class="go"> b   </span>
<span class="go"> --- </span>
<span class="go"> u32 </span>
<span class="go"></span>
<span class="go"> 0   </span>
<span class="go"> 1   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">backward_fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3277-L3323"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Fill missing values with the next to be seen values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>limit</strong></dt><dd><p>The number of consecutive null values to backward fill.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.forward_fill.html#polars.Expr.forward_fill" title="polars.Expr.forward_fill"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward_fill</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.shift.html#polars.Expr.shift" title="polars.Expr.shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">backward_fill</span><span class="p">())</span>
<span class="go">shape: (3, 3)</span>
<span class="go"></span>
<span class="go"> a     b    c   </span>
<span class="go"> ---   ---  --- </span>
<span class="go"> i64   i64  i64 </span>
<span class="go"></span>
<span class="go"> 1     4    2   </span>
<span class="go"> 2     6    2   </span>
<span class="go"> null  6    2   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">backward_fill</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">shape: (3, 3)</span>
<span class="go"></span>
<span class="go"> a     b    c    </span>
<span class="go"> ---   ---  ---  </span>
<span class="go"> i64   i64  i64  </span>
<span class="go"></span>
<span class="go"> 1     4    null </span>
<span class="go"> 2     6    2    </span>
<span class="go"> null  6    2    </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">bottom_k</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">nulls_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">maintain_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">multithreaded</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L2336-L2447"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return the <code class="code docutils literal notranslate"><span class="pre">k</span></code> smallest elements.</p>
<p>This has time complexity:</p>
<div class="math notranslate nohighlight">
\[O(n + k \log{n})\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>k</strong></dt><dd><p>Number of elements to return.</p>
</dd>
<dt><strong>nulls_last</strong></dt><dd><p>Place null values last.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.31: </span>This parameter will be removed in the next breaking release.
Null values will be considered lowest priority and will only be
included if <code class="code docutils literal notranslate"><span class="pre">k</span></code> is larger than the number of non-null elements.</p>
</div>
</dd>
<dt><strong>maintain_order</strong></dt><dd><p>Whether the order should be maintained if elements are equal.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.31: </span>This parameter will be removed in the next breaking release.
There will be no guarantees about the order of the output.</p>
</div>
</dd>
<dt><strong>multithreaded</strong></dt><dd><p>Sort using multiple threads.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.31: </span>This parameter will be removed in the next breaking release.
Polars itself will determine whether to use multithreading or not.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.top_k.html#polars.Expr.top_k" title="polars.Expr.top_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">top_k</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.top_k_by.html#polars.Expr.top_k_by" title="polars.Expr.top_k_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">top_k_by</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.bottom_k_by.html#polars.Expr.bottom_k_by" title="polars.Expr.bottom_k_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bottom_k_by</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">top_k</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;top_k&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bottom_k</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;bottom_k&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> top_k  bottom_k </span>
<span class="go"> ---    ---      </span>
<span class="go"> i64    i64      </span>
<span class="go"></span>
<span class="go"> 99     1        </span>
<span class="go"> 98     2        </span>
<span class="go"> 4      3        </span>
<span class="go"> 3      4        </span>
<span class="go"> 2      98       </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">bottom_k_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">IntoExpr</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">descending</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">nulls_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">maintain_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">multithreaded</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L2449-L2625"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return the elements corresponding to the <code class="code docutils literal notranslate"><span class="pre">k</span></code> smallest elements of the <code class="code docutils literal notranslate"><span class="pre">by</span></code> column(s).</p>
<p>This has time complexity:</p>
<div class="math notranslate nohighlight">
\[O(n + k \log{n})\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>by</strong></dt><dd><p>Column(s) used to determine the smallest elements.
Accepts expression input. Strings are parsed as column names.</p>
</dd>
<dt><strong>k</strong></dt><dd><p>Number of elements to return.</p>
</dd>
<dt><strong>descending</strong></dt><dd><p>Consider the <code class="code docutils literal notranslate"><span class="pre">k</span></code> largest elements of the <code class="code docutils literal notranslate"><span class="pre">by</span></code> column(s) (instead of the <code class="code docutils literal notranslate"><span class="pre">k</span></code>
smallest). This can be specified per column by passing a sequence of
booleans.</p>
</dd>
<dt><strong>nulls_last</strong></dt><dd><p>Place null values last.</p>
</dd>
<dt><strong>maintain_order</strong></dt><dd><p>Whether the order should be maintained if elements are equal.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.31: </span>This parameter will be removed in the next breaking release.
There will be no guarantees about the order of the output.</p>
</div>
</dd>
<dt><strong>multithreaded</strong></dt><dd><p>Sort using multiple threads.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.31: </span>This parameter will be removed in the next breaking release.
Polars itself will determine whether to use multithreading or not.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.top_k.html#polars.Expr.top_k" title="polars.Expr.top_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">top_k</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.top_k_by.html#polars.Expr.top_k_by" title="polars.Expr.top_k_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">top_k_by</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.bottom_k.html#polars.Expr.bottom_k" title="polars.Expr.bottom_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bottom_k</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Apple&quot;</span><span class="p">,</span> <span class="s2">&quot;Orange&quot;</span><span class="p">,</span> <span class="s2">&quot;Apple&quot;</span><span class="p">,</span> <span class="s2">&quot;Apple&quot;</span><span class="p">,</span> <span class="s2">&quot;Banana&quot;</span><span class="p">,</span> <span class="s2">&quot;Banana&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (6, 3)</span>
<span class="go"></span>
<span class="go"> a    b    c      </span>
<span class="go"> ---  ---  ---    </span>
<span class="go"> i64  i64  str    </span>
<span class="go"></span>
<span class="go"> 1    6    Apple  </span>
<span class="go"> 2    5    Orange </span>
<span class="go"> 3    4    Apple  </span>
<span class="go"> 4    3    Apple  </span>
<span class="go"> 5    2    Banana </span>
<span class="go"> 6    1    Banana </span>
<span class="go"></span>
</pre></div>
</div>
<p>Get the bottom 2 rows by column <code class="code docutils literal notranslate"><span class="pre">a</span></code> or <code class="code docutils literal notranslate"><span class="pre">b</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">bottom_k_by</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_btm_by_a&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">bottom_k_by</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_btm_by_b&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (2, 6)</span>
<span class="go"></span>
<span class="go"> a_btm_by_a  b_btm_by_a  c_btm_by_a  a_btm_by_b  b_btm_by_b  c_btm_by_b </span>
<span class="go"> ---         ---         ---         ---         ---         ---        </span>
<span class="go"> i64         i64         str         i64         i64         str        </span>
<span class="go"></span>
<span class="go"> 1           6           Apple       6           1           Banana     </span>
<span class="go"> 2           5           Orange      5           2           Banana     </span>
<span class="go"></span>
</pre></div>
</div>
<p>Get the bottom 2 rows by multiple columns with given order.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">bottom_k_by</span><span class="p">([</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_by_ca&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">bottom_k_by</span><span class="p">([</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_by_cb&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (2, 6)</span>
<span class="go"></span>
<span class="go"> a_by_ca  b_by_ca  c_by_ca  a_by_cb  b_by_cb  c_by_cb </span>
<span class="go"> ---      ---      ---      ---      ---      ---     </span>
<span class="go"> i64      i64      str      i64      i64      str     </span>
<span class="go"></span>
<span class="go"> 4        3        Apple    1        6        Apple   </span>
<span class="go"> 3        4        Apple    3        4        Apple   </span>
<span class="go"></span>
</pre></div>
</div>
<p>Get the bottom 2 rows by column <code class="code docutils literal notranslate"><span class="pre">a</span></code> in each group.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">maintain_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">bottom_k_by</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">))</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> c       a    b   </span>
<span class="go"> ---     ---  --- </span>
<span class="go"> str     i64  i64 </span>
<span class="go"></span>
<span class="go"> Apple   1    6   </span>
<span class="go"> Apple   3    4   </span>
<span class="go"> Orange  2    5   </span>
<span class="go"> Banana  5    2   </span>
<span class="go"> Banana  6    1   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PolarsDataType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1919-L1957"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Cast between data types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dtype</strong></dt><dd><p>DataType to cast to.</p>
</dd>
<dt><strong>strict</strong></dt><dd><p>Throw an error if a cast could not be done (for instance, due to an
overflow).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int32</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a    b   </span>
<span class="go"> ---  --- </span>
<span class="go"> f64  i32 </span>
<span class="go"></span>
<span class="go"> 1.0  4   </span>
<span class="go"> 2.0  5   </span>
<span class="go"> 3.0  6   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cbrt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L590-L609"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the cube root of the elements.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cbrt</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> values   </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 1.0      </span>
<span class="go"> 1.259921 </span>
<span class="go"> 1.587401 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ceil</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1785-L1807"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Rounds up to the nearest integer value.</p>
<p>Only works on floating point Series.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ceil</span><span class="p">())</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 1.0 </span>
<span class="go"> 1.0 </span>
<span class="go"> 1.0 </span>
<span class="go"> 2.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">clip</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">lower_bound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NumericLiteral</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TemporalLiteral</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">upper_bound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NumericLiteral</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TemporalLiteral</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10086-L10149"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Set values outside the given boundaries to the boundary value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lower_bound</strong></dt><dd><p>Lower bound. Accepts expression input.
Non-expression inputs are parsed as literals.</p>
</dd>
<dt><strong>upper_bound</strong></dt><dd><p>Upper bound. Accepts expression input.
Non-expression inputs are parsed as literals.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.when.html#polars.when" title="polars.when"><code class="xref py py-obj docutils literal notranslate"><span class="pre">when</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This method only works for numeric and temporal columns. To clip other data
types, consider writing a <code class="code docutils literal notranslate"><span class="pre">when-then-otherwise</span></code> expression. See <a class="reference internal" href="api/polars.when.html#polars.when" title="polars.when"><code class="xref py py-func docutils literal notranslate"><span class="pre">when()</span></code></a>.</p>
<p class="rubric">Examples</p>
<p>Specifying both a lower and upper bound:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="kc">None</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="go">shape: (4, 2)</span>
<span class="go"></span>
<span class="go"> a     clip </span>
<span class="go"> ---   ---  </span>
<span class="go"> i64   i64  </span>
<span class="go"></span>
<span class="go"> -50   1    </span>
<span class="go"> 5     5    </span>
<span class="go"> 50    10   </span>
<span class="go"> null  null </span>
<span class="go"></span>
</pre></div>
</div>
<p>Specifying only a single bound:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">upper_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="go">shape: (4, 2)</span>
<span class="go"></span>
<span class="go"> a     clip </span>
<span class="go"> ---   ---  </span>
<span class="go"> i64   i64  </span>
<span class="go"></span>
<span class="go"> -50   -50  </span>
<span class="go"> 5     5    </span>
<span class="go"> 50    10   </span>
<span class="go"> null  null </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">clip_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">upper_bound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NumericLiteral</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TemporalLiteral</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11894-L11909"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Clip (limit) the values in an array to a <code class="code docutils literal notranslate"><span class="pre">max</span></code> boundary.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.12: </span>Use <a class="reference internal" href="api/polars.Expr.clip.html#polars.Expr.clip" title="polars.Expr.clip"><code class="xref py py-func docutils literal notranslate"><span class="pre">clip()</span></code></a> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>upper_bound</strong></dt><dd><p>Upper bound.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">clip_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lower_bound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NumericLiteral</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TemporalLiteral</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11877-L11892"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Clip (limit) the values in an array to a <code class="code docutils literal notranslate"><span class="pre">min</span></code> boundary.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.12: </span>Use <a class="reference internal" href="api/polars.Expr.clip.html#polars.Expr.clip" title="polars.Expr.clip"><code class="xref py py-func docutils literal notranslate"><span class="pre">clip()</span></code></a> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lower_bound</strong></dt><dd><p>Lower bound.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cos</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10250-L10272"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the cosine.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cos</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 1.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cosh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10418-L10440"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the hyperbolic cosine.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cosh</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 1.543081 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10298-L10320"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the cotangent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cot</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a    </span>
<span class="go"> ---  </span>
<span class="go"> f64  </span>
<span class="go"></span>
<span class="go"> 0.64 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1331-L1357"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return the number of non-null elements in the column.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">UInt32</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.len.html#polars.len" title="polars.len"><code class="xref py py-obj docutils literal notranslate"><span class="pre">len</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="go">shape: (1, 2)</span>
<span class="go"></span>
<span class="go"> a    b   </span>
<span class="go"> ---  --- </span>
<span class="go"> u32  u32 </span>
<span class="go"></span>
<span class="go"> 3    2   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cum_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1731-L1759"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return the cumulative count of the non-null values in the column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reverse</strong></dt><dd><p>Reverse the operation.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_count</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_count&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_count</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_count_reverse&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> a     cum_count  cum_count_reverse </span>
<span class="go"> ---   ---        ---               </span>
<span class="go"> str   u32        u32               </span>
<span class="go"></span>
<span class="go"> x     1          3                 </span>
<span class="go"> k     2          2                 </span>
<span class="go"> null  2          1                 </span>
<span class="go"> d     3          1                 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cum_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1678-L1729"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get an array with the cumulative max computed at every element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reverse</strong></dt><dd><p>Reverse the operation.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_max</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_max&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_max</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_max_reverse&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (3, 3)</span>
<span class="go"></span>
<span class="go"> a    cum_max  cum_max_reverse </span>
<span class="go"> ---  ---      ---             </span>
<span class="go"> i64  i64      i64             </span>
<span class="go"></span>
<span class="go"> 1    1        3               </span>
<span class="go"> 3    3        3               </span>
<span class="go"> 2    3        2               </span>
<span class="go"></span>
</pre></div>
</div>
<p>Null values are excluded, but can also be filled by calling <code class="code docutils literal notranslate"><span class="pre">forward_fill</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="kc">None</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_max</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_max&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_max</span><span class="p">()</span><span class="o">.</span><span class="n">forward_fill</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_max_all_filled&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (8, 3)</span>
<span class="go"></span>
<span class="go"> values  cum_max  cum_max_all_filled </span>
<span class="go"> ---     ---      ---                </span>
<span class="go"> i64     i64      i64                </span>
<span class="go"></span>
<span class="go"> null    null     null               </span>
<span class="go"> 10      10       10                 </span>
<span class="go"> null    null     10                 </span>
<span class="go"> 8       10       10                 </span>
<span class="go"> 9       10       10                 </span>
<span class="go"> null    null     10                 </span>
<span class="go"> 16      16       16                 </span>
<span class="go"> null    null     16                 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cum_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1648-L1676"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get an array with the cumulative min computed at every element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reverse</strong></dt><dd><p>Reverse the operation.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_min</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_min&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_min</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_min_reverse&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (3, 3)</span>
<span class="go"></span>
<span class="go"> a    cum_min  cum_min_reverse </span>
<span class="go"> ---  ---      ---             </span>
<span class="go"> i64  i64      i64             </span>
<span class="go"></span>
<span class="go"> 3    3        1               </span>
<span class="go"> 1    1        1               </span>
<span class="go"> 2    1        2               </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cum_prod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1613-L1646"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get an array with the cumulative product computed at every element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reverse</strong></dt><dd><p>Reverse the operation.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Dtypes in {Int8, UInt8, Int16, UInt16} are cast to
Int64 before summing to prevent overflow issues.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_prod</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_prod&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_prod</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_prod_reverse&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> a    cum_prod  cum_prod_reverse </span>
<span class="go"> ---  ---       ---              </span>
<span class="go"> i64  i64       i64              </span>
<span class="go"></span>
<span class="go"> 1    1         24               </span>
<span class="go"> 2    2         24               </span>
<span class="go"> 3    6         12               </span>
<span class="go"> 4    24        4                </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cum_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1552-L1611"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get an array with the cumulative sum computed at every element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reverse</strong></dt><dd><p>Reverse the operation.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Dtypes in {Int8, UInt8, Int16, UInt16} are cast to
Int64 before summing to prevent overflow issues.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_sum&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_sum</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cum_sum_reverse&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> a    cum_sum  cum_sum_reverse </span>
<span class="go"> ---  ---      ---             </span>
<span class="go"> i64  i64      i64             </span>
<span class="go"></span>
<span class="go"> 1    1        10              </span>
<span class="go"> 2    3        9               </span>
<span class="go"> 3    6        7               </span>
<span class="go"> 4    10       4               </span>
<span class="go"></span>
</pre></div>
</div>
<p>Null values are excluded, but can also be filled by calling <code class="code docutils literal notranslate"><span class="pre">forward_fill</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="kc">None</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;value_cum_sum&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">cum_sum</span><span class="p">()</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">forward_fill</span><span class="p">()</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;value_cum_sum_all_filled&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (8, 3)</span>
<span class="go"></span>
<span class="go"> values  value_cum_sum  value_cum_sum_all_filled </span>
<span class="go"> ---     ---            ---                      </span>
<span class="go"> i64     i64            i64                      </span>
<span class="go"></span>
<span class="go"> null    null           null                     </span>
<span class="go"> 10      10             10                       </span>
<span class="go"> null    null           10                       </span>
<span class="go"> 8       18             18                       </span>
<span class="go"> 9       27             27                       </span>
<span class="go"> null    null           27                       </span>
<span class="go"> 16      43             43                       </span>
<span class="go"> null    null           43                       </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cumcount</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L12136-L12149"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get an array with the cumulative count computed at every element.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.14: </span>This method has been renamed to <a class="reference internal" href="api/polars.cum_count.html#polars.cum_count" title="polars.cum_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cum_count()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reverse</strong></dt><dd><p>Reverse the operation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cummax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L12121-L12134"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get an array with the cumulative max computed at every element.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.14: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.cum_max.html#polars.Expr.cum_max" title="polars.Expr.cum_max"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cum_max()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reverse</strong></dt><dd><p>Reverse the operation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cummin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L12106-L12119"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get an array with the cumulative min computed at every element.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.14: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.cum_min.html#polars.Expr.cum_min" title="polars.Expr.cum_min"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cum_min()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reverse</strong></dt><dd><p>Reverse the operation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cumprod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L12091-L12104"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get an array with the cumulative product computed at every element.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.14: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.cum_prod.html#polars.Expr.cum_prod" title="polars.Expr.cum_prod"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cum_prod()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reverse</strong></dt><dd><p>Reverse the operation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L12076-L12089"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get an array with the cumulative sum computed at every element.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.14: </span>This method has been renamed to <a class="reference internal" href="api/polars.cum_sum.html#polars.cum_sum" title="polars.cum_sum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cum_sum()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reverse</strong></dt><dd><p>Reverse the operation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cumulative_eval</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11365-L11417"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Run an expression over a sliding window that increases <code class="code docutils literal notranslate"><span class="pre">1</span></code> slot every iteration.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>expr</strong></dt><dd><p>Expression to evaluate</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>Number of valid values there should be in the window before the expression
is evaluated. valid values = <code class="code docutils literal notranslate"><span class="pre">length</span> <span class="pre">-</span> <span class="pre">null_count</span></code></p>
</dd>
<dt><strong>parallel</strong></dt><dd><p>Run in parallel. Dont do this in a group by or another operation that
already has much parallelization.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This can be really slow as it can have <code class="code docutils literal notranslate"><span class="pre">O(n^2)</span></code> complexity. Dont use this
for operations that visit all elements.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cumulative_eval</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">pl</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">first</span><span class="p">()</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">last</span><span class="p">()</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">... </span>        <span class="p">)</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 1)</span>
<span class="go"></span>
<span class="go"> values </span>
<span class="go"> ---    </span>
<span class="go"> i64    </span>
<span class="go"></span>
<span class="go"> 0      </span>
<span class="go"> -3     </span>
<span class="go"> -8     </span>
<span class="go"> -15    </span>
<span class="go"> -24    </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cut</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">left_closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">include_breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4268-L4349"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bin continuous values into discrete categories.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>breaks</strong></dt><dd><p>List of unique cut points.</p>
</dd>
<dt><strong>labels</strong></dt><dd><p>Names of the categories. The number of labels must be equal to the number
of cut points plus one.</p>
</dd>
<dt><strong>left_closed</strong></dt><dd><p>Set the intervals to be left-closed instead of right-closed.</p>
</dd>
<dt><strong>include_breaks</strong></dt><dd><p>Include a column with the right endpoint of the bin each observation falls
in. This will change the data type of the output from a
<code class="xref py py-class docutils literal notranslate"><span class="pre">Categorical</span></code> to a <code class="xref py py-class docutils literal notranslate"><span class="pre">Struct</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Categorical</span></code> if <code class="code docutils literal notranslate"><span class="pre">include_breaks</span></code> is set to
<code class="code docutils literal notranslate"><span class="pre">False</span></code> (default), otherwise an expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Struct</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.qcut.html#polars.Expr.qcut" title="polars.Expr.qcut"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qcut</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Divide a column into three categories.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cut</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cut&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> foo  cut </span>
<span class="go"> ---  --- </span>
<span class="go"> i64  cat </span>
<span class="go"></span>
<span class="go"> -2   a   </span>
<span class="go"> -1   a   </span>
<span class="go"> 0    b   </span>
<span class="go"> 1    b   </span>
<span class="go"> 2    c   </span>
<span class="go"></span>
</pre></div>
</div>
<p>Add both the category and the breakpoint.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cut</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">include_breaks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cut&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">unnest</span><span class="p">(</span><span class="s2">&quot;cut&quot;</span><span class="p">)</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> foo  brk   foo_bin    </span>
<span class="go"> ---  ---   ---        </span>
<span class="go"> i64  f64   cat        </span>
<span class="go"></span>
<span class="go"> -2   -1.0  (-inf, -1] </span>
<span class="go"> -1   -1.0  (-inf, -1] </span>
<span class="go"> 0    1.0   (-1, 1]    </span>
<span class="go"> 1    1.0   (-1, 1]    </span>
<span class="go"> 2    inf   (1, inf]   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">degrees</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10538-L10569"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convert from radians to degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">degrees</span><span class="p">())</span>
<span class="go">shape: (9, 1)</span>
<span class="go"></span>
<span class="go"> a      </span>
<span class="go"> ---    </span>
<span class="go"> f64    </span>
<span class="go"></span>
<span class="go"> -720.0 </span>
<span class="go"> -540.0 </span>
<span class="go"> -360.0 </span>
<span class="go"> -180.0 </span>
<span class="go"> 0.0    </span>
<span class="go"> 180.0  </span>
<span class="go"> 360.0  </span>
<span class="go"> 540.0  </span>
<span class="go"> 720.0  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">deserialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IOBase</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L341-L378"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Read a serialized expression from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>source</strong></dt><dd><p>Path to a file or a file-like object (by file-like object, we refer to
objects that have a <code class="code docutils literal notranslate"><span class="pre">read()</span></code> method, such as a file handler (e.g.
via builtin <code class="code docutils literal notranslate"><span class="pre">open</span></code> function) or <code class="code docutils literal notranslate"><span class="pre">BytesIO</span></code>).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function uses <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a> when the logical plan contains Python UDFs,
and as such inherits the security implications. Deserializing can execute
arbitrary code, so it should only be attempted on trusted data.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.meta.serialize.html#polars.Expr.meta.serialize" title="polars.Expr.meta.serialize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Expr.meta.serialize</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">json</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">json</span><span class="p">))</span>  
<span class="go">&lt;Expr [&#39;col(&quot;foo&quot;).sum().over([col(&quot;ba&#39;] at ...&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">null_behavior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NullBehavior</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ignore'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L9904-L9958"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate the first discrete difference between shifted items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong></dt><dd><p>Number of slots to shift.</p>
</dd>
<dt><strong>null_behavior</strong><span class="classifier">{ignore, drop}</span></dt><dd><p>How to handle null values.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;int&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">change</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">())</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> int  change </span>
<span class="go"> ---  ---    </span>
<span class="go"> i64  i64    </span>
<span class="go"></span>
<span class="go"> 20   null   </span>
<span class="go"> 10   -10    </span>
<span class="go"> 30   20     </span>
<span class="go"> 25   -5     </span>
<span class="go"> 35   10     </span>
<span class="go"></span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">change</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> int  change </span>
<span class="go"> ---  ---    </span>
<span class="go"> i64  i64    </span>
<span class="go"></span>
<span class="go"> 20   null   </span>
<span class="go"> 10   null   </span>
<span class="go"> 30   10     </span>
<span class="go"> 25   15     </span>
<span class="go"> 35   5      </span>
<span class="go"></span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">null_behavior</span><span class="o">=</span><span class="s2">&quot;drop&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;diff&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> diff </span>
<span class="go"> ---  </span>
<span class="go"> i64  </span>
<span class="go"></span>
<span class="go"> 10   </span>
<span class="go"> 15   </span>
<span class="go"> 5    </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1862-L1890"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the dot/inner product between two Expressions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>Expression to compute dot product with.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)))</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 44  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">drop_nans</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1520-L1550"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Drop all floating point NaN values.</p>
<p>The original order of the remaining elements is preserved.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.drop_nulls.html#polars.Expr.drop_nulls" title="polars.Expr.drop_nulls"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_nulls</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>A NaN value is not the same as a null value.
To drop null values, use <a class="reference internal" href="api/polars.Expr.drop_nulls.html#polars.Expr.drop_nulls" title="polars.Expr.drop_nulls"><code class="xref py py-func docutils literal notranslate"><span class="pre">drop_nulls()</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_nans</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a    </span>
<span class="go"> ---  </span>
<span class="go"> f64  </span>
<span class="go"></span>
<span class="go"> 1.0  </span>
<span class="go"> null </span>
<span class="go"> 3.0  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">drop_nulls</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1488-L1518"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Drop all null values.</p>
<p>The original order of the remaining elements is preserved.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.drop_nans.html#polars.Expr.drop_nans" title="polars.Expr.drop_nans"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_nans</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>A null value is not the same as a NaN value.
To drop NaN values, use <a class="reference internal" href="api/polars.Expr.drop_nans.html#polars.Expr.drop_nans" title="polars.Expr.drop_nans"><code class="xref py py-func docutils literal notranslate"><span class="pre">drop_nans()</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_nulls</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 1.0 </span>
<span class="go"> 3.0 </span>
<span class="go"> NaN </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.718281828459045</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11328-L11363"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes the entropy.</p>
<p>Uses the formula <code class="code docutils literal notranslate"><span class="pre">-sum(pk</span> <span class="pre">*</span> <span class="pre">log(pk)</span></code> where <code class="code docutils literal notranslate"><span class="pre">pk</span></code> are discrete probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>base</strong></dt><dd><p>Given base, defaults to <code class="code docutils literal notranslate"><span class="pre">e</span></code></p>
</dd>
<dt><strong>normalize</strong></dt><dd><p>Normalize pk if it doesnt sum to 1.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 1.459148 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a         </span>
<span class="go"> ---       </span>
<span class="go"> f64       </span>
<span class="go"></span>
<span class="go"> -6.754888 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5416-L5448"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of equality operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">==</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>A literal or expression value to compare with.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x == y&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> x    y    x == y </span>
<span class="go"> ---  ---  ---    </span>
<span class="go"> f64  f64  bool   </span>
<span class="go"></span>
<span class="go"> 1.0  2.0  false  </span>
<span class="go"> 2.0  2.0  true   </span>
<span class="go"> NaN  NaN  true   </span>
<span class="go"> 4.0  4.0  true   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">eq_missing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5450-L5488"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of equality operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">==</span> <span class="pre">other</span></code> where <code class="code docutils literal notranslate"><span class="pre">None</span> <span class="pre">==</span> <span class="pre">None</span></code>.</p>
<p>This differs from default <code class="code docutils literal notranslate"><span class="pre">eq</span></code> where null values are propagated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>A literal or expression value to compare with.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">4.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x eq y&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq_missing</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x eq_missing y&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 4)</span>
<span class="go"></span>
<span class="go"> x     y     x eq y  x eq_missing y </span>
<span class="go"> ---   ---   ---     ---            </span>
<span class="go"> f64   f64   bool    bool           </span>
<span class="go"></span>
<span class="go"> 1.0   2.0   false   false          </span>
<span class="go"> 2.0   2.0   true    true           </span>
<span class="go"> NaN   NaN   true    true           </span>
<span class="go"> 4.0   4.0   true    true           </span>
<span class="go"> null  5.0   null    false          </span>
<span class="go"> null  null  null    true           </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ewm_mean</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">com</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">half_life</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">adjust</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ignore_nulls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10735-L10831"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Exponentially-weighted moving average.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>com</strong></dt><dd><p>Specify decay in terms of center of mass, <span class="math notranslate nohighlight">\(\gamma\)</span>, with</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\alpha = \frac{1}{1 + \gamma} \; \forall \; \gamma \geq 0\]</div>
</div></blockquote>
</dd>
<dt><strong>span</strong></dt><dd><p>Specify decay in terms of span, <span class="math notranslate nohighlight">\(\theta\)</span>, with</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\alpha = \frac{2}{\theta + 1} \; \forall \; \theta \geq 1\]</div>
</div></blockquote>
</dd>
<dt><strong>half_life</strong></dt><dd><p>Specify decay in terms of half-life, <span class="math notranslate nohighlight">\(\lambda\)</span>, with</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\alpha = 1 - \exp \left\{ \frac{ -\ln(2) }{ \lambda } \right\} \;
\forall \; \lambda &gt; 0\]</div>
</div></blockquote>
</dd>
<dt><strong>alpha</strong></dt><dd><p>Specify smoothing factor alpha directly, <span class="math notranslate nohighlight">\(0 &lt; \alpha \leq 1\)</span>.</p>
</dd>
<dt><strong>adjust</strong></dt><dd><p>Divide by decaying adjustment factor in beginning periods to account for
imbalance in relative weightings</p>
<blockquote>
<div><ul>
<li><p>When <code class="code docutils literal notranslate"><span class="pre">adjust=True</span></code> (the default) the EW function is calculated
using weights <span class="math notranslate nohighlight">\(w_i = (1 - \alpha)^i\)</span></p></li>
<li><p>When <code class="code docutils literal notranslate"><span class="pre">adjust=False</span></code> the EW function is calculated
recursively by</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_0 &amp;= x_0 \\
y_t &amp;= (1 - \alpha)y_{t - 1} + \alpha x_t\end{split}\]</div>
</li>
</ul>
</div></blockquote>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>Minimum number of observations in window required to have a value
(otherwise result is null).</p>
</dd>
<dt><strong>ignore_nulls</strong></dt><dd><p>Ignore missing values when calculating weights.</p>
<blockquote>
<div><ul class="simple">
<li><p>When <code class="code docutils literal notranslate"><span class="pre">ignore_nulls=False</span></code>, weights are based on absolute
positions.
For example, the weights of <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> used in
calculating the final weighted average of
[<span class="math notranslate nohighlight">\(x_0\)</span>, None, <span class="math notranslate nohighlight">\(x_2\)</span>] are
<span class="math notranslate nohighlight">\((1-\alpha)^2\)</span> and <span class="math notranslate nohighlight">\(1\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=True</span></code>, and
<span class="math notranslate nohighlight">\((1-\alpha)^2\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=False</span></code>.</p></li>
<li><p>When <code class="code docutils literal notranslate"><span class="pre">ignore_nulls=True</span></code> (current default), weights are based
on relative positions. For example, the weights of
<span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> used in calculating the final weighted
average of [<span class="math notranslate nohighlight">\(x_0\)</span>, None, <span class="math notranslate nohighlight">\(x_2\)</span>] are
<span class="math notranslate nohighlight">\(1-\alpha\)</span> and <span class="math notranslate nohighlight">\(1\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=True</span></code>,
and <span class="math notranslate nohighlight">\(1-\alpha\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=False</span></code>.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ewm_mean</span><span class="p">(</span><span class="n">com</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 1.0      </span>
<span class="go"> 1.666667 </span>
<span class="go"> 2.428571 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ewm_mean_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">half_life</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">timedelta</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">check_sorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10833-L10935"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate time-based exponentially weighted moving average.</p>
<p>Given observations <span class="math notranslate nohighlight">\(x_1, x_2, \ldots, x_n\)</span> at times
<span class="math notranslate nohighlight">\(t_1, t_2, \ldots, t_n\)</span>, the EWMA is calculated as</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}y_0 &amp;= x_0\\\alpha_i &amp;= \exp(-\lambda(t_i - t_{i-1}))\\y_i &amp;= \alpha_i x_i + (1 - \alpha_i) y_{i-1}; \quad i &gt; 0\end{aligned}\end{align} \]</div>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> equals <span class="math notranslate nohighlight">\(\ln(2) / \text{half_life}\)</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>by</strong></dt><dd><p>Times to calculate average by. Should be <code class="docutils literal notranslate"><span class="pre">DateTime</span></code>, <code class="docutils literal notranslate"><span class="pre">Date</span></code>, <code class="docutils literal notranslate"><span class="pre">UInt64</span></code>,
<code class="docutils literal notranslate"><span class="pre">UInt32</span></code>, <code class="docutils literal notranslate"><span class="pre">Int64</span></code>, or <code class="docutils literal notranslate"><span class="pre">Int32</span></code> data type.</p>
</dd>
<dt><strong>half_life</strong></dt><dd><p>Unit over which observation decays to half its value.</p>
<p>Can be created either from a timedelta, or
by using the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 day)</p></li>
<li><p>1w    (1 week)</p></li>
<li><p>1i    (1 index count)</p></li>
</ul>
<p>Or combine them:
3d12h4m25s # 3 days, 12 hours, 4 minutes, and 25 seconds</p>
<p>Note that <code class="code docutils literal notranslate"><span class="pre">half_life</span></code> is treated as a constant duration - calendar
durations such as months (or even days in the time-zone-aware case)
are not supported, please express your duration in an approximately
equivalent number of hours (e.g. 370h instead of 1mo).</p>
</dd>
<dt><strong>check_sorted</strong></dt><dd><p>Check whether <code class="code docutils literal notranslate"><span class="pre">by</span></code> column is sorted.
Incorrectly setting this to <code class="code docutils literal notranslate"><span class="pre">False</span></code> will lead to incorrect output.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.27: </span>Sortedness is now verified in a quick manner, you can safely remove
this argument.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Float32 if input is Float32, otherwise Float64.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;times&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">... </span>            <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>            <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>            <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<span class="gp">... </span>            <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
<span class="gp">... </span>            <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;times&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">result</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ewm_mean_by</span><span class="p">(</span><span class="s2">&quot;times&quot;</span><span class="p">,</span> <span class="n">half_life</span><span class="o">=</span><span class="s2">&quot;4d&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> values  times       result   </span>
<span class="go"> ---     ---         ---      </span>
<span class="go"> i64     date        f64      </span>
<span class="go"></span>
<span class="go"> 0       2020-01-01  0.0      </span>
<span class="go"> 1       2020-01-03  0.292893 </span>
<span class="go"> 2       2020-01-10  1.492474 </span>
<span class="go"> null    2020-01-15  null     </span>
<span class="go"> 4       2020-01-17  3.254508 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ewm_std</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">com</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">half_life</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">adjust</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ignore_nulls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10937-L11037"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Exponentially-weighted moving standard deviation.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>com</strong></dt><dd><p>Specify decay in terms of center of mass, <span class="math notranslate nohighlight">\(\gamma\)</span>, with</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\alpha = \frac{1}{1 + \gamma} \; \forall \; \gamma \geq 0\]</div>
</div></blockquote>
</dd>
<dt><strong>span</strong></dt><dd><p>Specify decay in terms of span, <span class="math notranslate nohighlight">\(\theta\)</span>, with</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\alpha = \frac{2}{\theta + 1} \; \forall \; \theta \geq 1\]</div>
</div></blockquote>
</dd>
<dt><strong>half_life</strong></dt><dd><p>Specify decay in terms of half-life, <span class="math notranslate nohighlight">\(\lambda\)</span>, with</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\alpha = 1 - \exp \left\{ \frac{ -\ln(2) }{ \lambda } \right\} \;
\forall \; \lambda &gt; 0\]</div>
</div></blockquote>
</dd>
<dt><strong>alpha</strong></dt><dd><p>Specify smoothing factor alpha directly, <span class="math notranslate nohighlight">\(0 &lt; \alpha \leq 1\)</span>.</p>
</dd>
<dt><strong>adjust</strong></dt><dd><p>Divide by decaying adjustment factor in beginning periods to account for
imbalance in relative weightings</p>
<blockquote>
<div><ul>
<li><p>When <code class="code docutils literal notranslate"><span class="pre">adjust=True</span></code> (the default) the EW function is calculated
using weights <span class="math notranslate nohighlight">\(w_i = (1 - \alpha)^i\)</span></p></li>
<li><p>When <code class="code docutils literal notranslate"><span class="pre">adjust=False</span></code> the EW function is calculated
recursively by</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_0 &amp;= x_0 \\
y_t &amp;= (1 - \alpha)y_{t - 1} + \alpha x_t\end{split}\]</div>
</li>
</ul>
</div></blockquote>
</dd>
<dt><strong>bias</strong></dt><dd><p>When <code class="code docutils literal notranslate"><span class="pre">bias=False</span></code>, apply a correction to make the estimate statistically
unbiased.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>Minimum number of observations in window required to have a value
(otherwise result is null).</p>
</dd>
<dt><strong>ignore_nulls</strong></dt><dd><p>Ignore missing values when calculating weights.</p>
<blockquote>
<div><ul class="simple">
<li><p>When <code class="code docutils literal notranslate"><span class="pre">ignore_nulls=False</span></code>, weights are based on absolute
positions.
For example, the weights of <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> used in
calculating the final weighted average of
[<span class="math notranslate nohighlight">\(x_0\)</span>, None, <span class="math notranslate nohighlight">\(x_2\)</span>] are
<span class="math notranslate nohighlight">\((1-\alpha)^2\)</span> and <span class="math notranslate nohighlight">\(1\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=True</span></code>, and
<span class="math notranslate nohighlight">\((1-\alpha)^2\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=False</span></code>.</p></li>
<li><p>When <code class="code docutils literal notranslate"><span class="pre">ignore_nulls=True</span></code> (current default), weights are based
on relative positions. For example, the weights of
<span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> used in calculating the final weighted
average of [<span class="math notranslate nohighlight">\(x_0\)</span>, None, <span class="math notranslate nohighlight">\(x_2\)</span>] are
<span class="math notranslate nohighlight">\(1-\alpha\)</span> and <span class="math notranslate nohighlight">\(1\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=True</span></code>,
and <span class="math notranslate nohighlight">\(1-\alpha\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=False</span></code>.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ewm_std</span><span class="p">(</span><span class="n">com</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 0.0      </span>
<span class="go"> 0.707107 </span>
<span class="go"> 0.963624 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ewm_var</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">com</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">half_life</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">adjust</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ignore_nulls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11039-L11139"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Exponentially-weighted moving variance.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>com</strong></dt><dd><p>Specify decay in terms of center of mass, <span class="math notranslate nohighlight">\(\gamma\)</span>, with</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\alpha = \frac{1}{1 + \gamma} \; \forall \; \gamma \geq 0\]</div>
</div></blockquote>
</dd>
<dt><strong>span</strong></dt><dd><p>Specify decay in terms of span, <span class="math notranslate nohighlight">\(\theta\)</span>, with</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\alpha = \frac{2}{\theta + 1} \; \forall \; \theta \geq 1\]</div>
</div></blockquote>
</dd>
<dt><strong>half_life</strong></dt><dd><p>Specify decay in terms of half-life, <span class="math notranslate nohighlight">\(\lambda\)</span>, with</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\alpha = 1 - \exp \left\{ \frac{ -\ln(2) }{ \lambda } \right\} \;
\forall \; \lambda &gt; 0\]</div>
</div></blockquote>
</dd>
<dt><strong>alpha</strong></dt><dd><p>Specify smoothing factor alpha directly, <span class="math notranslate nohighlight">\(0 &lt; \alpha \leq 1\)</span>.</p>
</dd>
<dt><strong>adjust</strong></dt><dd><p>Divide by decaying adjustment factor in beginning periods to account for
imbalance in relative weightings</p>
<blockquote>
<div><ul>
<li><p>When <code class="code docutils literal notranslate"><span class="pre">adjust=True</span></code> (the default) the EW function is calculated
using weights <span class="math notranslate nohighlight">\(w_i = (1 - \alpha)^i\)</span></p></li>
<li><p>When <code class="code docutils literal notranslate"><span class="pre">adjust=False</span></code> the EW function is calculated
recursively by</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_0 &amp;= x_0 \\
y_t &amp;= (1 - \alpha)y_{t - 1} + \alpha x_t\end{split}\]</div>
</li>
</ul>
</div></blockquote>
</dd>
<dt><strong>bias</strong></dt><dd><p>When <code class="code docutils literal notranslate"><span class="pre">bias=False</span></code>, apply a correction to make the estimate statistically
unbiased.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>Minimum number of observations in window required to have a value
(otherwise result is null).</p>
</dd>
<dt><strong>ignore_nulls</strong></dt><dd><p>Ignore missing values when calculating weights.</p>
<blockquote>
<div><ul class="simple">
<li><p>When <code class="code docutils literal notranslate"><span class="pre">ignore_nulls=False</span></code>, weights are based on absolute
positions.
For example, the weights of <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> used in
calculating the final weighted average of
[<span class="math notranslate nohighlight">\(x_0\)</span>, None, <span class="math notranslate nohighlight">\(x_2\)</span>] are
<span class="math notranslate nohighlight">\((1-\alpha)^2\)</span> and <span class="math notranslate nohighlight">\(1\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=True</span></code>, and
<span class="math notranslate nohighlight">\((1-\alpha)^2\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=False</span></code>.</p></li>
<li><p>When <code class="code docutils literal notranslate"><span class="pre">ignore_nulls=True</span></code> (current default), weights are based
on relative positions. For example, the weights of
<span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> used in calculating the final weighted
average of [<span class="math notranslate nohighlight">\(x_0\)</span>, None, <span class="math notranslate nohighlight">\(x_2\)</span>] are
<span class="math notranslate nohighlight">\(1-\alpha\)</span> and <span class="math notranslate nohighlight">\(1\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=True</span></code>,
and <span class="math notranslate nohighlight">\(1-\alpha\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> if <code class="code docutils literal notranslate"><span class="pre">adjust=False</span></code>.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ewm_var</span><span class="p">(</span><span class="n">com</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 0.0      </span>
<span class="go"> 0.5      </span>
<span class="go"> 0.928571 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">exclude</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PolarsDataType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">PolarsDataType</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">more_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PolarsDataType</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L903-L1013"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Exclude columns from a multi-column expression.</p>
<p>Only works after a wildcard or regex column selection, and you cannot provide
both string column names <em>and</em> dtypes (you may prefer to use selectors instead).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>columns</strong></dt><dd><p>The name or datatype of the column(s) to exclude. Accepts regular expression
input. Regular expressions should start with <code class="code docutils literal notranslate"><span class="pre">^</span></code> and end with <code class="code docutils literal notranslate"><span class="pre">$</span></code>.</p>
</dd>
<dt><strong>*more_columns</strong></dt><dd><p>Additional names or datatypes of columns to exclude, specified as positional
arguments.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;aa&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;ba&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;cc&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (3, 3)</span>
<span class="go"></span>
<span class="go"> aa   ba    cc   </span>
<span class="go"> ---  ---   ---  </span>
<span class="go"> i64  str   f64  </span>
<span class="go"></span>
<span class="go"> 1    a     null </span>
<span class="go"> 2    b     2.5  </span>
<span class="go"> 3    null  1.5  </span>
<span class="go"></span>
</pre></div>
</div>
<p>Exclude by column name(s):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="s2">&quot;ba&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> aa   cc   </span>
<span class="go"> ---  ---  </span>
<span class="go"> i64  f64  </span>
<span class="go"></span>
<span class="go"> 1    null </span>
<span class="go"> 2    2.5  </span>
<span class="go"> 3    1.5  </span>
<span class="go"></span>
</pre></div>
</div>
<p>Exclude by regex, e.g. removing all columns whose names end with the letter a:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="s2">&quot;^.*a$&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> cc   </span>
<span class="go"> ---  </span>
<span class="go"> f64  </span>
<span class="go"></span>
<span class="go"> null </span>
<span class="go"> 2.5  </span>
<span class="go"> 1.5  </span>
<span class="go"></span>
</pre></div>
</div>
<p>Exclude by dtype(s), e.g. removing all columns of type Int64 or Float64:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">exclude</span><span class="p">([</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">]))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> ba   </span>
<span class="go"> ---  </span>
<span class="go"> str  </span>
<span class="go"></span>
<span class="go"> a    </span>
<span class="go"> b    </span>
<span class="go"> null </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L632-L651"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the exponential, element-wise.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> values   </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 2.718282 </span>
<span class="go"> 7.389056 </span>
<span class="go"> 54.59815 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">explode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5147-L5186"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Explode a list expression.</p>
<p>This means that every item is expanded to a new row.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression with the data type of the list elements.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.list.explode.html#polars.Expr.list.explode" title="polars.Expr.list.explode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Expr.list.explode</span></code></a></dt><dd><p>Explode a list column.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">... </span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>            <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">explode</span><span class="p">())</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> values </span>
<span class="go"> ---    </span>
<span class="go"> i64    </span>
<span class="go"></span>
<span class="go"> 1      </span>
<span class="go"> 2      </span>
<span class="go"> 3      </span>
<span class="go"> 4      </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">extend_constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11141-L11172"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Extremely fast method for extending the Series with n copies of a value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong></dt><dd><p>A constant literal value or a unit expressioin with which to extend the
expression result Series; can pass None to extend with nulls.</p>
</dd>
<dt><strong>n</strong></dt><dd><p>The number of additional values that will be added.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">extend_constant</span><span class="p">(</span><span class="mi">99</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">shape: (5, 1)</span>
<span class="go"></span>
<span class="go"> values </span>
<span class="go"> ---    </span>
<span class="go"> i64    </span>
<span class="go"></span>
<span class="go"> 0      </span>
<span class="go"> 1      </span>
<span class="go"> 2      </span>
<span class="go"> 99     </span>
<span class="go"> 99     </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">fill_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3200-L3239"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Fill floating point NaN value with a fill value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong></dt><dd><p>Value used to fill NaN values.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that floating point NaNs (Not a Number) are not missing values.
To replace missing values, use <a class="reference internal" href="api/polars.Expr.fill_null.html#polars.Expr.fill_null" title="polars.Expr.fill_null"><code class="xref py py-func docutils literal notranslate"><span class="pre">fill_null()</span></code></a>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.fill_null.html#polars.Expr.fill_null" title="polars.Expr.fill_null"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_null</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fill_nan</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a     b   </span>
<span class="go"> ---   --- </span>
<span class="go"> f64   f64 </span>
<span class="go"></span>
<span class="go"> 1.0   4.0 </span>
<span class="go"> null  0.0 </span>
<span class="go"> NaN   6.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">fill_null</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FillNullStrategy</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3092-L3198"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Fill null values using the specified value or strategy.</p>
<p>To interpolate over null values see interpolate.
See the examples below to fill nulls with an expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong></dt><dd><p>Value used to fill null values.</p>
</dd>
<dt><strong>strategy</strong><span class="classifier">{None, forward, backward, min, max, mean, zero, one}</span></dt><dd><p>Strategy used to fill null values.</p>
</dd>
<dt><strong>limit</strong></dt><dd><p>Number of consecutive null values to fill when using the forward or
backward strategy.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.fill_nan.html#polars.Expr.fill_nan" title="polars.Expr.fill_nan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_nan</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fill_null</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;zero&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a     b   </span>
<span class="go"> ---   --- </span>
<span class="go"> i64   i64 </span>
<span class="go"></span>
<span class="go"> 1     4   </span>
<span class="go"> 2     0   </span>
<span class="go"> null  6   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fill_null</span><span class="p">(</span><span class="mi">99</span><span class="p">))</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a     b   </span>
<span class="go"> ---   --- </span>
<span class="go"> i64   i64 </span>
<span class="go"></span>
<span class="go"> 1     4   </span>
<span class="go"> 2     99  </span>
<span class="go"> null  6   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fill_null</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a     b   </span>
<span class="go"> ---   --- </span>
<span class="go"> i64   i64 </span>
<span class="go"></span>
<span class="go"> 1     4   </span>
<span class="go"> 2     4   </span>
<span class="go"> null  6   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fill_null</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()))</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a     b   </span>
<span class="go"> ---   --- </span>
<span class="go"> i64   f64 </span>
<span class="go"></span>
<span class="go"> 1     4.0 </span>
<span class="go"> 2     5.0 </span>
<span class="go"> null  6.0 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">fill_null</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">median</span><span class="p">()))</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a    b   </span>
<span class="go"> ---  --- </span>
<span class="go"> f64  f64 </span>
<span class="go"></span>
<span class="go"> 1.0  4.0 </span>
<span class="go"> 2.0  5.0 </span>
<span class="go"> 1.5  6.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">predicates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExprColumn</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">IntoExprColumn</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4553-L4637"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Filter the expression based on one or more predicate expressions.</p>
<p>The original order of the remaining elements is preserved.</p>
<p>Elements where the filter does not evaluate to True are discarded, including
nulls.</p>
<p>Mostly useful in an aggregation context. If you want to filter on a DataFrame
level, use <code class="code docutils literal notranslate"><span class="pre">LazyFrame.filter</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predicates</strong></dt><dd><p>Expression(s) that evaluates to a boolean Series.</p>
</dd>
<dt><strong>constraints</strong></dt><dd><p>Column filters; use <code class="code docutils literal notranslate"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">value</span></code> to filter columns by the supplied value.
Each constraint will behave the same as <code class="code docutils literal notranslate"><span class="pre">pl.col(name).eq(value)</span></code>, and
will be implicitly joined with the other filter conditions using <code class="code docutils literal notranslate"><span class="pre">&amp;</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;group_col&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;g1&quot;</span><span class="p">,</span> <span class="s2">&quot;g1&quot;</span><span class="p">,</span> <span class="s2">&quot;g2&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;group_col&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">lt</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">gte</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;group_col&quot;</span><span class="p">)</span>
<span class="go">shape: (2, 3)</span>
<span class="go"></span>
<span class="go"> group_col  lt   gte </span>
<span class="go"> ---        ---  --- </span>
<span class="go"> str        i64  i64 </span>
<span class="go"></span>
<span class="go"> g1         1    2   </span>
<span class="go"> g2         0    3   </span>
<span class="go"></span>
</pre></div>
</div>
<p>Filter expressions can also take constraints as keyword arguments.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">polars.selectors</span> <span class="k">as</span> <span class="nn">cs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">n_1</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">n_2</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">n_3</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
<span class="go">shape: (2, 4)</span>
<span class="go"></span>
<span class="go"> key  n_1  n_2  n_3 </span>
<span class="go"> ---  ---  ---  --- </span>
<span class="go"> str  i64  i64  i64 </span>
<span class="go"></span>
<span class="go"> a    1    4    3   </span>
<span class="go"> b    1    2    9   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">first</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3758-L3775"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get the first value.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 1   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">flatten</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5120-L5145"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Flatten a list or string column.</p>
<p>Alias for <code class="xref py py-func docutils literal notranslate"><span class="pre">polars.expr.list.ExprListNameSpace.explode()</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>  
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> group  values    </span>
<span class="go"> ---    ---       </span>
<span class="go"> str    list[i64] </span>
<span class="go"></span>
<span class="go"> a      [1, 2]    </span>
<span class="go"> b      [2, 3, 4] </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">floor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1761-L1783"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Rounds down to the nearest integer value.</p>
<p>Only works on floating point Series.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">floor</span><span class="p">())</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 0.0 </span>
<span class="go"> 0.0 </span>
<span class="go"> 1.0 </span>
<span class="go"> 1.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">floordiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5746-L5831"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of integer division operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">//</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>Numeric literal or expression value.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.truediv.html#polars.Expr.truediv" title="polars.Expr.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">truediv</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">truediv</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x/2&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">floordiv</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x//2&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> x    x/2  x//2 </span>
<span class="go"> ---  ---  ---  </span>
<span class="go"> i64  f64  i64  </span>
<span class="go"></span>
<span class="go"> 1    0.5  0    </span>
<span class="go"> 2    1.0  1    </span>
<span class="go"> 3    1.5  1    </span>
<span class="go"> 4    2.0  2    </span>
<span class="go"> 5    2.5  2    </span>
<span class="go"></span>
</pre></div>
</div>
<p>Note that Polars <code class="code docutils literal notranslate"><span class="pre">floordiv</span></code> is subtly different from Pythons floor division.
For example, consider 6.0 floor-divided by 0.1.
Python gives:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mf">6.0</span> <span class="o">//</span> <span class="mf">0.1</span>
<span class="go">59.0</span>
</pre></div>
</div>
<p>because <code class="code docutils literal notranslate"><span class="pre">0.1</span></code> is not represented internally as that exact value,
but a slightly larger value.
So the result of the division is slightly less than 60,
meaning the flooring operation returns 59.0.</p>
<p>Polars instead first does the floating-point division,
resulting in a floating-point value of 60.0,
and then performs the flooring operation using <a class="reference internal" href="api/polars.Expr.floor.html#polars.Expr.floor" title="polars.Expr.floor"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">floor</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">6.03</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">truediv</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x/0.1&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x/0.1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">floor</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x/0.1 floor&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (2, 3)</span>
<span class="go"></span>
<span class="go"> x     x/0.1  x/0.1 floor </span>
<span class="go"> ---   ---    ---         </span>
<span class="go"> f64   f64    f64         </span>
<span class="go"></span>
<span class="go"> 6.0   60.0   60.0        </span>
<span class="go"> 6.03  60.3   60.0        </span>
<span class="go"></span>
</pre></div>
</div>
<p>yielding the more intuitive result 60.0.
The row with x = 6.03 is included to demonstrate
the effect of the flooring operation.</p>
<p><code class="code docutils literal notranslate"><span class="pre">floordiv</span></code> combines those two steps
to give the same result with one expression:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">floordiv</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x//0.1&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> x     x//0.1 </span>
<span class="go"> ---   ---    </span>
<span class="go"> f64   f64    </span>
<span class="go"></span>
<span class="go"> 6.0   60.0   </span>
<span class="go"> 6.03  60.0   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">forward_fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3241-L3275"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Fill missing values with the latest seen values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>limit</strong></dt><dd><p>The number of consecutive null values to forward fill.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.backward_fill.html#polars.Expr.backward_fill" title="polars.Expr.backward_fill"><code class="xref py py-obj docutils literal notranslate"><span class="pre">backward_fill</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.shift.html#polars.Expr.shift" title="polars.Expr.shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">forward_fill</span><span class="p">())</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a    b   </span>
<span class="go"> ---  --- </span>
<span class="go"> i64  i64 </span>
<span class="go"></span>
<span class="go"> 1    4   </span>
<span class="go"> 2    4   </span>
<span class="go"> 2    6   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L12186-L12207"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Read an expression from a JSON encoded string to construct an Expression.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.11: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.deserialize.html#polars.Expr.deserialize" title="polars.Expr.deserialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">deserialize()</span></code></a>.
Note that the new method operates on file-like inputs rather than strings.
Enclose your input in <code class="code docutils literal notranslate"><span class="pre">io.StringIO</span></code> to keep the same behavior.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong></dt><dd><p>JSON encoded string value</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">np.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L2915-L2969"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Take values by index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>indices</strong></dt><dd><p>An expression that leads to a UInt32 dtyped Series.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of the same data type.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.get.html#polars.Expr.get" title="polars.Expr.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Expr.get</span></code></a></dt><dd><p>Take a single value</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">... </span>            <span class="s2">&quot;one&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;one&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;one&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;two&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;two&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;two&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">maintain_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gather</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> group  value     </span>
<span class="go"> ---    ---       </span>
<span class="go"> str    list[i64] </span>
<span class="go"></span>
<span class="go"> one    [2, 98]   </span>
<span class="go"> two    [4, 99]   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">gather_every</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5212-L5250"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Take every nth value in the Series and return as a new Series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong></dt><dd><p>Gather every <em>n</em>-th row.</p>
</dd>
<dt><strong>offset</strong></dt><dd><p>Starting index.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gather_every</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> foo </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 1   </span>
<span class="go"> 4   </span>
<span class="go"> 7   </span>
<span class="go"></span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gather_every</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> foo </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 2   </span>
<span class="go"> 5   </span>
<span class="go"> 8   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5490-L5522"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of greater than or equal operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">&gt;=</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>A literal or expression value to compare with.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">2.0</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x &gt;= y&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> x    y    x &gt;= y </span>
<span class="go"> ---  ---  ---    </span>
<span class="go"> f64  f64  bool   </span>
<span class="go"></span>
<span class="go"> 5.0  5.0  true   </span>
<span class="go"> 4.0  3.0  true   </span>
<span class="go"> NaN  NaN  true   </span>
<span class="go"> 2.0  1.0  true   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L2971-L3012"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return a single value by index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>index</strong></dt><dd><p>An expression that leads to a UInt32 index.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of the same data type.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">... </span>            <span class="s2">&quot;one&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;one&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;one&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;two&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;two&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;two&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">maintain_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> group  value </span>
<span class="go"> ---    ---   </span>
<span class="go"> str    i64   </span>
<span class="go"></span>
<span class="go"> one    98    </span>
<span class="go"> two    99    </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">gt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5524-L5556"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of greater than operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">&gt;</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>A literal or expression value to compare with.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">2.0</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x &gt; y&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> x    y    x &gt; y </span>
<span class="go"> ---  ---  ---   </span>
<span class="go"> f64  f64  bool  </span>
<span class="go"></span>
<span class="go"> 5.0  5.0  false </span>
<span class="go"> 4.0  3.0  true  </span>
<span class="go"> NaN  NaN  false </span>
<span class="go"> 2.0  1.0  true  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">has_nulls</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Expr</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3660-L3683"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Check whether the expression contains one or more null values.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">850</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">has_nulls</span><span class="p">())</span>
<span class="go">shape: (1, 3)</span>
<span class="go"></span>
<span class="go"> a     b     c     </span>
<span class="go"> ---   ---   ---   </span>
<span class="go"> bool  bool  bool  </span>
<span class="go"></span>
<span class="go"> true  true  false </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">hash</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed_3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6275-L6328"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Hash the elements in the selection.</p>
<p>The hash value is of type <code class="code docutils literal notranslate"><span class="pre">UInt64</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>seed</strong></dt><dd><p>Random seed parameter. Defaults to 0.</p>
</dd>
<dt><strong>seed_1</strong></dt><dd><p>Random seed parameter. Defaults to <code class="code docutils literal notranslate"><span class="pre">seed</span></code> if not set.</p>
</dd>
<dt><strong>seed_2</strong></dt><dd><p>Random seed parameter. Defaults to <code class="code docutils literal notranslate"><span class="pre">seed</span></code> if not set.</p>
</dd>
<dt><strong>seed_3</strong></dt><dd><p>Random seed parameter. Defaults to <code class="code docutils literal notranslate"><span class="pre">seed</span></code> if not set.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This implementation of <code class="code docutils literal notranslate"><span class="pre">hash</span></code> does not guarantee stable results
across different Polars versions. Its stability is only guaranteed within a
single version.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">hash</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">))</span>  
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a                     b                    </span>
<span class="go"> ---                   ---                  </span>
<span class="go"> u64                   u64                  </span>
<span class="go"></span>
<span class="go"> 9774092659964970114   13614470193936745724 </span>
<span class="go"> 1101441246220388612   11638928888656214026 </span>
<span class="go"> 11638928888656214026  13382926553367784577 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5252-L5276"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get the first <code class="code docutils literal notranslate"><span class="pre">n</span></code> rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong></dt><dd><p>Number of rows to return.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> foo </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 1   </span>
<span class="go"> 2   </span>
<span class="go"> 3   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">hist</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">bin_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">include_category</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">include_breakpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11484-L11555"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bin values into buckets and count their occurrences.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>bins</strong></dt><dd><p>Discretizations to make.
If None given, we determine the boundaries based on the data.</p>
</dd>
<dt><strong>bin_count</strong></dt><dd><p>If no bins provided, this will be used to determine
the distance of the bins</p>
</dd>
<dt><strong>include_breakpoint</strong></dt><dd><p>Include a column that indicates the upper breakpoint.</p>
</dd>
<dt><strong>include_category</strong></dt><dd><p>Include a column that shows the intervals as categories.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>DataFrame</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> u32 </span>
<span class="go"></span>
<span class="go"> 2   </span>
<span class="go"> 1   </span>
<span class="go"> 2   </span>
<span class="go"> 2   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">include_breakpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_category</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> a                     </span>
<span class="go"> ---                   </span>
<span class="go"> struct[3]             </span>
<span class="go"></span>
<span class="go"> {1.0,&quot;(-inf, 1.0]&quot;,2} </span>
<span class="go"> {2.0,&quot;(1.0, 2.0]&quot;,1}  </span>
<span class="go"> {3.0,&quot;(2.0, 3.0]&quot;,2}  </span>
<span class="go"> {inf,&quot;(3.0, inf]&quot;,2}  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">implode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5188-L5210"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Aggregate values into a list.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">implode</span><span class="p">())</span>
<span class="go">shape: (1, 2)</span>
<span class="go"></span>
<span class="go"> a          b         </span>
<span class="go"> ---        ---       </span>
<span class="go"> list[i64]  list[i64] </span>
<span class="go"></span>
<span class="go"> [1, 2, 3]  [4, 5, 6] </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">inspect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'{}'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6365-L6396"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Print the value that this expression evaluates to and pass on the value.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_sum</span><span class="p">()</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="s2">&quot;value is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">))</span>
<span class="go">value is: shape: (3,)</span>
<span class="go">Series: &#39;foo&#39; [i64]</span>
<span class="go">[</span>
<span class="go">    1</span>
<span class="go">    2</span>
<span class="go">    4</span>
<span class="go">]</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> bar </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 1   </span>
<span class="go"> 2   </span>
<span class="go"> 4   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">InterpolationMethod</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6398-L6473"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Fill null values using interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>method</strong><span class="classifier">{linear, nearest}</span></dt><dd><p>Interpolation method.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Fill null values using linear interpolation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">3.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">interpolate</span><span class="p">())</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a    b   </span>
<span class="go"> ---  --- </span>
<span class="go"> f64  f64 </span>
<span class="go"></span>
<span class="go"> 1.0  1.0 </span>
<span class="go"> 2.0  NaN </span>
<span class="go"> 3.0  3.0 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Fill null values using nearest interpolation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="s2">&quot;nearest&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a    b   </span>
<span class="go"> ---  --- </span>
<span class="go"> i64  f64 </span>
<span class="go"></span>
<span class="go"> 1    1.0 </span>
<span class="go"> 3    NaN </span>
<span class="go"> 3    3.0 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Regrid data to a new grid.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_original_grid</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;grid_points&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>  <span class="c1"># Interpolate from this to the new grid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new_grid</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;grid_points&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new_grid</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">df_original_grid</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;grid_points&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">coalesce</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">interpolate</span><span class="p">())</span>
<span class="go">shape: (10, 2)</span>
<span class="go"></span>
<span class="go"> grid_points  values </span>
<span class="go"> ---          ---    </span>
<span class="go"> i64          f64    </span>
<span class="go"></span>
<span class="go"> 1            2.0    </span>
<span class="go"> 2            4.0    </span>
<span class="go"> 3            6.0    </span>
<span class="go"> 4            8.0    </span>
<span class="go"> 5            10.0   </span>
<span class="go"> 6            12.0   </span>
<span class="go"> 7            14.0   </span>
<span class="go"> 8            16.0   </span>
<span class="go"> 9            18.0   </span>
<span class="go"> 10           20.0   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">interpolate_by</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6475-L6508"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Fill null values using interpolation based on another column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>by</strong></dt><dd><p>Column to interpolate values based on.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Fill null values using linear interpolation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">a_interpolated</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">interpolate_by</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">))</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> a     b    a_interpolated </span>
<span class="go"> ---   ---  ---            </span>
<span class="go"> i64   i64  f64            </span>
<span class="go"></span>
<span class="go"> 1     1    1.0            </span>
<span class="go"> null  2    1.285714       </span>
<span class="go"> null  7    2.714286       </span>
<span class="go"> 3     8    3.0            </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_between</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">lower_bound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">upper_bound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'both'</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6161-L6273"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Check if this expression is between the given lower and upper bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lower_bound</strong></dt><dd><p>Lower bound value. Accepts expression input. Strings are parsed as column
names, other non-expression inputs are parsed as literals.</p>
</dd>
<dt><strong>upper_bound</strong></dt><dd><p>Upper bound value. Accepts expression input. Strings are parsed as column
names, other non-expression inputs are parsed as literals.</p>
</dd>
<dt><strong>closed</strong><span class="classifier">{both, left, right, none}</span></dt><dd><p>Define which sides of the interval are closed (inclusive).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If the value of the <code class="code docutils literal notranslate"><span class="pre">lower_bound</span></code> is greater than that of the <code class="code docutils literal notranslate"><span class="pre">upper_bound</span></code>
then the result will be False, as no value can satisfy the condition.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;num&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_between</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;is_between&quot;</span><span class="p">))</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> num  is_between </span>
<span class="go"> ---  ---        </span>
<span class="go"> i64  bool       </span>
<span class="go"></span>
<span class="go"> 1    false      </span>
<span class="go"> 2    true       </span>
<span class="go"> 3    true       </span>
<span class="go"> 4    true       </span>
<span class="go"> 5    false      </span>
<span class="go"></span>
</pre></div>
</div>
<p>Use the <code class="code docutils literal notranslate"><span class="pre">closed</span></code> argument to include or exclude the values at the bounds:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_between</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;is_between&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> num  is_between </span>
<span class="go"> ---  ---        </span>
<span class="go"> i64  bool       </span>
<span class="go"></span>
<span class="go"> 1    false      </span>
<span class="go"> 2    true       </span>
<span class="go"> 3    true       </span>
<span class="go"> 4    false      </span>
<span class="go"> 5    false      </span>
<span class="go"></span>
</pre></div>
</div>
<p>You can also use strings as well as numeric/temporal values (note: ensure that
string literals are wrapped with <code class="code docutils literal notranslate"><span class="pre">lit</span></code> so as not to conflate them with
column names):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">is_between</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">),</span> <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">),</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;is_between&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> a    is_between </span>
<span class="go"> ---  ---        </span>
<span class="go"> str  bool       </span>
<span class="go"></span>
<span class="go"> a    true       </span>
<span class="go"> b    true       </span>
<span class="go"> c    true       </span>
<span class="go"> d    false      </span>
<span class="go"> e    false      </span>
<span class="go"></span>
</pre></div>
</div>
<p>Use column expressions as lower/upper bounds, comparing to a literal value:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_between</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">),</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;between_ab&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> a    b    between_ab </span>
<span class="go"> ---  ---  ---        </span>
<span class="go"> i64  i64  bool       </span>
<span class="go"></span>
<span class="go"> 1    5    true       </span>
<span class="go"> 2    4    true       </span>
<span class="go"> 3    3    true       </span>
<span class="go"> 4    2    false      </span>
<span class="go"> 5    1    false      </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_duplicated</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4129-L4153"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return a boolean mask indicating duplicated values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_duplicated</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"> ---   </span>
<span class="go"> bool  </span>
<span class="go"></span>
<span class="go"> true  </span>
<span class="go"> true  </span>
<span class="go"> false </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_finite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1171-L1199"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Returns a boolean Series indicating which values are finite.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">is_finite</span><span class="p">())</span>
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> A     B     </span>
<span class="go"> ---   ---   </span>
<span class="go"> bool  bool  </span>
<span class="go"></span>
<span class="go"> true  true  </span>
<span class="go"> true  false </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_first</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11847-L11860"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return a boolean mask indicating the first occurrence of each distinct value.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.3: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.is_first_distinct.html#polars.Expr.is_first_distinct" title="polars.Expr.is_first_distinct"><code class="xref py py-func docutils literal notranslate"><span class="pre">Expr.is_first_distinct()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_first_distinct</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4073-L4099"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return a boolean mask indicating the first occurrence of each distinct value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_first_distinct</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;first&quot;</span><span class="p">))</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> a    first </span>
<span class="go"> ---  ---   </span>
<span class="go"> i64  bool  </span>
<span class="go"></span>
<span class="go"> 1    true  </span>
<span class="go"> 1    false </span>
<span class="go"> 2    true  </span>
<span class="go"> 3    true  </span>
<span class="go"> 2    false </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_in</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6080-L6117"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Check if elements of this expression are present in the other Series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>Series or sequence of primitive type.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;sets&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span> <span class="s2">&quot;optional_members&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">contains</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;optional_members&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_in</span><span class="p">(</span><span class="s2">&quot;sets&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 3)</span>
<span class="go"></span>
<span class="go"> sets       optional_members  contains </span>
<span class="go"> ---        ---               ---      </span>
<span class="go"> list[i64]  i64               bool     </span>
<span class="go"></span>
<span class="go"> [1, 2, 3]  1                 true     </span>
<span class="go"> [1, 2]     2                 true     </span>
<span class="go"> [9, 10]    3                 false    </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_infinite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1201-L1229"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Returns a boolean Series indicating which values are infinite.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">())</span>
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> A      B     </span>
<span class="go"> ---    ---   </span>
<span class="go"> bool   bool  </span>
<span class="go"></span>
<span class="go"> false  false </span>
<span class="go"> false  true  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_last</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11862-L11875"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return a boolean mask indicating the last occurrence of each distinct value.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.3: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.is_last_distinct.html#polars.Expr.is_last_distinct" title="polars.Expr.is_last_distinct"><code class="xref py py-func docutils literal notranslate"><span class="pre">Expr.is_last_distinct()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_last_distinct</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4101-L4127"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return a boolean mask indicating the last occurrence of each distinct value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_last_distinct</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;last&quot;</span><span class="p">))</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> a    last  </span>
<span class="go"> ---  ---   </span>
<span class="go"> i64  bool  </span>
<span class="go"></span>
<span class="go"> 1    false </span>
<span class="go"> 1    true  </span>
<span class="go"> 2    false </span>
<span class="go"> 3    true  </span>
<span class="go"> 2    true  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_nan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1231-L1262"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Returns a boolean Series indicating which values are NaN.</p>
<p class="rubric">Notes</p>
<p>Floating point <code class="code docutils literal notranslate"><span class="pre">NaN</span></code> (Not A Number) should not be confused
with missing data represented as <code class="code docutils literal notranslate"><span class="pre">Null/None</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span><span class="o">.</span><span class="n">is_nan</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_isnan&quot;</span><span class="p">))</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> a     b    b_isnan </span>
<span class="go"> ---   ---  ---     </span>
<span class="go"> i64   f64  bool    </span>
<span class="go"></span>
<span class="go"> 1     1.0  false   </span>
<span class="go"> 2     2.0  false   </span>
<span class="go"> null  NaN  true    </span>
<span class="go"> 1     1.0  false   </span>
<span class="go"> 5     5.0  false   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_not</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1066-L1074"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Negate a boolean expression.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.2: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.not_.html#polars.Expr.not_" title="polars.Expr.not_"><code class="xref py py-func docutils literal notranslate"><span class="pre">Expr.not_()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_not_nan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1264-L1295"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Returns a boolean Series indicating which values are not NaN.</p>
<p class="rubric">Notes</p>
<p>Floating point <code class="code docutils literal notranslate"><span class="pre">NaN</span></code> (Not A Number) should not be confused
with missing data represented as <code class="code docutils literal notranslate"><span class="pre">Null/None</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">)</span><span class="o">.</span><span class="n">is_not_nan</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_is_not_nan&quot;</span><span class="p">))</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> a     b    b_is_not_nan </span>
<span class="go"> ---   ---  ---          </span>
<span class="go"> i64   f64  bool         </span>
<span class="go"></span>
<span class="go"> 1     1.0  true         </span>
<span class="go"> 2     2.0  true         </span>
<span class="go"> null  NaN  false        </span>
<span class="go"> 1     1.0  true         </span>
<span class="go"> 5     5.0  true         </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_not_null</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1141-L1169"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Returns a boolean Series indicating which values are not null.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">is_not_null</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_not_null&quot;</span><span class="p">)</span>  <span class="c1"># nan != null</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 4)</span>
<span class="go"></span>
<span class="go"> a     b    a_not_null  b_not_null </span>
<span class="go"> ---   ---  ---         ---        </span>
<span class="go"> i64   f64  bool        bool       </span>
<span class="go"></span>
<span class="go"> 1     1.0  true        true       </span>
<span class="go"> 2     2.0  true        true       </span>
<span class="go"> null  NaN  false       true       </span>
<span class="go"> 1     1.0  true        true       </span>
<span class="go"> 5     5.0  true        true       </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_null</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1113-L1139"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Returns a boolean Series indicating which values are null.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">is_null</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_isnull&quot;</span><span class="p">))</span>  <span class="c1"># nan != null</span>
<span class="go">shape: (5, 4)</span>
<span class="go"></span>
<span class="go"> a     b    a_isnull  b_isnull </span>
<span class="go"> ---   ---  ---       ---      </span>
<span class="go"> i64   f64  bool      bool     </span>
<span class="go"></span>
<span class="go"> 1     1.0  false     false    </span>
<span class="go"> 2     2.0  false     false    </span>
<span class="go"> null  NaN  true      false    </span>
<span class="go"> 1     1.0  false     false    </span>
<span class="go"> 5     5.0  false     false    </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">is_unique</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4052-L4071"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get mask of unique values.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_unique</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"> ---   </span>
<span class="go"> bool  </span>
<span class="go"></span>
<span class="go"> false </span>
<span class="go"> false </span>
<span class="go"> true  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">keep_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L850-L901"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Keep the original root name of the expression.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.12: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.name.keep.html#polars.Expr.name.keep" title="polars.Expr.name.keep"><code class="xref py py-func docutils literal notranslate"><span class="pre">name.keep()</span></code></a>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.alias.html#polars.Expr.alias" title="polars.Expr.alias"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alias</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Due to implementation constraints, this method can only be called as the last
expression in a chain.</p>
<p class="rubric">Examples</p>
<p>Undo an alias operation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">keep</span><span class="p">())</span>
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> a    b   </span>
<span class="go"> ---  --- </span>
<span class="go"> i64  i64 </span>
<span class="go"></span>
<span class="go"> 9    3   </span>
<span class="go"> 18   4   </span>
<span class="go"></span>
</pre></div>
</div>
<p>Prevent errors due to duplicate column names.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">())</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">keep</span><span class="p">())</span>
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> a     b        </span>
<span class="go"> ---   ---      </span>
<span class="go"> f64   f64      </span>
<span class="go"></span>
<span class="go"> 10.0  3.333333 </span>
<span class="go"> 5.0   2.5      </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">kurtosis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fisher</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10051-L10084"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the kurtosis (Fisher or Pearson) of a dataset.</p>
<p>Kurtosis is the fourth central moment divided by the square of the
variance. If Fishers definition is used, then 3.0 is subtracted from
the result to give 0.0 for a normal distribution.
If bias is False then the kurtosis is calculated using k statistics to
eliminate bias coming from biased moment estimators.</p>
<p>See scipy.stats for more information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fisher</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, Fishers definition is used (normal ==&gt; 0.0). If False,
Pearsons definition is used (normal ==&gt; 3.0).</p>
</dd>
<dt><strong>bias</strong><span class="classifier">bool, optional</span></dt><dd><p>If False, the calculations are corrected for statistical bias.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a         </span>
<span class="go"> ---       </span>
<span class="go"> f64       </span>
<span class="go"></span>
<span class="go"> -1.153061 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">last</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3777-L3794"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get the last value.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 2   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">le</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5558-L5590"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of less than or equal operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">&lt;=</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>A literal or expression value to compare with.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">2.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x &lt;= y&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> x    y    x &lt;= y </span>
<span class="go"> ---  ---  ---    </span>
<span class="go"> f64  f64  bool   </span>
<span class="go"></span>
<span class="go"> 5.0  5.0  true   </span>
<span class="go"> 4.0  3.5  false  </span>
<span class="go"> NaN  NaN  true   </span>
<span class="go"> 0.5  2.0  true   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">len</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1359-L1387"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return the number of elements in the column.</p>
<p>Null values count towards the total.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">UInt32</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.count.html#polars.count" title="polars.count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">len</span><span class="p">())</span>
<span class="go">shape: (1, 2)</span>
<span class="go"></span>
<span class="go"> a    b   </span>
<span class="go"> ---  --- </span>
<span class="go"> u32  u32 </span>
<span class="go"></span>
<span class="go"> 3    3   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5305-L5329"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get the first <code class="code docutils literal notranslate"><span class="pre">n</span></code> rows (alias for <a class="reference internal" href="api/polars.Expr.head.html#polars.Expr.head" title="polars.Expr.head"><code class="xref py py-func docutils literal notranslate"><span class="pre">Expr.head()</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong></dt><dd><p>Number of rows to return.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> foo </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 1   </span>
<span class="go"> 2   </span>
<span class="go"> 3   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.718281828459045</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11279-L11303"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the logarithm to a given base.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>base</strong></dt><dd><p>Given base, defaults to <code class="code docutils literal notranslate"><span class="pre">e</span></code></p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 0.0      </span>
<span class="go"> 1.0      </span>
<span class="go"> 1.584963 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">log10</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L611-L630"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the base 10 logarithm of the input array, element-wise.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">log10</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> values  </span>
<span class="go"> ---     </span>
<span class="go"> f64     </span>
<span class="go"></span>
<span class="go"> 0.0     </span>
<span class="go"> 0.30103 </span>
<span class="go"> 0.60206 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">log1p</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11305-L11326"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the natural logarithm of each element plus one.</p>
<p>This computes <code class="code docutils literal notranslate"><span class="pre">log(1</span> <span class="pre">+</span> <span class="pre">x)</span></code> but is more numerically stable for <code class="code docutils literal notranslate"><span class="pre">x</span></code> close to zero.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">log1p</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 0.693147 </span>
<span class="go"> 1.098612 </span>
<span class="go"> 1.386294 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">lower_bound</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10151-L10171"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate the lower bound.</p>
<p>Returns a unit Series with the lowest value possible for the dtype of this
expression.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a                    </span>
<span class="go"> ---                  </span>
<span class="go"> i64                  </span>
<span class="go"></span>
<span class="go"> -9223372036854775808 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">lt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5592-L5624"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of less than operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">&lt;</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>A literal or expression value to compare with.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">3.0</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x &lt; y&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> x    y    x &lt; y </span>
<span class="go"> ---  ---  ---   </span>
<span class="go"> f64  f64  bool  </span>
<span class="go"></span>
<span class="go"> 1.0  2.0  true  </span>
<span class="go"> 2.0  2.0  false </span>
<span class="go"> NaN  NaN  false </span>
<span class="go"> 3.0  4.0  true  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">map</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">return_dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PolarsDataType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">agg_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11735-L11758"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a custom python function to a Series or sequence of Series.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.0: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.map_batches.html#polars.Expr.map_batches" title="polars.Expr.map_batches"><code class="xref py py-func docutils literal notranslate"><span class="pre">Expr.map_batches()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>function</strong></dt><dd><p>Lambda/ function to apply.</p>
</dd>
<dt><strong>return_dtype</strong></dt><dd><p>Dtype of the output Series.</p>
</dd>
<dt><strong>agg_list</strong></dt><dd><p>Aggregate list</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">map_alias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L713-L756"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Rename the output of an expression by mapping a function over the root name.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.12: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.name.map.html#polars.Expr.name.map" title="polars.Expr.name.map"><code class="xref py py-func docutils literal notranslate"><span class="pre">name.map()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>function</strong></dt><dd><p>Function that maps a root name to a new name.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.keep_name.html#polars.Expr.keep_name" title="polars.Expr.keep_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">keep_name</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.prefix.html#polars.Expr.prefix" title="polars.Expr.prefix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prefix</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.suffix.html#polars.Expr.suffix" title="polars.Expr.suffix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">suffix</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Remove a common suffix and convert to lower case.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;A_reverse&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;B_reverse&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;_reverse&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (3, 4)</span>
<span class="go"></span>
<span class="go"> A_reverse  B_reverse  a    b   </span>
<span class="go"> ---        ---        ---  --- </span>
<span class="go"> i64        str        i64  str </span>
<span class="go"></span>
<span class="go"> 3          z          1    x   </span>
<span class="go"> 2          y          2    y   </span>
<span class="go"> 1          x          3    z   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">map_batches</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">return_dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PolarsDataType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">agg_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">is_elementwise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">returns_scalar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4695-L4845"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a custom python function to a whole Series or sequence of Series.</p>
<p>The output of this custom function is presumed to be either a Series,
or a NumPy array (in which case it will be automatically converted into
a Series), or a scalar that will be converted into a Series. If the
result is a scalar and you want it to stay as a scalar, pass in
<code class="docutils literal notranslate"><span class="pre">returns_scalar=True</span></code>. If you want to apply a
custom function elementwise over single values, see <a class="reference internal" href="api/polars.Expr.map_elements.html#polars.Expr.map_elements" title="polars.Expr.map_elements"><code class="xref py py-func docutils literal notranslate"><span class="pre">map_elements()</span></code></a>.
A reasonable use case for <code class="code docutils literal notranslate"><span class="pre">map</span></code> functions is transforming the values
represented by an expression using a third-party library.</p>
<p>If your function returns a scalar, for example a float, use
<code class="xref py py-func docutils literal notranslate"><span class="pre">map_to_scalar()</span></code> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>function</strong></dt><dd><p>Lambda/function to apply.</p>
</dd>
<dt><strong>return_dtype</strong></dt><dd><p>Dtype of the output Series.
If not set, the dtype will be inferred based on the first non-null value
that is returned by the function.</p>
</dd>
<dt><strong>is_elementwise</strong></dt><dd><p>If set to true this can run in the streaming engine, but may yield
incorrect results in group-by. Ensure you know what you are doing!</p>
</dd>
<dt><strong>agg_list</strong></dt><dd><p>Aggregate the values of the expression into a list before applying the
function. This parameter only works in a group-by context.
The function will be invoked only once on a list of groups, rather than
once per group.</p>
</dd>
<dt><strong>returns_scalar</strong></dt><dd><p>If the function returns a scalar, by default it will be wrapped in
a list in the output, since the assumption is that the function
always returns something Series-like. If you want to keep the
result as a scalar, set this argument to True.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">return_dtype</span></code> is not provided, this may lead to unexpected results.
We allow this, but it is considered a bug in the users query.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.map_elements.html#polars.Expr.map_elements" title="polars.Expr.map_elements"><code class="xref py py-obj docutils literal notranslate"><span class="pre">map_elements</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.replace.html#polars.Expr.replace" title="polars.Expr.replace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">replace</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;sine&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;cosine&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">map_batches</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">argmax</span><span class="p">()))</span>
<span class="go">shape: (1, 2)</span>
<span class="go"></span>
<span class="go"> sine  cosine </span>
<span class="go"> ---   ---    </span>
<span class="go"> i64   i64    </span>
<span class="go"></span>
<span class="go"> 1     0      </span>
<span class="go"></span>
</pre></div>
</div>
<p>In a group-by context, the <code class="code docutils literal notranslate"><span class="pre">agg_list</span></code> parameter can improve performance if used
correctly. The following example has <code class="code docutils literal notranslate"><span class="pre">agg_list</span></code> set to <code class="code docutils literal notranslate"><span class="pre">False</span></code>, which causes
the function to be applied once per group. The input of the function is a
Series of type <code class="code docutils literal notranslate"><span class="pre">Int64</span></code>. This is less efficient.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_batches</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">agg_list</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> a    b         </span>
<span class="go"> ---  ---       </span>
<span class="go"> i64  list[i64] </span>
<span class="go"></span>
<span class="go"> 1    [4, 6]    </span>
<span class="go"> 0    [3, 5]    </span>
<span class="go"></span>
</pre></div>
</div>
<p>Using <code class="code docutils literal notranslate"><span class="pre">agg_list=True</span></code> would be more efficient. In this example, the input of
the function is a Series of type <code class="code docutils literal notranslate"><span class="pre">List(Int64)</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_batches</span><span class="p">(</span>
<span class="gp">... </span>        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">element</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="n">agg_list</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> a    b         </span>
<span class="go"> ---  ---       </span>
<span class="go"> i64  list[i64] </span>
<span class="go"></span>
<span class="go"> 0    [3, 5]    </span>
<span class="go"> 1    [4, 6]    </span>
<span class="go"></span>
</pre></div>
</div>
<p>Heres an example of a function that returns a scalar, where we want it
to stay as a scalar:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_batches</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">returns_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> a    b   </span>
<span class="go"> ---  --- </span>
<span class="go"> i64  i64 </span>
<span class="go"></span>
<span class="go"> 1    4   </span>
<span class="go"> 0    3   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">map_dict</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">return_dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PolarsDataType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L12151-L12184"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Replace values in column according to remapping dictionary.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.16: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.replace.html#polars.Expr.replace" title="polars.Expr.replace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">replace()</span></code></a>. The default behavior
has changed to keep any values not present in the mapping unchanged.
Pass <code class="code docutils literal notranslate"><span class="pre">default=None</span></code> to keep existing behavior.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mapping</strong></dt><dd><p>Dictionary containing the before/after values to map.</p>
</dd>
<dt><strong>default</strong></dt><dd><p>Value to use when the remapping dict does not contain the lookup value.
Accepts expression input. Non-expression inputs are parsed as literals.
Use <code class="code docutils literal notranslate"><span class="pre">pl.first()</span></code>, to keep the original value.</p>
</dd>
<dt><strong>return_dtype</strong></dt><dd><p>Set return dtype to override automatic return dtype determination.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">map_elements</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">return_dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PolarsDataType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">skip_nulls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">pass_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MapElementsStrategy</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'thread_local'</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4847-L5118"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Map a custom/user-defined function (UDF) to each element of a column.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is much slower than the native expressions API.
Only use it if you cannot implement your logic otherwise.</p>
<p>Suppose that the function is: <code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre"></span> <span class="pre">sqrt(x)</span></code>:</p>
<ul class="simple">
<li><p>For mapping elements of a series, consider:
<code class="code docutils literal notranslate"><span class="pre">pl.col(&quot;col_name&quot;).sqrt()</span></code>.</p></li>
<li><p>For mapping inner elements of lists, consider:
<code class="code docutils literal notranslate"><span class="pre">pl.col(&quot;col_name&quot;).list.eval(pl.element().sqrt())</span></code>.</p></li>
</ul>
</div>
<p>The UDF is applied to each element of a column. Note that, in a GroupBy
context, the column will have been pre-aggregated and so each element
will itself be a Series. Therefore, depending on the context,
requirements for <code class="code docutils literal notranslate"><span class="pre">function</span></code> differ:</p>
<ul class="simple">
<li><dl class="simple">
<dt>Selection</dt><dd><p>Expects <code class="code docutils literal notranslate"><span class="pre">function</span></code> to be of type <code class="code docutils literal notranslate"><span class="pre">Callable[[Any],</span> <span class="pre">Any]</span></code>.
Applies a Python function to each individual value in the column.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>GroupBy</dt><dd><p>Expects <code class="code docutils literal notranslate"><span class="pre">function</span></code> to be of type <code class="code docutils literal notranslate"><span class="pre">Callable[[Series],</span> <span class="pre">Any]</span></code>.
For each group, applies a Python function to the slice of the column
corresponding to that group.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>function</strong></dt><dd><p>Lambda/function to map.</p>
</dd>
<dt><strong>return_dtype</strong></dt><dd><p>Dtype of the output Series.
If not set, the dtype will be inferred based on the first non-null value
that is returned by the function.</p>
</dd>
<dt><strong>skip_nulls</strong></dt><dd><p>Dont map the function over values that contain nulls (this is faster).</p>
</dd>
<dt><strong>pass_name</strong></dt><dd><p>Pass the Series name to the custom function (this is more expensive).</p>
</dd>
<dt><strong>strategy</strong><span class="classifier">{thread_local, threading}</span></dt><dd><p>The threading strategy to use.</p>
<ul class="simple">
<li><p>thread_local: run the python function on a single thread.</p></li>
<li><p>threading: run the python function on separate threads. Use with
care as this can slow performance. This might only speed up
your code if the amount of work per element is significant
and the python function releases the GIL (e.g. via calling
a c function)</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">return_dtype</span></code> is not provided, this may lead to unexpected results.
We allow this, but it is considered a bug in the users query.</p>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Using <code class="code docutils literal notranslate"><span class="pre">map_elements</span></code> is strongly discouraged as you will be effectively
running python for loops, which will be very slow. Wherever possible you
should prefer the native expression API to achieve the best performance.</p></li>
<li><p>If your function is expensive and you dont want it to be called more than
once for a given input, consider applying an <code class="code docutils literal notranslate"><span class="pre">&#64;lru_cache</span></code> decorator to it.
If your data is suitable you may achieve <em>significant</em> speedups.</p></li>
<li><p>Window function application using <code class="code docutils literal notranslate"><span class="pre">over</span></code> is considered a GroupBy context
here, so <code class="code docutils literal notranslate"><span class="pre">map_elements</span></code> can be used to map functions over window groups.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>The function is applied to each element of column <code class="code docutils literal notranslate"><span class="pre">'a'</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>  
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;a_times_2&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> a    b    a_times_2 </span>
<span class="go"> ---  ---  ---       </span>
<span class="go"> i64  str  i64       </span>
<span class="go"></span>
<span class="go"> 1    a    2         </span>
<span class="go"> 2    b    4         </span>
<span class="go"> 3    c    6         </span>
<span class="go"> 1    c    2         </span>
<span class="go"></span>
</pre></div>
</div>
<p>Tip: it is better to implement this with an expression:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;a_times_2&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>  
</pre></div>
</div>
<p>In a GroupBy context, each element of the column is itself a Series:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">lazy</span><span class="p">()</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> b    a         </span>
<span class="go"> ---  ---       </span>
<span class="go"> str  list[i64] </span>
<span class="go"></span>
<span class="go"> a    [1]       </span>
<span class="go"> b    [2]       </span>
<span class="go"> c    [3, 1]    </span>
<span class="go"></span>
</pre></div>
</div>
<p>Therefore, from the users point-of-view, the function is applied per-group:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">lazy</span><span class="p">()</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">))</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> b    a   </span>
<span class="go"> ---  --- </span>
<span class="go"> str  i64 </span>
<span class="go"></span>
<span class="go"> a    1   </span>
<span class="go"> b    2   </span>
<span class="go"> c    4   </span>
<span class="go"></span>
</pre></div>
</div>
<p>Tip: again, it is better to implement this with an expression:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">lazy</span><span class="p">()</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">maintain_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">... </span><span class="p">)</span>  
</pre></div>
</div>
<p>Window function application using <code class="code docutils literal notranslate"><span class="pre">over</span></code> will behave as a GroupBy
context, with your function receiving individual window groups:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">scaled</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;val&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">))</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
<span class="go">shape: (6, 3)</span>
<span class="go"></span>
<span class="go"> key  val  scaled </span>
<span class="go"> ---  ---  ---    </span>
<span class="go"> str  i64  i64    </span>
<span class="go"></span>
<span class="go"> x    1    3      </span>
<span class="go"> x    1    3      </span>
<span class="go"> x    1    3      </span>
<span class="go"> y    1    2      </span>
<span class="go"> y    1    2      </span>
<span class="go"> z    1    1      </span>
<span class="go"></span>
</pre></div>
</div>
<p>Note that this function would <em>also</em> be better-implemented natively:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">scaled</span><span class="o">=</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;val&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;val&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">())</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">max</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3412-L3429"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get maximum value.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 1.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3518-L3535"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get mean value.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 0.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">median</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3537-L3554"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get median value using linear interpolation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 0.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3431-L3448"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get minimum value.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a    </span>
<span class="go"> ---  </span>
<span class="go"> f64  </span>
<span class="go"></span>
<span class="go"> -1.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5833-L5859"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of modulus operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">%</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>Numeric literal or expression value.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x%2&quot;</span><span class="p">))</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> x    x%2 </span>
<span class="go"> ---  --- </span>
<span class="go"> i64  i64 </span>
<span class="go"></span>
<span class="go"> 0    0   </span>
<span class="go"> 1    1   </span>
<span class="go"> 2    0   </span>
<span class="go"> 3    1   </span>
<span class="go"> 4    0   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1892-L1917"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the most occurring value(s).</p>
<p>Can return multiple Values.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">mode</span><span class="p">())</span>  
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> a    b   </span>
<span class="go"> ---  --- </span>
<span class="go"> i64  i64 </span>
<span class="go"></span>
<span class="go"> 1    1   </span>
<span class="go"> 1    2   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5861-L5890"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of multiplication operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">*</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>Numeric literal or expression value.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x*2&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x * xlog2&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> x    x*2  x * xlog2 </span>
<span class="go"> ---  ---  ---       </span>
<span class="go"> i64  i64  f64       </span>
<span class="go"></span>
<span class="go"> 1    2    0.0       </span>
<span class="go"> 2    4    2.0       </span>
<span class="go"> 4    8    8.0       </span>
<span class="go"> 8    16   24.0      </span>
<span class="go"> 16   32   64.0      </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">n_unique</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3575-L3599"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Count unique values.</p>
<p class="rubric">Notes</p>
<p><code class="code docutils literal notranslate"><span class="pre">null</span></code> is considered to be a unique value for the purposes of this operation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">x_unique</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">n_unique</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">y_unique</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">n_unique</span><span class="p">(),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (1, 2)</span>
<span class="go"></span>
<span class="go"> x_unique  y_unique </span>
<span class="go"> ---       ---      </span>
<span class="go"> u32       u32      </span>
<span class="go"></span>
<span class="go"> 3         2        </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">nan_max</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3450-L3470"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get maximum value, but propagate/poison encountered NaN values.</p>
<p>This differs from numpys <code class="code docutils literal notranslate"><span class="pre">nanmax</span></code> as numpy defaults to propagating NaN values,
whereas polars defaults to ignoring them.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nan_max</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> NaN </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">nan_min</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3472-L3492"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get minimum value, but propagate/poison encountered NaN values.</p>
<p>This differs from numpys <code class="code docutils literal notranslate"><span class="pre">nanmax</span></code> as numpy defaults to propagating NaN values,
whereas polars defaults to ignoring them.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nan_min</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> NaN </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5626-L5658"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of inequality operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">!=</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>A literal or expression value to compare with.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x != y&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> x    y    x != y </span>
<span class="go"> ---  ---  ---    </span>
<span class="go"> f64  f64  bool   </span>
<span class="go"></span>
<span class="go"> 1.0  2.0  true   </span>
<span class="go"> 2.0  2.0  false  </span>
<span class="go"> NaN  NaN  false  </span>
<span class="go"> 4.0  4.0  false  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ne_missing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5660-L5698"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of equality operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">!=</span> <span class="pre">other</span></code> where <code class="code docutils literal notranslate"><span class="pre">None</span> <span class="pre">==</span> <span class="pre">None</span></code>.</p>
<p>This differs from default <code class="code docutils literal notranslate"><span class="pre">ne</span></code> where null values are propagated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>A literal or expression value to compare with.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">4.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x ne y&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ne_missing</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x ne_missing y&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 4)</span>
<span class="go"></span>
<span class="go"> x     y     x ne y  x ne_missing y </span>
<span class="go"> ---   ---   ---     ---            </span>
<span class="go"> f64   f64   bool    bool           </span>
<span class="go"></span>
<span class="go"> 1.0   2.0   true    true           </span>
<span class="go"> 2.0   2.0   false   false          </span>
<span class="go"> NaN   NaN   false   false          </span>
<span class="go"> 4.0   4.0   false   false          </span>
<span class="go"> null  5.0   null    true           </span>
<span class="go"> null  null  null    false          </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">neg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5923-L5943"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of unary minus operator <code class="code docutils literal notranslate"><span class="pre">-expr</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">neg</span><span class="p">())</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> a    </span>
<span class="go"> ---  </span>
<span class="go"> i64  </span>
<span class="go"></span>
<span class="go"> 1    </span>
<span class="go"> 0    </span>
<span class="go"> -2   </span>
<span class="go"> null </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">not_</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1076-L1111"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Negate a boolean expression.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a      b    </span>
<span class="go"> ---    ---  </span>
<span class="go"> bool   str  </span>
<span class="go"></span>
<span class="go"> true   a    </span>
<span class="go"> false  b    </span>
<span class="go"> false  null </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">not_</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"> ---   </span>
<span class="go"> bool  </span>
<span class="go"></span>
<span class="go"> false </span>
<span class="go"> true  </span>
<span class="go"> true  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">null_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3635-L3658"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Count null values.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">850</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">null_count</span><span class="p">())</span>
<span class="go">shape: (1, 3)</span>
<span class="go"></span>
<span class="go"> a    b    c   </span>
<span class="go"> ---  ---  --- </span>
<span class="go"> u32  u32  u32 </span>
<span class="go"></span>
<span class="go"> 2    1    0   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">or_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5374-L5414"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of bitwise or operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">|</span> <span class="pre">other</span> <span class="pre">|</span> <span class="pre">...</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>*others</strong></dt><dd><p>One or more integer or boolean expressions to evaluate/combine.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.75</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">or_</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">==</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;any&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 1)</span>
<span class="go"></span>
<span class="go"> any   </span>
<span class="go"> ---   </span>
<span class="go"> bool  </span>
<span class="go"></span>
<span class="go"> false </span>
<span class="go"> true  </span>
<span class="go"> false </span>
<span class="go"> true  </span>
<span class="go"> false </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">over</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">IntoExpr</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">more_exprs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mapping_strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">WindowMappingStrategy</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'group_to_rows'</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3796-L3936"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute expressions over the given groups.</p>
<p>This expression is similar to performing a group by aggregation and joining the
result back into the original DataFrame.</p>
<p>The outcome is similar to how <a class="reference external" href="https://www.postgresql.org/docs/current/tutorial-window.html">window functions</a>
work in PostgreSQL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>expr</strong></dt><dd><p>Column(s) to group by. Accepts expression input. Strings are parsed as
column names.</p>
</dd>
<dt><strong>*more_exprs</strong></dt><dd><p>Additional columns to group by, specified as positional arguments.</p>
</dd>
<dt><strong>mapping_strategy: {group_to_rows, join, explode}</strong></dt><dd><ul class="simple">
<li><dl class="simple">
<dt>group_to_rows</dt><dd><p>If the aggregation results in multiple values, assign them back to their
position in the DataFrame. This can only be done if the group yields
the same elements before aggregation as after.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>join</dt><dd><p>Join the groups as List&lt;group_dtype&gt; to the row positions.
warning: this can be memory intensive.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>explode</dt><dd><p>Explodes the grouped data into new rows, similar to the results of
<code class="code docutils literal notranslate"><span class="pre">group_by</span></code> + <code class="code docutils literal notranslate"><span class="pre">agg</span></code> + <code class="code docutils literal notranslate"><span class="pre">explode</span></code>. Sorting of the given groups is required
if the groups are not part of the window operation for the operation,
otherwise the result would not make sense. This operation changes the
number of rows.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Pass the name of a column to compute the expression over that column.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_max&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 4)</span>
<span class="go"></span>
<span class="go"> a    b    c    c_max </span>
<span class="go"> ---  ---  ---  ---   </span>
<span class="go"> str  i64  i64  i64   </span>
<span class="go"></span>
<span class="go"> a    1    5    5     </span>
<span class="go"> a    2    4    5     </span>
<span class="go"> b    3    3    3     </span>
<span class="go"> b    5    2    3     </span>
<span class="go"> b    3    1    3     </span>
<span class="go"></span>
</pre></div>
</div>
<p>Expression input is supported.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_max&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 4)</span>
<span class="go"></span>
<span class="go"> a    b    c    c_max </span>
<span class="go"> ---  ---  ---  ---   </span>
<span class="go"> str  i64  i64  i64   </span>
<span class="go"></span>
<span class="go"> a    1    5    5     </span>
<span class="go"> a    2    4    4     </span>
<span class="go"> b    3    3    4     </span>
<span class="go"> b    5    2    2     </span>
<span class="go"> b    3    1    4     </span>
<span class="go"></span>
</pre></div>
</div>
<p>Group by multiple columns by passing a list of column names or expressions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_min&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 4)</span>
<span class="go"></span>
<span class="go"> a    b    c    c_min </span>
<span class="go"> ---  ---  ---  ---   </span>
<span class="go"> str  i64  i64  i64   </span>
<span class="go"></span>
<span class="go"> a    1    5    5     </span>
<span class="go"> a    2    4    4     </span>
<span class="go"> b    3    3    1     </span>
<span class="go"> b    5    2    2     </span>
<span class="go"> b    3    1    1     </span>
<span class="go"></span>
</pre></div>
</div>
<p>Or use positional arguments to group by multiple columns in the same way.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_min&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 4)</span>
<span class="go"></span>
<span class="go"> a    b    c    c_min </span>
<span class="go"> ---  ---  ---  ---   </span>
<span class="go"> str  i64  i64  i64   </span>
<span class="go"></span>
<span class="go"> a    1    5    5     </span>
<span class="go"> a    2    4    4     </span>
<span class="go"> b    3    3    1     </span>
<span class="go"> b    5    2    1     </span>
<span class="go"> b    3    1    1     </span>
<span class="go"></span>
</pre></div>
</div>
<p>Aggregate values from each group using <code class="code docutils literal notranslate"><span class="pre">mapping_strategy=&quot;explode&quot;</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">mapping_strategy</span><span class="o">=</span><span class="s2">&quot;explode&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">mapping_strategy</span><span class="o">=</span><span class="s2">&quot;explode&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">mapping_strategy</span><span class="o">=</span><span class="s2">&quot;explode&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> a    b    c   </span>
<span class="go"> ---  ---  --- </span>
<span class="go"> str  i64  i64 </span>
<span class="go"></span>
<span class="go"> a    1    5   </span>
<span class="go"> a    2    4   </span>
<span class="go"> b    3    3   </span>
<span class="go"> b    3    1   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">pct_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L9960-L9996"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes percentage change between values.</p>
<p>Percentage change (as fraction) between current element and most-recent
non-null element at least <code class="code docutils literal notranslate"><span class="pre">n</span></code> period(s) before the current element.</p>
<p>Computes the change from the previous row by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong></dt><dd><p>periods to shift for forming percent change.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;pct_change&quot;</span><span class="p">))</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> a     pct_change </span>
<span class="go"> ---   ---        </span>
<span class="go"> i64   f64        </span>
<span class="go"></span>
<span class="go"> 10    null       </span>
<span class="go"> 11    0.1        </span>
<span class="go"> 12    0.090909   </span>
<span class="go"> null  0.0        </span>
<span class="go"> 12    0.0        </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">peak_max</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4155-L4176"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get a boolean mask of the local maximum peaks.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">peak_max</span><span class="p">())</span>
<span class="go">shape: (5, 1)</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"> ---   </span>
<span class="go"> bool  </span>
<span class="go"></span>
<span class="go"> false </span>
<span class="go"> false </span>
<span class="go"> false </span>
<span class="go"> false </span>
<span class="go"> true  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">peak_min</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4178-L4199"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get a boolean mask of the local minimum peaks.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">peak_min</span><span class="p">())</span>
<span class="go">shape: (5, 1)</span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"> ---   </span>
<span class="go"> bool  </span>
<span class="go"></span>
<span class="go"> false </span>
<span class="go"> true  </span>
<span class="go"> false </span>
<span class="go"> true  </span>
<span class="go"> false </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">pipe</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="pre">Concatenate</span><span class="p"><span class="pre">[</span></span><span class="pre">Expr</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">P.args</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">P.kwargs</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">T</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1015-L1064"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Offers a structured way to apply a sequence of user-defined functions (UDFs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>function</strong></dt><dd><p>Callable; will receive the expression as the first parameter,
followed by any given args/kwargs.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Arguments to pass to the UDF.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments to pass to the UDF.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">extract_number</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract the digits from a string.&quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\d+&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">scale_negative_even</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">Expr</span><span class="p">:</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set even numbers negative, and scale by a user-supplied value.&quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="n">expr</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="n">expr</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="o">-</span><span class="n">expr</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">expr</span> <span class="o">*</span> <span class="n">n</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a: 1&quot;</span><span class="p">,</span> <span class="s2">&quot;b: 2&quot;</span><span class="p">,</span> <span class="s2">&quot;c: 3&quot;</span><span class="p">,</span> <span class="s2">&quot;d: 4&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">udfs</span><span class="o">=</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;val&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">extract_number</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">scale_negative_even</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 2)</span>
<span class="go"></span>
<span class="go"> val   udfs </span>
<span class="go"> ---   ---  </span>
<span class="go"> str   i64  </span>
<span class="go"></span>
<span class="go"> a: 1  5    </span>
<span class="go"> b: 2  -10  </span>
<span class="go"> c: 3  15   </span>
<span class="go"> d: 4  -20  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">pow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExprColumn</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5989-L6017"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of exponentiation operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">**</span> <span class="pre">exponent</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>exponent</strong></dt><dd><p>Numeric literal or expression exponent value.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;cube&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x ** xlog2&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> x    cube  x ** xlog2 </span>
<span class="go"> ---  ---   ---        </span>
<span class="go"> i64  i64   f64        </span>
<span class="go"></span>
<span class="go"> 1    1     1.0        </span>
<span class="go"> 2    8     2.0        </span>
<span class="go"> 4    64    16.0       </span>
<span class="go"> 8    512   512.0      </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L758-L802"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Add a prefix to the root column name of the expression.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.12: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.name.prefix.html#polars.Expr.name.prefix" title="polars.Expr.name.prefix"><code class="xref py py-func docutils literal notranslate"><span class="pre">name.prefix()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>prefix</strong></dt><dd><p>Prefix to add to the root column name.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.suffix.html#polars.Expr.suffix" title="polars.Expr.suffix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">suffix</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This will undo any previous renaming operations on the expression.</p>
<p>Due to implementation constraints, this method can only be called as the last
expression in a chain.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">prefix</span><span class="p">(</span><span class="s2">&quot;reverse_&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 4)</span>
<span class="go"></span>
<span class="go"> a    b    reverse_a  reverse_b </span>
<span class="go"> ---  ---  ---        ---       </span>
<span class="go"> i64  str  i64        str       </span>
<span class="go"></span>
<span class="go"> 1    x    3          z         </span>
<span class="go"> 2    y    2          y         </span>
<span class="go"> 3    z    1          x         </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">product</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3556-L3573"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the product of an expression.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">product</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 6   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">qcut</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">left_closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">allow_duplicates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">include_breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4351-L4466"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bin continuous values into discrete categories based on their quantiles.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>quantiles</strong></dt><dd><p>Either a list of quantile probabilities between 0 and 1 or a positive
integer determining the number of bins with uniform probability.</p>
</dd>
<dt><strong>labels</strong></dt><dd><p>Names of the categories. The number of labels must be equal to the number
of categories.</p>
</dd>
<dt><strong>left_closed</strong></dt><dd><p>Set the intervals to be left-closed instead of right-closed.</p>
</dd>
<dt><strong>allow_duplicates</strong></dt><dd><p>If set to <code class="code docutils literal notranslate"><span class="pre">True</span></code>, duplicates in the resulting quantiles are dropped,
rather than raising a <code class="code docutils literal notranslate"><span class="pre">DuplicateError</span></code>. This can happen even with unique
probabilities, depending on the data.</p>
</dd>
<dt><strong>include_breaks</strong></dt><dd><p>Include a column with the right endpoint of the bin each observation falls
in. This will change the data type of the output from a
<code class="xref py py-class docutils literal notranslate"><span class="pre">Categorical</span></code> to a <code class="xref py py-class docutils literal notranslate"><span class="pre">Struct</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Categorical</span></code> if <code class="code docutils literal notranslate"><span class="pre">include_breaks</span></code> is set to
<code class="code docutils literal notranslate"><span class="pre">False</span></code> (default), otherwise an expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Struct</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.cut.html#polars.Expr.cut" title="polars.Expr.cut"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cut</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Divide a column into three categories according to pre-defined quantile
probabilities.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">qcut</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;qcut&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> foo  qcut </span>
<span class="go"> ---  ---  </span>
<span class="go"> i64  cat  </span>
<span class="go"></span>
<span class="go"> -2   a    </span>
<span class="go"> -1   a    </span>
<span class="go"> 0    b    </span>
<span class="go"> 1    b    </span>
<span class="go"> 2    c    </span>
<span class="go"></span>
</pre></div>
</div>
<p>Divide a column into two categories using uniform quantile probabilities.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">],</span> <span class="n">left_closed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;qcut&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> foo  qcut </span>
<span class="go"> ---  ---  </span>
<span class="go"> i64  cat  </span>
<span class="go"></span>
<span class="go"> -2   low  </span>
<span class="go"> -1   low  </span>
<span class="go"> 0    high </span>
<span class="go"> 1    high </span>
<span class="go"> 2    high </span>
<span class="go"></span>
</pre></div>
</div>
<p>Add both the category and the breakpoint.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">qcut</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span> <span class="n">include_breaks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;qcut&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">unnest</span><span class="p">(</span><span class="s2">&quot;qcut&quot;</span><span class="p">)</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> foo  brk   foo_bin    </span>
<span class="go"> ---  ---   ---        </span>
<span class="go"> i64  f64   cat        </span>
<span class="go"></span>
<span class="go"> -2   -1.0  (-inf, -1] </span>
<span class="go"> -1   -1.0  (-inf, -1] </span>
<span class="go"> 0    1.0   (-1, 1]    </span>
<span class="go"> 1    1.0   (-1, 1]    </span>
<span class="go"> 2    inf   (1, inf]   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">quantile</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RollingInterpolationMethod</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nearest'</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4201-L4266"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get quantile value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>quantile</strong></dt><dd><p>Quantile between 0.0 and 1.0.</p>
</dd>
<dt><strong>interpolation</strong><span class="classifier">{nearest, higher, lower, midpoint, linear}</span></dt><dd><p>Interpolation method.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.3</span><span class="p">))</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 2.0 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;higher&quot;</span><span class="p">))</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 2.0 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">))</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 1.0 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;midpoint&quot;</span><span class="p">))</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 1.5 </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">))</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 1.5 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">radians</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10571-L10601"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convert from degrees to radians.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">720</span><span class="p">,</span> <span class="o">-</span><span class="mi">540</span><span class="p">,</span> <span class="o">-</span><span class="mi">360</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">radians</span><span class="p">())</span>
<span class="go">shape: (9, 1)</span>
<span class="go"></span>
<span class="go"> a          </span>
<span class="go"> ---        </span>
<span class="go"> f64        </span>
<span class="go"></span>
<span class="go"> -12.566371 </span>
<span class="go"> -9.424778  </span>
<span class="go"> -6.283185  </span>
<span class="go"> -3.141593  </span>
<span class="go"> 0.0        </span>
<span class="go"> 3.141593   </span>
<span class="go"> 6.283185   </span>
<span class="go"> 9.424778   </span>
<span class="go"> 12.566371  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rank</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RankMethod</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'average'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">descending</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L9814-L9902"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Assign ranks to data, dealing with ties appropriately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>method</strong><span class="classifier">{average, min, max, dense, ordinal, random}</span></dt><dd><p>The method used to assign ranks to tied elements.
The following methods are available (default is average):</p>
<ul class="simple">
<li><p>average : The average of the ranks that would have been assigned to
all the tied values is assigned to each value.</p></li>
<li><p>min : The minimum of the ranks that would have been assigned to all
the tied values is assigned to each value. (This is also referred to
as competition ranking.)</p></li>
<li><p>max : The maximum of the ranks that would have been assigned to all
the tied values is assigned to each value.</p></li>
<li><p>dense : Like min, but the rank of the next highest element is
assigned the rank immediately after those assigned to the tied
elements.</p></li>
<li><p>ordinal : All values are given a distinct rank, corresponding to
the order that the values occur in the Series.</p></li>
<li><p>random : Like ordinal, but the rank for ties is not dependent
on the order that the values occur in the Series.</p></li>
</ul>
</dd>
<dt><strong>descending</strong></dt><dd><p>Rank in descending order.</p>
</dd>
<dt><strong>seed</strong></dt><dd><p>If <code class="code docutils literal notranslate"><span class="pre">method=&quot;random&quot;</span></code>, use this as seed.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>The average method:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">())</span>
<span class="go">shape: (5, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 3.0 </span>
<span class="go"> 4.5 </span>
<span class="go"> 1.5 </span>
<span class="go"> 1.5 </span>
<span class="go"> 4.5 </span>
<span class="go"></span>
</pre></div>
</div>
<p>The ordinal method:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="s2">&quot;ordinal&quot;</span><span class="p">))</span>
<span class="go">shape: (5, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> u32 </span>
<span class="go"></span>
<span class="go"> 3   </span>
<span class="go"> 4   </span>
<span class="go"> 1   </span>
<span class="go"> 2   </span>
<span class="go"> 5   </span>
<span class="go"></span>
</pre></div>
</div>
<p>Use rank with over to rank within groups:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;rank&quot;</span><span class="p">))</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> a    b    rank </span>
<span class="go"> ---  ---  ---  </span>
<span class="go"> i64  i64  f64  </span>
<span class="go"></span>
<span class="go"> 1    6    1.0  </span>
<span class="go"> 1    7    2.0  </span>
<span class="go"> 2    5    1.0  </span>
<span class="go"> 2    14   3.0  </span>
<span class="go"> 2    11   2.0  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rechunk</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1461-L1486"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create a single chunk of memory for this Series.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
</pre></div>
</div>
<p>Create a Series with 3 nulls, append column a then rechunk</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">rechunk</span><span class="p">())</span>
<span class="go">shape: (6, 1)</span>
<span class="go"></span>
<span class="go"> repeat </span>
<span class="go"> ---    </span>
<span class="go"> i64    </span>
<span class="go"></span>
<span class="go"> null   </span>
<span class="go"> null   </span>
<span class="go"> null   </span>
<span class="go"> 1      </span>
<span class="go"> 1      </span>
<span class="go"> 2      </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">register_plugin</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">lib</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">IntoExpr</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">is_elementwise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">input_wildcard_expansion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">returns_scalar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cast_to_supertypes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">pass_name_to_apply</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">changes_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Expr</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11934-L12016"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Register a plugin function.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.16: </span>Use <a class="reference internal" href="../plugins.html#polars.plugins.register_plugin_function" title="polars.plugins.register_plugin_function"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.plugins.register_plugin_function()</span></code></a> instead.</p>
</div>
<p>See the <a class="reference external" href="https://docs.pola.rs/user-guide/expressions/plugins/">user guide</a>
for more information about plugins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lib</strong></dt><dd><p>Library to load.</p>
</dd>
<dt><strong>symbol</strong></dt><dd><p>Function to load.</p>
</dd>
<dt><strong>args</strong></dt><dd><p>Arguments (other than self) passed to this function.
These arguments have to be of type Expression.</p>
</dd>
<dt><strong>kwargs</strong></dt><dd><p>Non-expression arguments. They must be JSON serializable.</p>
</dd>
<dt><strong>is_elementwise</strong></dt><dd><p>If the function only operates on scalars
this will trigger fast paths.</p>
</dd>
<dt><strong>input_wildcard_expansion</strong></dt><dd><p>Expand expressions as input of this function.</p>
</dd>
<dt><strong>returns_scalar</strong></dt><dd><p>Automatically explode on unit length if it ran as final aggregation.
this is the case for aggregations like <code class="code docutils literal notranslate"><span class="pre">sum</span></code>, <code class="code docutils literal notranslate"><span class="pre">min</span></code>, <code class="code docutils literal notranslate"><span class="pre">covariance</span></code> etc.</p>
</dd>
<dt><strong>cast_to_supertypes</strong></dt><dd><p>Cast the input datatypes to their supertype.</p>
</dd>
<dt><strong>pass_name_to_apply</strong></dt><dd><p>if set, then the <code class="code docutils literal notranslate"><span class="pre">Series</span></code> passed to the function in the group_by operation
will ensure the name is set. This is an extra heap allocation per group.</p>
</dd>
<dt><strong>changes_length</strong></dt><dd><p>For example a <code class="code docutils literal notranslate"><span class="pre">unique</span></code> or a <code class="code docutils literal notranslate"><span class="pre">slice</span></code></p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is deprecated. Use the new <code class="code docutils literal notranslate"><span class="pre">polars.plugins.register_plugin_function</span></code>
function instead.</p>
<p>This is highly unsafe as this will call the C function loaded by
<code class="code docutils literal notranslate"><span class="pre">lib::symbol</span></code>.</p>
<p>The parameters you set dictate how Polars will handle the function.
Make sure they are correct!</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">reinterpret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6330-L6363"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reinterpret the underlying bits as a signed/unsigned integer.</p>
<p>This operation is only allowed for 64bit integers. For lower bits integers,
you can safely use that cast operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>signed</strong></dt><dd><p>If True, reinterpret as <code class="code docutils literal notranslate"><span class="pre">pl.Int64</span></code>. Otherwise, reinterpret as <code class="code docutils literal notranslate"><span class="pre">pl.UInt64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">s</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reinterpret</span><span class="p">(</span><span class="n">signed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;reinterpreted&quot;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;original&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> reinterpreted  original </span>
<span class="go"> ---            ---      </span>
<span class="go"> i64            u64      </span>
<span class="go"></span>
<span class="go"> 1              1        </span>
<span class="go"> 1              1        </span>
<span class="go"> 2              2        </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">repeat_by</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6119-L6159"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Repeat the elements in this Series as specified in the given expression.</p>
<p>The repeated elements are expanded into a <code class="code docutils literal notranslate"><span class="pre">List</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>by</strong></dt><dd><p>Numeric column that determines how often the values will be repeated.
The column will be coerced to UInt32. Give this dtype to make the coercion a
no-op.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>, where the inner data type is equal
to the original data type.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">repeat_by</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a               </span>
<span class="go"> ---             </span>
<span class="go"> list[str]       </span>
<span class="go"></span>
<span class="go"> [&quot;x&quot;]           </span>
<span class="go"> [&quot;y&quot;, &quot;y&quot;]      </span>
<span class="go"> [&quot;z&quot;, &quot;z&quot;, &quot;z&quot;] </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">NoDefault</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">_NoDefault.no_default</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">NoDefault</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">_NoDefault.no_default</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">return_dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PolarsDataType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11557-L11733"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Replace values by different values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>old</strong></dt><dd><p>Value or sequence of values to replace.
Accepts expression input. Sequences are parsed as Series,
other non-expression inputs are parsed as literals.
Also accepts a mapping of values to their replacement as syntactic sugar for
<code class="code docutils literal notranslate"><span class="pre">replace(old=Series(mapping.keys()),</span> <span class="pre">new=Series(mapping.values()))</span></code>.</p>
</dd>
<dt><strong>new</strong></dt><dd><p>Value or sequence of values to replace by.
Accepts expression input. Sequences are parsed as Series,
other non-expression inputs are parsed as literals.
Length must match the length of <code class="code docutils literal notranslate"><span class="pre">old</span></code> or have length 1.</p>
</dd>
<dt><strong>default</strong></dt><dd><p>Set values that were not replaced to this value.
Defaults to keeping the original value.
Accepts expression input. Non-expression inputs are parsed as literals.</p>
</dd>
<dt><strong>return_dtype</strong></dt><dd><p>The data type of the resulting expression. If set to <code class="code docutils literal notranslate"><span class="pre">None</span></code> (default),
the data type is determined automatically based on the other inputs.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.str.replace.html#polars.Expr.str.replace" title="polars.Expr.str.replace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str.replace</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The global string cache must be enabled when replacing categorical values.</p>
<p class="rubric">Examples</p>
<p>Replace a single value by another value. Values that were not replaced remain
unchanged.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">replaced</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="go">shape: (4, 2)</span>
<span class="go"></span>
<span class="go"> a    replaced </span>
<span class="go"> ---  ---      </span>
<span class="go"> i64  i64      </span>
<span class="go"></span>
<span class="go"> 1    1        </span>
<span class="go"> 2    100      </span>
<span class="go"> 2    100      </span>
<span class="go"> 3    3        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Replace multiple values by passing sequences to the <code class="code docutils literal notranslate"><span class="pre">old</span></code> and <code class="code docutils literal notranslate"><span class="pre">new</span></code> parameters.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">replaced</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]))</span>
<span class="go">shape: (4, 2)</span>
<span class="go"></span>
<span class="go"> a    replaced </span>
<span class="go"> ---  ---      </span>
<span class="go"> i64  i64      </span>
<span class="go"></span>
<span class="go"> 1    1        </span>
<span class="go"> 2    100      </span>
<span class="go"> 2    100      </span>
<span class="go"> 3    200      </span>
<span class="go"></span>
</pre></div>
</div>
<p>Passing a mapping with replacements is also supported as syntactic sugar.
Specify a default to set all values that were not matched.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">200</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">replaced</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">mapping</span><span class="p">,</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">shape: (4, 2)</span>
<span class="go"></span>
<span class="go"> a    replaced </span>
<span class="go"> ---  ---      </span>
<span class="go"> i64  i64      </span>
<span class="go"></span>
<span class="go"> 1    -1       </span>
<span class="go"> 2    100      </span>
<span class="go"> 2    100      </span>
<span class="go"> 3    200      </span>
<span class="go"></span>
</pre></div>
</div>
<p>Replacing by values of a different data type sets the return type based on
a combination of the <code class="code docutils literal notranslate"><span class="pre">new</span></code> data type and either the original data type or the
default data type if it was set.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">replaced</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">mapping</span><span class="p">))</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a    replaced </span>
<span class="go"> ---  ---      </span>
<span class="go"> str  str      </span>
<span class="go"></span>
<span class="go"> x    1        </span>
<span class="go"> y    2        </span>
<span class="go"> z    3        </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">replaced</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">mapping</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a    replaced </span>
<span class="go"> ---  ---      </span>
<span class="go"> str  i64      </span>
<span class="go"></span>
<span class="go"> x    1        </span>
<span class="go"> y    2        </span>
<span class="go"> z    3        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Set the <code class="code docutils literal notranslate"><span class="pre">return_dtype</span></code> parameter to control the resulting data type directly.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">replaced</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">mapping</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">UInt8</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a    replaced </span>
<span class="go"> ---  ---      </span>
<span class="go"> str  u8       </span>
<span class="go"></span>
<span class="go"> x    1        </span>
<span class="go"> y    2        </span>
<span class="go"> z    3        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Expression input is supported for all parameters.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">replaced</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">old</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
<span class="gp">... </span>        <span class="n">new</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
<span class="gp">... </span>        <span class="n">default</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> a    b    replaced </span>
<span class="go"> ---  ---  ---      </span>
<span class="go"> i64  f64  f64      </span>
<span class="go"></span>
<span class="go"> 1    1.5  1.5      </span>
<span class="go"> 2    2.5  2.5      </span>
<span class="go"> 2    5.0  5.0      </span>
<span class="go"> 3    1.0  10.0     </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">reshape</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">dimensions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">nested_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../api/polars.datatypes.Array.html#polars.datatypes.Array" title="polars.datatypes.Array"><span class="pre">Array</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../api/polars.datatypes.List.html#polars.datatypes.List" title="polars.datatypes.List"><span class="pre">List</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">List</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10603-L10647"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reshape this Expr to a flat Series or a Series of Lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dimensions</strong></dt><dd><p>Tuple of the dimension sizes. If a -1 is used in any of the dimensions, that
dimension is inferred.</p>
</dd>
<dt><strong>nested_type</strong></dt><dd><p>The nested data type to create. List only supports 2 dimension,
whereas Array supports an arbitrary number of dimensions.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>If a single dimension is given, results in an expression of the original
data type.
If a multiple dimensions are given, results in an expression of data type
<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code> with shape (rows, cols)
or <code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code> with shape <code class="code docutils literal notranslate"><span class="pre">dimensions</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.list.explode.html#polars.Expr.list.explode" title="polars.Expr.list.explode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Expr.list.explode</span></code></a></dt><dd><p>Explode a list column.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> foo       </span>
<span class="go"> ---       </span>
<span class="go"> list[i64] </span>
<span class="go"></span>
<span class="go"> [1, 2, 3] </span>
<span class="go"> [4, 5, 6] </span>
<span class="go"> [7, 8, 9] </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">reverse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3325-L3358"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reverse the selection.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;fruits&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;cars&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;beetle&quot;</span><span class="p">,</span> <span class="s2">&quot;audi&quot;</span><span class="p">,</span> <span class="s2">&quot;beetle&quot;</span><span class="p">,</span> <span class="s2">&quot;beetle&quot;</span><span class="p">,</span> <span class="s2">&quot;beetle&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_reverse&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 8)</span>
<span class="go"></span>
<span class="go"> A    fruits  B    cars    A_reverse  fruits_reverse  B_reverse  cars_reverse </span>
<span class="go"> ---  ---     ---  ---     ---        ---             ---        ---          </span>
<span class="go"> i64  str     i64  str     i64        str             i64        str          </span>
<span class="go"></span>
<span class="go"> 1    banana  5    beetle  5          banana          1          beetle       </span>
<span class="go"> 2    banana  4    audi    4          apple           2          beetle       </span>
<span class="go"> 3    apple   3    beetle  3          apple           3          beetle       </span>
<span class="go"> 4    apple   2    beetle  2          banana          4          audi         </span>
<span class="go"> 5    banana  1    beetle  1          banana          5          beetle       </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4468-L4503"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compress the column data using run-length encoding.</p>
<p>Run-length encoding (RLE) encodes data by storing each <em>run</em> of identical values
as a single value and its length.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="code docutils literal notranslate"><span class="pre">Struct</span></code> with fields <code class="code docutils literal notranslate"><span class="pre">lengths</span></code> of data type <code class="code docutils literal notranslate"><span class="pre">Int32</span></code>
and <code class="code docutils literal notranslate"><span class="pre">values</span></code> of the original data type.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.rle_id.html#polars.Expr.rle_id" title="polars.Expr.rle_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rle_id</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rle</span><span class="p">())</span><span class="o">.</span><span class="n">unnest</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> lengths  values </span>
<span class="go"> ---      ---    </span>
<span class="go"> i32      i64    </span>
<span class="go"></span>
<span class="go"> 2        1      </span>
<span class="go"> 1        2      </span>
<span class="go"> 1        1      </span>
<span class="go"> 1        null   </span>
<span class="go"> 1        1      </span>
<span class="go"> 2        3      </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rle_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4505-L4551"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get a distinct integer ID for each run of identical values.</p>
<p>The ID starts at 0 and increases by one each time the value of the column
changes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="code docutils literal notranslate"><span class="pre">UInt32</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.rle.html#polars.Expr.rle" title="polars.Expr.rle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rle</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This functionality is especially useful for defining a new group for every time
a columns value changes, rather than for every distinct value of that column.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rle_id_a</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rle_id</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">rle_id_ab</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">struct</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rle_id</span><span class="p">(),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 4)</span>
<span class="go"></span>
<span class="go"> a    b     rle_id_a  rle_id_ab </span>
<span class="go"> ---  ---   ---       ---       </span>
<span class="go"> i64  str   u32       u32       </span>
<span class="go"></span>
<span class="go"> 1    x     0         0         </span>
<span class="go"> 2    x     1         1         </span>
<span class="go"> 1    null  2         2         </span>
<span class="go"> 1    y     2         3         </span>
<span class="go"> 1    y     2         3         </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">index_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">timedelta</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">check_sorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3938-L4050"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create rolling groups based on a temporal or integer column.</p>
<p>If you have a time series <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then by default the
windows created will be</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - period, t_0]</p></li>
<li><p>(t_1 - period, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - period, t_n]</p></li>
</ul>
</div></blockquote>
<p>whereas if you pass a non-default <code class="code docutils literal notranslate"><span class="pre">offset</span></code>, then the windows will be</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 + offset, t_0 + offset + period]</p></li>
<li><p>(t_1 + offset, t_1 + offset + period]</p></li>
<li><p></p></li>
<li><p>(t_n + offset, t_n + offset + period]</p></li>
</ul>
</div></blockquote>
<p>The <code class="code docutils literal notranslate"><span class="pre">period</span></code> and <code class="code docutils literal notranslate"><span class="pre">offset</span></code> arguments are created either from a timedelta, or
by using the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
<li><p>1i    (1 index count)</p></li>
</ul>
<p>Or combine them:
3d12h4m25s # 3 days, 12 hours, 4 minutes, and 25 seconds</p>
<p>By calendar day, we mean the corresponding time on the next day (which may
not be 24 hours, due to daylight savings). Similarly for calendar week,
calendar month, calendar quarter, and calendar year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>index_column</strong></dt><dd><p>Column used to group based on the time window.
Often of type Date/Datetime.
This column must be sorted in ascending order.
In case of a rolling group by on indices, dtype needs to be one of
{UInt32, UInt64, Int32, Int64}. Note that the first three get temporarily
cast to Int64, so if performance matters use an Int64 column.</p>
</dd>
<dt><strong>period</strong></dt><dd><p>Length of the window - must be non-negative.</p>
</dd>
<dt><strong>offset</strong></dt><dd><p>Offset of the window. Default is <code class="code docutils literal notranslate"><span class="pre">-period</span></code>.</p>
</dd>
<dt><strong>closed</strong><span class="classifier">{right, left, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive).</p>
</dd>
<dt><strong>check_sorted</strong></dt><dd><p>Whether to check that <code class="code docutils literal notranslate"><span class="pre">index_column</span></code> is sorted.
If you are sure the data is sorted, you can set this to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.
Doing so incorrectly will lead to incorrect output.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="s2">&quot;2020-01-01 13:45:48&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;2020-01-01 16:42:13&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;2020-01-01 16:45:09&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;2020-01-02 18:12:48&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;2020-01-03 19:45:32&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;2020-01-08 23:16:43&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Datetime</span><span class="p">)</span><span class="o">.</span><span class="n">set_sorted</span><span class="p">()</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sum_a</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">index_column</span><span class="o">=</span><span class="s2">&quot;dt&quot;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s2">&quot;2d&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">min_a</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">index_column</span><span class="o">=</span><span class="s2">&quot;dt&quot;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s2">&quot;2d&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">max_a</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">index_column</span><span class="o">=</span><span class="s2">&quot;dt&quot;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s2">&quot;2d&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 5)</span>
<span class="go"></span>
<span class="go"> dt                   a    sum_a  min_a  max_a </span>
<span class="go"> ---                  ---  ---    ---    ---   </span>
<span class="go"> datetime[s]         i64  i64    i64    i64   </span>
<span class="go"></span>
<span class="go"> 2020-01-01 13:45:48  3    3      3      3     </span>
<span class="go"> 2020-01-01 16:42:13  7    10     3      7     </span>
<span class="go"> 2020-01-01 16:45:09  5    15     3      7     </span>
<span class="go"> 2020-01-02 18:12:48  9    24     3      9     </span>
<span class="go"> 2020-01-03 19:45:32  2    11     2      9     </span>
<span class="go"> 2020-01-08 23:16:43  1    1      1      1     </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_apply</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11809-L11845"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a custom rolling window function.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.0: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.rolling_map.html#polars.Expr.rolling_map" title="polars.Expr.rolling_map"><code class="xref py py-func docutils literal notranslate"><span class="pre">Expr.rolling_map()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>function</strong></dt><dd><p>Aggregation function</p>
</dd>
<dt><strong>window_size</strong></dt><dd><p>The length of the window.</p>
</dd>
<dt><strong>weights</strong></dt><dd><p>An optional slice with the same length as the window that will be multiplied
elementwise with the values in the window.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result. If None, it will be set equal to:</p>
<ul class="simple">
<li><p>the window size, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a fixed integer</p></li>
<li><p>1, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a dynamic temporal size</p></li>
</ul>
</dd>
<dt><strong>center</strong></dt><dd><p>Set the labels at the center of the window</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_map</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L9719-L9784"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute a custom rolling window function.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>function</strong></dt><dd><p>Custom aggregation function.</p>
</dd>
<dt><strong>window_size</strong></dt><dd><p>Size of the window. The window at a given row will include the row
itself and the <code class="code docutils literal notranslate"><span class="pre">window_size</span> <span class="pre">-</span> <span class="pre">1</span></code> elements before it.</p>
</dd>
<dt><strong>weights</strong></dt><dd><p>A list of weights with the same length as the window that will be multiplied
elementwise with the values in the window.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result. If None, it will be set equal to:</p>
<ul class="simple">
<li><p>the window size, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a fixed integer</p></li>
<li><p>1, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a dynamic temporal size</p></li>
</ul>
</dd>
<dt><strong>center</strong></dt><dd><p>Set the labels at the center of the window.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Computing custom functions is extremely slow. Use specialized rolling
functions such as <a class="reference internal" href="api/polars.Expr.rolling_sum.html#polars.Expr.rolling_sum" title="polars.Expr.rolling_sum"><code class="xref py py-func docutils literal notranslate"><span class="pre">Expr.rolling_sum()</span></code></a> if at all possible.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">nansum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">11.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="mf">8.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_map</span><span class="p">(</span><span class="n">nansum</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="go">shape: (5, 1)</span>
<span class="go"></span>
<span class="go"> a    </span>
<span class="go"> ---  </span>
<span class="go"> f64  </span>
<span class="go"></span>
<span class="go"> null </span>
<span class="go"> null </span>
<span class="go"> 22.0 </span>
<span class="go"> 11.0 </span>
<span class="go"> 17.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_max</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L7994-L8250"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a rolling max (moving max) over the values in this array.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>A window of length <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> will traverse the array. The values that fill
this window will (optionally) be multiplied with the weights given by the
<code class="code docutils literal notranslate"><span class="pre">weight</span></code> vector. The resulting values will be aggregated to their max.</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">by</span></code> has not been specified (the default), the window at a given row will
include the row itself, and the <code class="code docutils literal notranslate"><span class="pre">window_size</span> <span class="pre">-</span> <span class="pre">1</span></code> elements before it.</p>
<p>If you pass a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a fixed integer size, or a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
<li><p>1i    (1 index count)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
<p>If a timedelta or the dynamic string language is used, the <code class="code docutils literal notranslate"><span class="pre">by</span></code>
and <code class="code docutils literal notranslate"><span class="pre">closed</span></code> arguments must also be set.</p>
</dd>
<dt><strong>weights</strong></dt><dd><p>An optional slice with the same length as the window that will be multiplied
elementwise with the values in the window.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result. If None, it will be set equal to:</p>
<ul class="simple">
<li><p>the window size, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a fixed integer</p></li>
<li><p>1, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a dynamic temporal size</p></li>
</ul>
</dd>
<dt><strong>center</strong></dt><dd><p>Set the labels at the center of the window</p>
</dd>
<dt><strong>by</strong></dt><dd><p>If the <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is temporal, for instance <code class="code docutils literal notranslate"><span class="pre">&quot;5h&quot;</span></code> or <code class="code docutils literal notranslate"><span class="pre">&quot;3s&quot;</span></code>, you must
set the column that will be used to determine the windows. This column must
be of dtype Datetime or Date.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.24: </span>Passing <code class="code docutils literal notranslate"><span class="pre">by</span></code> to <code class="code docutils literal notranslate"><span class="pre">rolling_max</span></code> is deprecated - please use
<a class="reference internal" href="api/polars.Expr.rolling_max_by.html#polars.Expr.rolling_max_by" title="polars.Expr.rolling_max_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rolling_max_by()</span></code></a> instead.</p>
</div>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive); only
applicable if <code class="code docutils literal notranslate"><span class="pre">by</span></code> has been set (in which case, it defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>).</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column (if passed).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_max</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_max</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_max </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  2.0         </span>
<span class="go"> 3.0  3.0         </span>
<span class="go"> 4.0  4.0         </span>
<span class="go"> 5.0  5.0         </span>
<span class="go"> 6.0  6.0         </span>
<span class="go"></span>
</pre></div>
</div>
<p>Specify weights to multiply the values in the window with:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_max</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_max</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_max </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  1.5         </span>
<span class="go"> 3.0  2.25        </span>
<span class="go"> 4.0  3.0         </span>
<span class="go"> 5.0  3.75        </span>
<span class="go"> 6.0  4.5         </span>
<span class="go"></span>
</pre></div>
</div>
<p>Center the values in the window</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_max</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_max</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_max </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  3.0         </span>
<span class="go"> 3.0  4.0         </span>
<span class="go"> 4.0  5.0         </span>
<span class="go"> 5.0  6.0         </span>
<span class="go"> 6.0  null        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling max with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_max</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_max</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_max </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         u32             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0               </span>
<span class="go"> 1      2001-01-01 01:00:00  1               </span>
<span class="go"> 2      2001-01-01 02:00:00  2               </span>
<span class="go"> 3      2001-01-01 03:00:00  3               </span>
<span class="go"> 4      2001-01-01 04:00:00  4               </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  20              </span>
<span class="go"> 21     2001-01-01 21:00:00  21              </span>
<span class="go"> 22     2001-01-01 22:00:00  22              </span>
<span class="go"> 23     2001-01-01 23:00:00  23              </span>
<span class="go"> 24     2001-01-02 00:00:00  24              </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling max with the closure of windows on both sides</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_max</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_max</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_max </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         u32             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0               </span>
<span class="go"> 1      2001-01-01 01:00:00  1               </span>
<span class="go"> 2      2001-01-01 02:00:00  2               </span>
<span class="go"> 3      2001-01-01 03:00:00  3               </span>
<span class="go"> 4      2001-01-01 04:00:00  4               </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  20              </span>
<span class="go"> 21     2001-01-01 21:00:00  21              </span>
<span class="go"> 22     2001-01-01 22:00:00  22              </span>
<span class="go"> 23     2001-01-01 23:00:00  23              </span>
<span class="go"> 24     2001-01-02 00:00:00  24              </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_max_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6645-L6804"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a rolling max based on another column.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>Given a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>by</strong></dt><dd><p>This column must be of dtype Datetime or Date.</p>
</dd>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result.</p>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive),
defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>.</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.27: </span>This operation no longer requires sorted data, you can safely remove
the <code class="code docutils literal notranslate"><span class="pre">warn_if_unsorted</span></code> argument.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling max with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_max</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_max_by</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_max </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         u32             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0               </span>
<span class="go"> 1      2001-01-01 01:00:00  1               </span>
<span class="go"> 2      2001-01-01 02:00:00  2               </span>
<span class="go"> 3      2001-01-01 03:00:00  3               </span>
<span class="go"> 4      2001-01-01 04:00:00  4               </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  20              </span>
<span class="go"> 21     2001-01-01 21:00:00  21              </span>
<span class="go"> 22     2001-01-01 22:00:00  22              </span>
<span class="go"> 23     2001-01-01 23:00:00  23              </span>
<span class="go"> 24     2001-01-02 00:00:00  24              </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling max with the closure of windows on both sides</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_max</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_max_by</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_max </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         u32             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0               </span>
<span class="go"> 1      2001-01-01 01:00:00  1               </span>
<span class="go"> 2      2001-01-01 02:00:00  2               </span>
<span class="go"> 3      2001-01-01 03:00:00  3               </span>
<span class="go"> 4      2001-01-01 04:00:00  4               </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  20              </span>
<span class="go"> 21     2001-01-01 21:00:00  21              </span>
<span class="go"> 22     2001-01-01 22:00:00  22              </span>
<span class="go"> 23     2001-01-01 23:00:00  23              </span>
<span class="go"> 24     2001-01-02 00:00:00  24              </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_mean</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L8252-L8510"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a rolling mean (moving mean) over the values in this array.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>A window of length <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> will traverse the array. The values that fill
this window will (optionally) be multiplied with the weights given by the
<code class="code docutils literal notranslate"><span class="pre">weight</span></code> vector. The resulting values will be aggregated to their mean.</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">by</span></code> has not been specified (the default), the window at a given row will
include the row itself, and the <code class="code docutils literal notranslate"><span class="pre">window_size</span> <span class="pre">-</span> <span class="pre">1</span></code> elements before it.</p>
<p>If you pass a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a fixed integer size, or a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
<li><p>1i    (1 index count)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
<p>If a timedelta or the dynamic string language is used, the <code class="code docutils literal notranslate"><span class="pre">by</span></code>
and <code class="code docutils literal notranslate"><span class="pre">closed</span></code> arguments must also be set.</p>
</dd>
<dt><strong>weights</strong></dt><dd><p>An optional slice with the same length as the window that will be multiplied
elementwise with the values in the window.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result. If None, it will be set equal to:</p>
<ul class="simple">
<li><p>the window size, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a fixed integer</p></li>
<li><p>1, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a dynamic temporal size</p></li>
</ul>
</dd>
<dt><strong>center</strong></dt><dd><p>Set the labels at the center of the window</p>
</dd>
<dt><strong>by</strong></dt><dd><p>If the <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is temporal for instance <code class="code docutils literal notranslate"><span class="pre">&quot;5h&quot;</span></code> or <code class="code docutils literal notranslate"><span class="pre">&quot;3s&quot;</span></code>, you must
set the column that will be used to determine the windows. This column must
be of dtype Datetime or Date.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.24: </span>Passing <code class="code docutils literal notranslate"><span class="pre">by</span></code> to <code class="code docutils literal notranslate"><span class="pre">rolling_mean</span></code> is deprecated - please use
<a class="reference internal" href="api/polars.Expr.rolling_mean_by.html#polars.Expr.rolling_mean_by" title="polars.Expr.rolling_mean_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rolling_mean_by()</span></code></a> instead.</p>
</div>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive); only
applicable if <code class="code docutils literal notranslate"><span class="pre">by</span></code> has been set (in which case, it defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>).</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column (if passed).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_mean</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_mean</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_mean </span>
<span class="go"> ---  ---          </span>
<span class="go"> f64  f64          </span>
<span class="go"></span>
<span class="go"> 1.0  null         </span>
<span class="go"> 2.0  1.5          </span>
<span class="go"> 3.0  2.5          </span>
<span class="go"> 4.0  3.5          </span>
<span class="go"> 5.0  4.5          </span>
<span class="go"> 6.0  5.5          </span>
<span class="go"></span>
</pre></div>
</div>
<p>Specify weights to multiply the values in the window with:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_mean</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_mean</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_mean </span>
<span class="go"> ---  ---          </span>
<span class="go"> f64  f64          </span>
<span class="go"></span>
<span class="go"> 1.0  null         </span>
<span class="go"> 2.0  1.75         </span>
<span class="go"> 3.0  2.75         </span>
<span class="go"> 4.0  3.75         </span>
<span class="go"> 5.0  4.75         </span>
<span class="go"> 6.0  5.75         </span>
<span class="go"></span>
</pre></div>
</div>
<p>Center the values in the window</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_mean</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_mean</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_mean </span>
<span class="go"> ---  ---          </span>
<span class="go"> f64  f64          </span>
<span class="go"></span>
<span class="go"> 1.0  null         </span>
<span class="go"> 2.0  2.0          </span>
<span class="go"> 3.0  3.0          </span>
<span class="go"> 4.0  4.0          </span>
<span class="go"> 5.0  5.0          </span>
<span class="go"> 6.0  null         </span>
<span class="go"></span>
</pre></div>
</div>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling mean with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_mean</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_mean</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_mean </span>
<span class="go"> ---    ---                  ---              </span>
<span class="go"> u32    datetime[s]         f64              </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0.0              </span>
<span class="go"> 1      2001-01-01 01:00:00  0.5              </span>
<span class="go"> 2      2001-01-01 02:00:00  1.5              </span>
<span class="go"> 3      2001-01-01 03:00:00  2.5              </span>
<span class="go"> 4      2001-01-01 04:00:00  3.5              </span>
<span class="go">                                           </span>
<span class="go"> 20     2001-01-01 20:00:00  19.5             </span>
<span class="go"> 21     2001-01-01 21:00:00  20.5             </span>
<span class="go"> 22     2001-01-01 22:00:00  21.5             </span>
<span class="go"> 23     2001-01-01 23:00:00  22.5             </span>
<span class="go"> 24     2001-01-02 00:00:00  23.5             </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling mean with the closure of windows on both sides</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_mean</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_mean</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_mean </span>
<span class="go"> ---    ---                  ---              </span>
<span class="go"> u32    datetime[s]         f64              </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0.0              </span>
<span class="go"> 1      2001-01-01 01:00:00  0.5              </span>
<span class="go"> 2      2001-01-01 02:00:00  1.0              </span>
<span class="go"> 3      2001-01-01 03:00:00  2.0              </span>
<span class="go"> 4      2001-01-01 04:00:00  3.0              </span>
<span class="go">                                           </span>
<span class="go"> 20     2001-01-01 20:00:00  19.0             </span>
<span class="go"> 21     2001-01-01 21:00:00  20.0             </span>
<span class="go"> 22     2001-01-01 22:00:00  21.0             </span>
<span class="go"> 23     2001-01-01 23:00:00  22.0             </span>
<span class="go"> 24     2001-01-02 00:00:00  23.0             </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_mean_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6806-L6972"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a rolling mean based on another column.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>Given a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>by</strong></dt><dd><p>This column must be of dtype Datetime or Date.</p>
</dd>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result.</p>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive),
defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>.</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.27: </span>This operation no longer requires sorted data, you can safely remove
the <code class="code docutils literal notranslate"><span class="pre">warn_if_unsorted</span></code> argument.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling mean with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_mean</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_mean_by</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_mean </span>
<span class="go"> ---    ---                  ---              </span>
<span class="go"> u32    datetime[s]         f64              </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0.0              </span>
<span class="go"> 1      2001-01-01 01:00:00  0.5              </span>
<span class="go"> 2      2001-01-01 02:00:00  1.5              </span>
<span class="go"> 3      2001-01-01 03:00:00  2.5              </span>
<span class="go"> 4      2001-01-01 04:00:00  3.5              </span>
<span class="go">                                           </span>
<span class="go"> 20     2001-01-01 20:00:00  19.5             </span>
<span class="go"> 21     2001-01-01 21:00:00  20.5             </span>
<span class="go"> 22     2001-01-01 22:00:00  21.5             </span>
<span class="go"> 23     2001-01-01 23:00:00  22.5             </span>
<span class="go"> 24     2001-01-02 00:00:00  23.5             </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling mean with the closure of windows on both sides</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_mean</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_mean_by</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_mean </span>
<span class="go"> ---    ---                  ---              </span>
<span class="go"> u32    datetime[s]         f64              </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0.0              </span>
<span class="go"> 1      2001-01-01 01:00:00  0.5              </span>
<span class="go"> 2      2001-01-01 02:00:00  1.0              </span>
<span class="go"> 3      2001-01-01 03:00:00  2.0              </span>
<span class="go"> 4      2001-01-01 04:00:00  3.0              </span>
<span class="go">                                           </span>
<span class="go"> 20     2001-01-01 20:00:00  19.0             </span>
<span class="go"> 21     2001-01-01 21:00:00  20.0             </span>
<span class="go"> 22     2001-01-01 22:00:00  21.0             </span>
<span class="go"> 23     2001-01-01 23:00:00  22.0             </span>
<span class="go"> 24     2001-01-02 00:00:00  23.0             </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_median</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L9288-L9462"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute a rolling median.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>If <code class="code docutils literal notranslate"><span class="pre">by</span></code> has not been specified (the default), the window at a given row will
include the row itself, and the <code class="code docutils literal notranslate"><span class="pre">window_size</span> <span class="pre">-</span> <span class="pre">1</span></code> elements before it.</p>
<p>If you pass a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a fixed integer size, or a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
<li><p>1i    (1 index count)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
<p>If a timedelta or the dynamic string language is used, the <code class="code docutils literal notranslate"><span class="pre">by</span></code>
and <code class="code docutils literal notranslate"><span class="pre">closed</span></code> arguments must also be set.</p>
</dd>
<dt><strong>weights</strong></dt><dd><p>An optional slice with the same length as the window that determines the
relative contribution of each value in a window to the output.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result. If None, it will be set equal to:</p>
<ul class="simple">
<li><p>the window size, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a fixed integer</p></li>
<li><p>1, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a dynamic temporal size</p></li>
</ul>
</dd>
<dt><strong>center</strong></dt><dd><p>Set the labels at the center of the window</p>
</dd>
<dt><strong>by</strong></dt><dd><p>If the <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is temporal for instance <code class="code docutils literal notranslate"><span class="pre">&quot;5h&quot;</span></code> or <code class="code docutils literal notranslate"><span class="pre">&quot;3s&quot;</span></code>, you must
set the column that will be used to determine the windows. This column must
be of dtype Datetime or Date.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.24: </span>Passing <code class="code docutils literal notranslate"><span class="pre">by</span></code> to <code class="code docutils literal notranslate"><span class="pre">rolling_median</span></code> is deprecated - please use
<a class="reference internal" href="api/polars.Expr.rolling_median_by.html#polars.Expr.rolling_median_by" title="polars.Expr.rolling_median_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rolling_median_by()</span></code></a> instead.</p>
</div>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive); only
applicable if <code class="code docutils literal notranslate"><span class="pre">by</span></code> has been set (in which case, it defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>).</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column (if passed).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_median</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_median</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_median </span>
<span class="go"> ---  ---            </span>
<span class="go"> f64  f64            </span>
<span class="go"></span>
<span class="go"> 1.0  null           </span>
<span class="go"> 2.0  1.5            </span>
<span class="go"> 3.0  2.5            </span>
<span class="go"> 4.0  3.5            </span>
<span class="go"> 5.0  4.5            </span>
<span class="go"> 6.0  5.5            </span>
<span class="go"></span>
</pre></div>
</div>
<p>Specify weights for the values in each window:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_median</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_median</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_median </span>
<span class="go"> ---  ---            </span>
<span class="go"> f64  f64            </span>
<span class="go"></span>
<span class="go"> 1.0  null           </span>
<span class="go"> 2.0  1.5            </span>
<span class="go"> 3.0  2.5            </span>
<span class="go"> 4.0  3.5            </span>
<span class="go"> 5.0  4.5            </span>
<span class="go"> 6.0  5.5            </span>
<span class="go"></span>
</pre></div>
</div>
<p>Center the values in the window</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_median</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_median</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_median </span>
<span class="go"> ---  ---            </span>
<span class="go"> f64  f64            </span>
<span class="go"></span>
<span class="go"> 1.0  null           </span>
<span class="go"> 2.0  2.0            </span>
<span class="go"> 3.0  3.0            </span>
<span class="go"> 4.0  4.0            </span>
<span class="go"> 5.0  5.0            </span>
<span class="go"> 6.0  null           </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_median_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L7475-L7610"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute a rolling median based on another column.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>Given a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>by</strong></dt><dd><p>This column must be of dtype Datetime or Date.</p>
</dd>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result.</p>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive),
defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>.</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.27: </span>This operation no longer requires sorted data, you can safely remove
the <code class="code docutils literal notranslate"><span class="pre">warn_if_unsorted</span></code> argument.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling median with the temporal windows closed on the right:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_median</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_median_by</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_median </span>
<span class="go"> ---    ---                  ---                </span>
<span class="go"> u32    datetime[s]         f64                </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0.0                </span>
<span class="go"> 1      2001-01-01 01:00:00  0.5                </span>
<span class="go"> 2      2001-01-01 02:00:00  1.5                </span>
<span class="go"> 3      2001-01-01 03:00:00  2.5                </span>
<span class="go"> 4      2001-01-01 04:00:00  3.5                </span>
<span class="go">                                             </span>
<span class="go"> 20     2001-01-01 20:00:00  19.5               </span>
<span class="go"> 21     2001-01-01 21:00:00  20.5               </span>
<span class="go"> 22     2001-01-01 22:00:00  21.5               </span>
<span class="go"> 23     2001-01-01 23:00:00  22.5               </span>
<span class="go"> 24     2001-01-02 00:00:00  23.5               </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_min</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L7762-L7992"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a rolling min (moving min) over the values in this array.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>A window of length <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> will traverse the array. The values that fill
this window will (optionally) be multiplied with the weights given by the
<code class="code docutils literal notranslate"><span class="pre">weight</span></code> vector. The resulting values will be aggregated to their min.</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">by</span></code> has not been specified (the default), the window at a given row will
include the row itself, and the <code class="code docutils literal notranslate"><span class="pre">window_size</span> <span class="pre">-</span> <span class="pre">1</span></code> elements before it.</p>
<p>If you pass a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a fixed integer size, or a dynamic
temporal size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
<li><p>1i    (1 index count)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
<p>If a timedelta or the dynamic string language is used, the <code class="code docutils literal notranslate"><span class="pre">by</span></code>
and <code class="code docutils literal notranslate"><span class="pre">closed</span></code> arguments must also be set.</p>
</dd>
<dt><strong>weights</strong></dt><dd><p>An optional slice with the same length as the window that will be multiplied
elementwise with the values in the window.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result. If None, it will be set equal to:</p>
<ul class="simple">
<li><p>the window size, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a fixed integer</p></li>
<li><p>1, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a dynamic temporal size</p></li>
</ul>
</dd>
<dt><strong>center</strong></dt><dd><p>Set the labels at the center of the window</p>
</dd>
<dt><strong>by</strong></dt><dd><p>If the <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is temporal for instance <code class="code docutils literal notranslate"><span class="pre">&quot;5h&quot;</span></code> or <code class="code docutils literal notranslate"><span class="pre">&quot;3s&quot;</span></code>, you must
set the column that will be used to determine the windows. This column must
be of dtype Datetime or Date.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.24: </span>Passing <code class="code docutils literal notranslate"><span class="pre">by</span></code> to <code class="code docutils literal notranslate"><span class="pre">rolling_min</span></code> is deprecated - please use
<a class="reference internal" href="api/polars.Expr.rolling_min_by.html#polars.Expr.rolling_min_by" title="polars.Expr.rolling_min_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rolling_min_by()</span></code></a> instead.</p>
</div>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive); only
applicable if <code class="code docutils literal notranslate"><span class="pre">by</span></code> has been set (in which case, it defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>).</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column (if passed).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_min</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_min</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_min </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  1.0         </span>
<span class="go"> 3.0  2.0         </span>
<span class="go"> 4.0  3.0         </span>
<span class="go"> 5.0  4.0         </span>
<span class="go"> 6.0  5.0         </span>
<span class="go"></span>
</pre></div>
</div>
<p>Specify weights to multiply the values in the window with:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_min</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_min</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_min </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  0.25        </span>
<span class="go"> 3.0  0.5         </span>
<span class="go"> 4.0  0.75        </span>
<span class="go"> 5.0  1.0         </span>
<span class="go"> 6.0  1.25        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Center the values in the window</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_min</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_min</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_min </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  1.0         </span>
<span class="go"> 3.0  2.0         </span>
<span class="go"> 4.0  3.0         </span>
<span class="go"> 5.0  4.0         </span>
<span class="go"> 6.0  null        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling min with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_min</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_min</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_min </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         u32             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0               </span>
<span class="go"> 1      2001-01-01 01:00:00  0               </span>
<span class="go"> 2      2001-01-01 02:00:00  1               </span>
<span class="go"> 3      2001-01-01 03:00:00  2               </span>
<span class="go"> 4      2001-01-01 04:00:00  3               </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  19              </span>
<span class="go"> 21     2001-01-01 21:00:00  20              </span>
<span class="go"> 22     2001-01-01 22:00:00  21              </span>
<span class="go"> 23     2001-01-01 23:00:00  22              </span>
<span class="go"> 24     2001-01-02 00:00:00  23              </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_min_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6510-L6643"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a rolling min based on another column.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>Given a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>by</strong></dt><dd><p>This column must be of dtype Datetime or Date.</p>
</dd>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result.</p>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive),
defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>.</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.27: </span>This operation no longer requires sorted data, you can safely remove
the <code class="code docutils literal notranslate"><span class="pre">warn_if_unsorted</span></code> argument.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling min with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_min</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_min_by</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_min </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         u32             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0               </span>
<span class="go"> 1      2001-01-01 01:00:00  0               </span>
<span class="go"> 2      2001-01-01 02:00:00  1               </span>
<span class="go"> 3      2001-01-01 03:00:00  2               </span>
<span class="go"> 4      2001-01-01 04:00:00  3               </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  19              </span>
<span class="go"> 21     2001-01-01 21:00:00  20              </span>
<span class="go"> 22     2001-01-01 22:00:00  21              </span>
<span class="go"> 23     2001-01-01 23:00:00  22              </span>
<span class="go"> 24     2001-01-02 00:00:00  23              </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_quantile</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RollingInterpolationMethod</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nearest'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L9464-L9675"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute a rolling quantile.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>If <code class="code docutils literal notranslate"><span class="pre">by</span></code> has not been specified (the default), the window at a given row will
include the row itself, and the <code class="code docutils literal notranslate"><span class="pre">window_size</span> <span class="pre">-</span> <span class="pre">1</span></code> elements before it.</p>
<p>If you pass a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>quantile</strong></dt><dd><p>Quantile between 0.0 and 1.0.</p>
</dd>
<dt><strong>interpolation</strong><span class="classifier">{nearest, higher, lower, midpoint, linear}</span></dt><dd><p>Interpolation method.</p>
</dd>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a fixed integer size, or a dynamic
temporal size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
<li><p>1i    (1 index count)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
<p>If a timedelta or the dynamic string language is used, the <code class="code docutils literal notranslate"><span class="pre">by</span></code>
and <code class="code docutils literal notranslate"><span class="pre">closed</span></code> arguments must also be set.</p>
</dd>
<dt><strong>weights</strong></dt><dd><p>An optional slice with the same length as the window that determines the
relative contribution of each value in a window to the output.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result. If None, it will be set equal to:</p>
<ul class="simple">
<li><p>the window size, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a fixed integer</p></li>
<li><p>1, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a dynamic temporal size</p></li>
</ul>
</dd>
<dt><strong>center</strong></dt><dd><p>Set the labels at the center of the window</p>
</dd>
<dt><strong>by</strong></dt><dd><p>If the <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is temporal for instance <code class="code docutils literal notranslate"><span class="pre">&quot;5h&quot;</span></code> or <code class="code docutils literal notranslate"><span class="pre">&quot;3s&quot;</span></code>, you must
set the column that will be used to determine the windows. This column must
be of dtype Datetime or Date.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.24: </span>Passing <code class="code docutils literal notranslate"><span class="pre">by</span></code> to <code class="code docutils literal notranslate"><span class="pre">rolling_quantile</span></code> is deprecated - please use
<a class="reference internal" href="api/polars.Expr.rolling_quantile_by.html#polars.Expr.rolling_quantile_by" title="polars.Expr.rolling_quantile_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rolling_quantile_by()</span></code></a> instead.</p>
</div>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive); only
applicable if <code class="code docutils literal notranslate"><span class="pre">by</span></code> has been set (in which case, it defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>).</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column (if passed).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_quantile</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_quantile</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">quantile</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">4</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_quantile </span>
<span class="go"> ---  ---              </span>
<span class="go"> f64  f64              </span>
<span class="go"></span>
<span class="go"> 1.0  null             </span>
<span class="go"> 2.0  null             </span>
<span class="go"> 3.0  null             </span>
<span class="go"> 4.0  2.0              </span>
<span class="go"> 5.0  3.0              </span>
<span class="go"> 6.0  4.0              </span>
<span class="go"></span>
</pre></div>
</div>
<p>Specify weights for the values in each window:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_quantile</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_quantile</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">quantile</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_quantile </span>
<span class="go"> ---  ---              </span>
<span class="go"> f64  f64              </span>
<span class="go"></span>
<span class="go"> 1.0  null             </span>
<span class="go"> 2.0  null             </span>
<span class="go"> 3.0  null             </span>
<span class="go"> 4.0  2.0              </span>
<span class="go"> 5.0  3.0              </span>
<span class="go"> 6.0  4.0              </span>
<span class="go"></span>
</pre></div>
</div>
<p>Specify weights and interpolation method</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_quantile</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_quantile</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">quantile</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_quantile </span>
<span class="go"> ---  ---              </span>
<span class="go"> f64  f64              </span>
<span class="go"></span>
<span class="go"> 1.0  null             </span>
<span class="go"> 2.0  null             </span>
<span class="go"> 3.0  null             </span>
<span class="go"> 4.0  1.625            </span>
<span class="go"> 5.0  2.625            </span>
<span class="go"> 6.0  3.625            </span>
<span class="go"></span>
</pre></div>
</div>
<p>Center the values in the window</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_quantile</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_quantile</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">quantile</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_quantile </span>
<span class="go"> ---  ---              </span>
<span class="go"> f64  f64              </span>
<span class="go"></span>
<span class="go"> 1.0  null             </span>
<span class="go"> 2.0  null             </span>
<span class="go"> 3.0  2.0              </span>
<span class="go"> 4.0  3.0              </span>
<span class="go"> 5.0  null             </span>
<span class="go"> 6.0  null             </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_quantile_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RollingInterpolationMethod</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nearest'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L7612-L7760"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute a rolling quantile based on another column.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>Given a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>by</strong></dt><dd><p>This column must be of dtype Datetime or Date.</p>
</dd>
<dt><strong>quantile</strong></dt><dd><p>Quantile between 0.0 and 1.0.</p>
</dd>
<dt><strong>interpolation</strong><span class="classifier">{nearest, higher, lower, midpoint, linear}</span></dt><dd><p>Interpolation method.</p>
</dd>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a dynamic
temporal size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result.</p>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive),
defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>.</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.27: </span>This operation no longer requires sorted data, you can safely remove
the <code class="code docutils literal notranslate"><span class="pre">warn_if_unsorted</span></code> argument.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling quantile with the temporal windows closed on the right:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_quantile</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_quantile_by</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">quantile</span><span class="o">=</span><span class="mf">0.3</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_quantile </span>
<span class="go"> ---    ---                  ---                  </span>
<span class="go"> u32    datetime[s]         f64                  </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0.0                  </span>
<span class="go"> 1      2001-01-01 01:00:00  0.0                  </span>
<span class="go"> 2      2001-01-01 02:00:00  1.0                  </span>
<span class="go"> 3      2001-01-01 03:00:00  2.0                  </span>
<span class="go"> 4      2001-01-01 04:00:00  3.0                  </span>
<span class="go">                                               </span>
<span class="go"> 20     2001-01-01 20:00:00  19.0                 </span>
<span class="go"> 21     2001-01-01 21:00:00  20.0                 </span>
<span class="go"> 22     2001-01-01 22:00:00  21.0                 </span>
<span class="go"> 23     2001-01-01 23:00:00  22.0                 </span>
<span class="go"> 24     2001-01-02 00:00:00  23.0                 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_skew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L9677-L9717"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute a rolling skew.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>The window at a given row includes the row itself and the
<code class="code docutils literal notranslate"><span class="pre">window_size</span> <span class="pre">-</span> <span class="pre">1</span></code> elements before it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>window_size</strong></dt><dd><p>Integer size of the rolling window.</p>
</dd>
<dt><strong>bias</strong></dt><dd><p>If False, the calculations are corrected for statistical bias.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_skew</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> null     </span>
<span class="go"> null     </span>
<span class="go"> 0.381802 </span>
<span class="go"> 0.47033  </span>
<span class="go"></span>
</pre></div>
</div>
<p>Note how the values match the following:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">skew</span><span class="p">(),</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>
<span class="go">(0.38180177416060584, 0.47033046033698594)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_std</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ddof</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L8770-L9027"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute a rolling standard deviation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>If <code class="code docutils literal notranslate"><span class="pre">by</span></code> has not been specified (the default), the window at a given row will
include the row itself, and the <code class="code docutils literal notranslate"><span class="pre">window_size</span> <span class="pre">-</span> <span class="pre">1</span></code> elements before it.</p>
<p>If you pass a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a fixed integer size, or a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
<li><p>1i    (1 index count)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
<p>If a timedelta or the dynamic string language is used, the <code class="code docutils literal notranslate"><span class="pre">by</span></code>
and <code class="code docutils literal notranslate"><span class="pre">closed</span></code> arguments must also be set.</p>
</dd>
<dt><strong>weights</strong></dt><dd><p>An optional slice with the same length as the window that determines the
relative contribution of each value in a window to the output.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result. If None, it will be set equal to:</p>
<ul class="simple">
<li><p>the window size, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a fixed integer</p></li>
<li><p>1, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a dynamic temporal size</p></li>
</ul>
</dd>
<dt><strong>center</strong></dt><dd><p>Set the labels at the center of the window</p>
</dd>
<dt><strong>by</strong></dt><dd><p>If the <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is temporal for instance <code class="code docutils literal notranslate"><span class="pre">&quot;5h&quot;</span></code> or <code class="code docutils literal notranslate"><span class="pre">&quot;3s&quot;</span></code>, you must
set the column that will be used to determine the windows. This column must
be of dtype Datetime or Date.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.24: </span>Passing <code class="code docutils literal notranslate"><span class="pre">by</span></code> to <code class="code docutils literal notranslate"><span class="pre">rolling_std</span></code> is deprecated - please use
<a class="reference internal" href="api/polars.Expr.rolling_std_by.html#polars.Expr.rolling_std_by" title="polars.Expr.rolling_std_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rolling_std_by()</span></code></a> instead.</p>
</div>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive); only
applicable if <code class="code docutils literal notranslate"><span class="pre">by</span></code> has been set (in which case, it defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>).</p>
</dd>
<dt><strong>ddof</strong></dt><dd><p>Delta Degrees of Freedom: The divisor for a length N window is N - ddof</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column (if passed).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_std</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_std</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_std </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  0.707107    </span>
<span class="go"> 3.0  0.707107    </span>
<span class="go"> 4.0  0.707107    </span>
<span class="go"> 5.0  0.707107    </span>
<span class="go"> 6.0  0.707107    </span>
<span class="go"></span>
</pre></div>
</div>
<p>Specify weights to multiply the values in the window with:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_std</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_std</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_std </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  0.433013    </span>
<span class="go"> 3.0  0.433013    </span>
<span class="go"> 4.0  0.433013    </span>
<span class="go"> 5.0  0.433013    </span>
<span class="go"> 6.0  0.433013    </span>
<span class="go"></span>
</pre></div>
</div>
<p>Center the values in the window</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_std</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_std</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_std </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  1.0         </span>
<span class="go"> 3.0  1.0         </span>
<span class="go"> 4.0  1.0         </span>
<span class="go"> 5.0  1.0         </span>
<span class="go"> 6.0  null        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling std with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_std</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_std</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_std </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         f64             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  null            </span>
<span class="go"> 1      2001-01-01 01:00:00  0.707107        </span>
<span class="go"> 2      2001-01-01 02:00:00  0.707107        </span>
<span class="go"> 3      2001-01-01 03:00:00  0.707107        </span>
<span class="go"> 4      2001-01-01 04:00:00  0.707107        </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  0.707107        </span>
<span class="go"> 21     2001-01-01 21:00:00  0.707107        </span>
<span class="go"> 22     2001-01-01 22:00:00  0.707107        </span>
<span class="go"> 23     2001-01-01 23:00:00  0.707107        </span>
<span class="go"> 24     2001-01-02 00:00:00  0.707107        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling std with the closure of windows on both sides</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_std</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_std</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_std </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         f64             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  null            </span>
<span class="go"> 1      2001-01-01 01:00:00  0.707107        </span>
<span class="go"> 2      2001-01-01 02:00:00  1.0             </span>
<span class="go"> 3      2001-01-01 03:00:00  1.0             </span>
<span class="go"> 4      2001-01-01 04:00:00  1.0             </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  1.0             </span>
<span class="go"> 21     2001-01-01 21:00:00  1.0             </span>
<span class="go"> 22     2001-01-01 22:00:00  1.0             </span>
<span class="go"> 23     2001-01-01 23:00:00  1.0             </span>
<span class="go"> 24     2001-01-02 00:00:00  1.0             </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_std_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ddof</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L7135-L7303"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute a rolling standard deviation based on another column.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>Given a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>by</strong></dt><dd><p>This column must be of dtype Datetime or Date.</p>
</dd>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result.</p>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive),
defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>.</p>
</dd>
<dt><strong>ddof</strong></dt><dd><p>Delta Degrees of Freedom: The divisor for a length N window is N - ddof</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.27: </span>This operation no longer requires sorted data, you can safely remove
the <code class="code docutils literal notranslate"><span class="pre">warn_if_unsorted</span></code> argument.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling std with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_std</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_std_by</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_std </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         f64             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  null            </span>
<span class="go"> 1      2001-01-01 01:00:00  0.707107        </span>
<span class="go"> 2      2001-01-01 02:00:00  0.707107        </span>
<span class="go"> 3      2001-01-01 03:00:00  0.707107        </span>
<span class="go"> 4      2001-01-01 04:00:00  0.707107        </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  0.707107        </span>
<span class="go"> 21     2001-01-01 21:00:00  0.707107        </span>
<span class="go"> 22     2001-01-01 22:00:00  0.707107        </span>
<span class="go"> 23     2001-01-01 23:00:00  0.707107        </span>
<span class="go"> 24     2001-01-02 00:00:00  0.707107        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling std with the closure of windows on both sides</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_std</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_std_by</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_std </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         f64             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  null            </span>
<span class="go"> 1      2001-01-01 01:00:00  0.707107        </span>
<span class="go"> 2      2001-01-01 02:00:00  1.0             </span>
<span class="go"> 3      2001-01-01 03:00:00  1.0             </span>
<span class="go"> 4      2001-01-01 04:00:00  1.0             </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  1.0             </span>
<span class="go"> 21     2001-01-01 21:00:00  1.0             </span>
<span class="go"> 22     2001-01-01 22:00:00  1.0             </span>
<span class="go"> 23     2001-01-01 23:00:00  1.0             </span>
<span class="go"> 24     2001-01-02 00:00:00  1.0             </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_sum</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L8512-L8768"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a rolling sum (moving sum) over the values in this array.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>A window of length <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> will traverse the array. The values that fill
this window will (optionally) be multiplied with the weights given by the
<code class="code docutils literal notranslate"><span class="pre">weight</span></code> vector. The resulting values will be aggregated to their sum.</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">by</span></code> has not been specified (the default), the window at a given row will
include the row itself, and the <code class="code docutils literal notranslate"><span class="pre">window_size</span> <span class="pre">-</span> <span class="pre">1</span></code> elements before it.</p>
<p>If you pass a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a fixed integer size, or a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
<li><p>1i    (1 index count)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
<p>If a timedelta or the dynamic string language is used, the <code class="code docutils literal notranslate"><span class="pre">by</span></code>
and <code class="code docutils literal notranslate"><span class="pre">closed</span></code> arguments must also be set.</p>
</dd>
<dt><strong>weights</strong></dt><dd><p>An optional slice with the same length as the window that will be multiplied
elementwise with the values in the window.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result. If None, it will be set equal to:</p>
<ul class="simple">
<li><p>the window size, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a fixed integer</p></li>
<li><p>1, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a dynamic temporal size</p></li>
</ul>
</dd>
<dt><strong>center</strong></dt><dd><p>Set the labels at the center of the window</p>
</dd>
<dt><strong>by</strong></dt><dd><p>If the <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is temporal for instance <code class="code docutils literal notranslate"><span class="pre">&quot;5h&quot;</span></code> or <code class="code docutils literal notranslate"><span class="pre">&quot;3s&quot;</span></code>, you must
set the column that will be used to determine the windows. This column must
of dtype <code class="code docutils literal notranslate"><span class="pre">{Date,</span> <span class="pre">Datetime}</span></code></p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.24: </span>Passing <code class="code docutils literal notranslate"><span class="pre">by</span></code> to <code class="code docutils literal notranslate"><span class="pre">rolling_sum</span></code> is deprecated - please use
<a class="reference internal" href="api/polars.Expr.rolling_sum_by.html#polars.Expr.rolling_sum_by" title="polars.Expr.rolling_sum_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rolling_sum_by()</span></code></a> instead.</p>
</div>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive); only
applicable if <code class="code docutils literal notranslate"><span class="pre">by</span></code> has been set (in which case, it defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>).</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column (if passed).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_sum</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_sum</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_sum </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  3.0         </span>
<span class="go"> 3.0  5.0         </span>
<span class="go"> 4.0  7.0         </span>
<span class="go"> 5.0  9.0         </span>
<span class="go"> 6.0  11.0        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Specify weights to multiply the values in the window with:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_sum</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_sum</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_sum </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  1.75        </span>
<span class="go"> 3.0  2.75        </span>
<span class="go"> 4.0  3.75        </span>
<span class="go"> 5.0  4.75        </span>
<span class="go"> 6.0  5.75        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Center the values in the window</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_sum</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_sum</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_sum </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  6.0         </span>
<span class="go"> 3.0  9.0         </span>
<span class="go"> 4.0  12.0        </span>
<span class="go"> 5.0  15.0        </span>
<span class="go"> 6.0  null        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling sum with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_sum</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_sum</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_sum </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         u32             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0               </span>
<span class="go"> 1      2001-01-01 01:00:00  1               </span>
<span class="go"> 2      2001-01-01 02:00:00  3               </span>
<span class="go"> 3      2001-01-01 03:00:00  5               </span>
<span class="go"> 4      2001-01-01 04:00:00  7               </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  39              </span>
<span class="go"> 21     2001-01-01 21:00:00  41              </span>
<span class="go"> 22     2001-01-01 22:00:00  43              </span>
<span class="go"> 23     2001-01-01 23:00:00  45              </span>
<span class="go"> 24     2001-01-02 00:00:00  47              </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling sum with the closure of windows on both sides</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_sum</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_sum</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_sum </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         u32             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0               </span>
<span class="go"> 1      2001-01-01 01:00:00  1               </span>
<span class="go"> 2      2001-01-01 02:00:00  3               </span>
<span class="go"> 3      2001-01-01 03:00:00  6               </span>
<span class="go"> 4      2001-01-01 04:00:00  9               </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  57              </span>
<span class="go"> 21     2001-01-01 21:00:00  60              </span>
<span class="go"> 22     2001-01-01 22:00:00  63              </span>
<span class="go"> 23     2001-01-01 23:00:00  66              </span>
<span class="go"> 24     2001-01-02 00:00:00  69              </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_sum_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6974-L7133"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply a rolling sum based on another column.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>Given a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result.</p>
</dd>
<dt><strong>by</strong></dt><dd><p>This column must of dtype <code class="code docutils literal notranslate"><span class="pre">{Date,</span> <span class="pre">Datetime}</span></code></p>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive),
defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>.</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.27: </span>This operation no longer requires sorted data, you can safely remove
the <code class="code docutils literal notranslate"><span class="pre">warn_if_unsorted</span></code> argument.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling sum with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_sum</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_sum_by</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_sum </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         u32             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0               </span>
<span class="go"> 1      2001-01-01 01:00:00  1               </span>
<span class="go"> 2      2001-01-01 02:00:00  3               </span>
<span class="go"> 3      2001-01-01 03:00:00  5               </span>
<span class="go"> 4      2001-01-01 04:00:00  7               </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  39              </span>
<span class="go"> 21     2001-01-01 21:00:00  41              </span>
<span class="go"> 22     2001-01-01 22:00:00  43              </span>
<span class="go"> 23     2001-01-01 23:00:00  45              </span>
<span class="go"> 24     2001-01-02 00:00:00  47              </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling sum with the closure of windows on both sides</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_sum</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_sum_by</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_sum </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         u32             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  0               </span>
<span class="go"> 1      2001-01-01 01:00:00  1               </span>
<span class="go"> 2      2001-01-01 02:00:00  3               </span>
<span class="go"> 3      2001-01-01 03:00:00  6               </span>
<span class="go"> 4      2001-01-01 04:00:00  9               </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  57              </span>
<span class="go"> 21     2001-01-01 21:00:00  60              </span>
<span class="go"> 22     2001-01-01 22:00:00  63              </span>
<span class="go"> 23     2001-01-01 23:00:00  66              </span>
<span class="go"> 24     2001-01-02 00:00:00  69              </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_var</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ddof</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L9029-L9286"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute a rolling variance.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>If <code class="code docutils literal notranslate"><span class="pre">by</span></code> has not been specified (the default), the window at a given row will
include the row itself, and the <code class="code docutils literal notranslate"><span class="pre">window_size</span> <span class="pre">-</span> <span class="pre">1</span></code> elements before it.</p>
<p>If you pass a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a fixed integer size, or a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
<li><p>1i    (1 index count)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
<p>If a timedelta or the dynamic string language is used, the <code class="code docutils literal notranslate"><span class="pre">by</span></code>
and <code class="code docutils literal notranslate"><span class="pre">closed</span></code> arguments must also be set.</p>
</dd>
<dt><strong>weights</strong></dt><dd><p>An optional slice with the same length as the window that determines the
relative contribution of each value in a window to the output.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result. If None, it will be set equal to:</p>
<ul class="simple">
<li><p>the window size, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a fixed integer</p></li>
<li><p>1, if <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is a dynamic temporal size</p></li>
</ul>
</dd>
<dt><strong>center</strong></dt><dd><p>Set the labels at the center of the window</p>
</dd>
<dt><strong>by</strong></dt><dd><p>If the <code class="code docutils literal notranslate"><span class="pre">window_size</span></code> is temporal for instance <code class="code docutils literal notranslate"><span class="pre">&quot;5h&quot;</span></code> or <code class="code docutils literal notranslate"><span class="pre">&quot;3s&quot;</span></code>, you must
set the column that will be used to determine the windows. This column must
be of dtype Datetime or Date.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.24: </span>Passing <code class="code docutils literal notranslate"><span class="pre">by</span></code> to <code class="code docutils literal notranslate"><span class="pre">rolling_var</span></code> is deprecated - please use
<a class="reference internal" href="api/polars.Expr.rolling_var_by.html#polars.Expr.rolling_var_by" title="polars.Expr.rolling_var_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rolling_var_by()</span></code></a> instead.</p>
</div>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive); only
applicable if <code class="code docutils literal notranslate"><span class="pre">by</span></code> has been set (in which case, it defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>).</p>
</dd>
<dt><strong>ddof</strong></dt><dd><p>Delta Degrees of Freedom: The divisor for a length N window is N - ddof</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column (if passed).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_var</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_var</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_var </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  0.5         </span>
<span class="go"> 3.0  0.5         </span>
<span class="go"> 4.0  0.5         </span>
<span class="go"> 5.0  0.5         </span>
<span class="go"> 6.0  0.5         </span>
<span class="go"></span>
</pre></div>
</div>
<p>Specify weights to multiply the values in the window with:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_var</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_var</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_var </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  0.1875      </span>
<span class="go"> 3.0  0.1875      </span>
<span class="go"> 4.0  0.1875      </span>
<span class="go"> 5.0  0.1875      </span>
<span class="go"> 6.0  0.1875      </span>
<span class="go"></span>
</pre></div>
</div>
<p>Center the values in the window</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_var</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_var</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (6, 2)</span>
<span class="go"></span>
<span class="go"> A    rolling_var </span>
<span class="go"> ---  ---         </span>
<span class="go"> f64  f64         </span>
<span class="go"></span>
<span class="go"> 1.0  null        </span>
<span class="go"> 2.0  1.0         </span>
<span class="go"> 3.0  1.0         </span>
<span class="go"> 4.0  1.0         </span>
<span class="go"> 5.0  1.0         </span>
<span class="go"> 6.0  null        </span>
<span class="go"></span>
</pre></div>
</div>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling var with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_var</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_var</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_var </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         f64             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  null            </span>
<span class="go"> 1      2001-01-01 01:00:00  0.5             </span>
<span class="go"> 2      2001-01-01 02:00:00  0.5             </span>
<span class="go"> 3      2001-01-01 03:00:00  0.5             </span>
<span class="go"> 4      2001-01-01 04:00:00  0.5             </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  0.5             </span>
<span class="go"> 21     2001-01-01 21:00:00  0.5             </span>
<span class="go"> 22     2001-01-01 22:00:00  0.5             </span>
<span class="go"> 23     2001-01-01 23:00:00  0.5             </span>
<span class="go"> 24     2001-01-02 00:00:00  0.5             </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling var with the closure of windows on both sides</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_var</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_var</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_var </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         f64             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  null            </span>
<span class="go"> 1      2001-01-01 01:00:00  0.5             </span>
<span class="go"> 2      2001-01-01 02:00:00  1.0             </span>
<span class="go"> 3      2001-01-01 03:00:00  1.0             </span>
<span class="go"> 4      2001-01-01 04:00:00  1.0             </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  1.0             </span>
<span class="go"> 21     2001-01-01 21:00:00  1.0             </span>
<span class="go"> 22     2001-01-01 22:00:00  1.0             </span>
<span class="go"> 23     2001-01-01 23:00:00  1.0             </span>
<span class="go"> 24     2001-01-02 00:00:00  1.0             </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">rolling_var_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">timedelta</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClosedInterval</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ddof</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">warn_if_unsorted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L7305-L7473"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute a rolling variance based on another column.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functionality is considered <strong>unstable</strong>. It may be changed
at any point without it being considered a breaking change.</p>
</div>
<p>Given a <code class="code docutils literal notranslate"><span class="pre">by</span></code> column <code class="code docutils literal notranslate"><span class="pre">&lt;t_0,</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">t_n&gt;</span></code>, then <code class="code docutils literal notranslate"><span class="pre">closed=&quot;right&quot;</span></code>
(the default) means the windows will be:</p>
<blockquote>
<div><ul class="simple">
<li><p>(t_0 - window_size, t_0]</p></li>
<li><p>(t_1 - window_size, t_1]</p></li>
<li><p></p></li>
<li><p>(t_n - window_size, t_n]</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>by</strong></dt><dd><p>This column must be of dtype Datetime or Date.</p>
</dd>
<dt><strong>window_size</strong></dt><dd><p>The length of the window. Can be a dynamic temporal
size indicated by a timedelta or the following string language:</p>
<ul class="simple">
<li><p>1ns   (1 nanosecond)</p></li>
<li><p>1us   (1 microsecond)</p></li>
<li><p>1ms   (1 millisecond)</p></li>
<li><p>1s    (1 second)</p></li>
<li><p>1m    (1 minute)</p></li>
<li><p>1h    (1 hour)</p></li>
<li><p>1d    (1 calendar day)</p></li>
<li><p>1w    (1 calendar week)</p></li>
<li><p>1mo   (1 calendar month)</p></li>
<li><p>1q    (1 calendar quarter)</p></li>
<li><p>1y    (1 calendar year)</p></li>
</ul>
<p>By calendar day, we mean the corresponding time on the next day
(which may not be 24 hours, due to daylight savings). Similarly for
calendar week, calendar month, calendar quarter, and
calendar year.</p>
</dd>
<dt><strong>min_periods</strong></dt><dd><p>The number of values in the window that should be non-null before computing
a result.</p>
</dd>
<dt><strong>closed</strong><span class="classifier">{left, right, both, none}</span></dt><dd><p>Define which sides of the temporal interval are closed (inclusive),
defaults to <code class="code docutils literal notranslate"><span class="pre">'right'</span></code>.</p>
</dd>
<dt><strong>ddof</strong></dt><dd><p>Delta Degrees of Freedom: The divisor for a length N window is N - ddof</p>
</dd>
<dt><strong>warn_if_unsorted</strong></dt><dd><p>Warn if data is not known to be sorted by <code class="code docutils literal notranslate"><span class="pre">by</span></code> column.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.27: </span>This operation no longer requires sorted data, you can safely remove
the <code class="code docutils literal notranslate"><span class="pre">warn_if_unsorted</span></code> argument.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If you want to compute multiple aggregation statistics over the same dynamic
window, consider using <code class="code docutils literal notranslate"><span class="pre">rolling</span></code> - this method can cache the window size
computation.</p>
<p class="rubric">Examples</p>
<p>Create a DataFrame with a datetime column and a row number column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">datetime_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span>
<span class="go">shape: (25, 2)</span>
<span class="go"></span>
<span class="go"> index  date                </span>
<span class="go"> ---    ---                 </span>
<span class="go"> u32    datetime[s]        </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00 </span>
<span class="go"> 1      2001-01-01 01:00:00 </span>
<span class="go"> 2      2001-01-01 02:00:00 </span>
<span class="go"> 3      2001-01-01 03:00:00 </span>
<span class="go"> 4      2001-01-01 04:00:00 </span>
<span class="go">                          </span>
<span class="go"> 20     2001-01-01 20:00:00 </span>
<span class="go"> 21     2001-01-01 21:00:00 </span>
<span class="go"> 22     2001-01-01 22:00:00 </span>
<span class="go"> 23     2001-01-01 23:00:00 </span>
<span class="go"> 24     2001-01-02 00:00:00 </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling var with the temporal windows closed on the right (default)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_var</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_var_by</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_var </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         f64             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  null            </span>
<span class="go"> 1      2001-01-01 01:00:00  0.5             </span>
<span class="go"> 2      2001-01-01 02:00:00  0.5             </span>
<span class="go"> 3      2001-01-01 03:00:00  0.5             </span>
<span class="go"> 4      2001-01-01 04:00:00  0.5             </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  0.5             </span>
<span class="go"> 21     2001-01-01 21:00:00  0.5             </span>
<span class="go"> 22     2001-01-01 22:00:00  0.5             </span>
<span class="go"> 23     2001-01-01 23:00:00  0.5             </span>
<span class="go"> 24     2001-01-02 00:00:00  0.5             </span>
<span class="go"></span>
</pre></div>
</div>
<p>Compute the rolling var with the closure of windows on both sides</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_temporal</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">rolling_row_var</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_var_by</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="s2">&quot;2h&quot;</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (25, 3)</span>
<span class="go"></span>
<span class="go"> index  date                 rolling_row_var </span>
<span class="go"> ---    ---                  ---             </span>
<span class="go"> u32    datetime[s]         f64             </span>
<span class="go"></span>
<span class="go"> 0      2001-01-01 00:00:00  null            </span>
<span class="go"> 1      2001-01-01 01:00:00  0.5             </span>
<span class="go"> 2      2001-01-01 02:00:00  1.0             </span>
<span class="go"> 3      2001-01-01 03:00:00  1.0             </span>
<span class="go"> 4      2001-01-01 04:00:00  1.0             </span>
<span class="go">                                          </span>
<span class="go"> 20     2001-01-01 20:00:00  1.0             </span>
<span class="go"> 21     2001-01-01 21:00:00  1.0             </span>
<span class="go"> 22     2001-01-01 22:00:00  1.0             </span>
<span class="go"> 23     2001-01-01 23:00:00  1.0             </span>
<span class="go"> 24     2001-01-02 00:00:00  1.0             </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">round</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1809-L1834"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Round underlying floating point data by <code class="code docutils literal notranslate"><span class="pre">decimals</span></code> digits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>decimals</strong></dt><dd><p>Number of decimals to round by.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="mf">1.17</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 0.3 </span>
<span class="go"> 0.5 </span>
<span class="go"> 1.0 </span>
<span class="go"> 1.2 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">round_sig_figs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">digits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1836-L1860"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Round to a number of significant figures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>digits</strong></dt><dd><p>Number of significant figures to round to.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01234</span><span class="p">,</span> <span class="mf">3.333</span><span class="p">,</span> <span class="mf">1234.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">round_sig_figs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;round_sig_figs&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> a        round_sig_figs </span>
<span class="go"> ---      ---            </span>
<span class="go"> f64      f64            </span>
<span class="go"></span>
<span class="go"> 0.01234  0.012          </span>
<span class="go"> 3.333    3.3            </span>
<span class="go"> 1234.0   1200.0         </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">with_replacement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10676-L10733"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Sample from this expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong></dt><dd><p>Number of items to return. Cannot be used with <code class="code docutils literal notranslate"><span class="pre">fraction</span></code>. Defaults to 1 if
<code class="code docutils literal notranslate"><span class="pre">fraction</span></code> is None.</p>
</dd>
<dt><strong>fraction</strong></dt><dd><p>Fraction of items to return. Cannot be used with <code class="code docutils literal notranslate"><span class="pre">n</span></code>.</p>
</dd>
<dt><strong>with_replacement</strong></dt><dd><p>Allow values to be sampled more than once.</p>
</dd>
<dt><strong>shuffle</strong></dt><dd><p>Shuffle the order of sampled data points.</p>
</dd>
<dt><strong>seed</strong></dt><dd><p>Seed for the random number generator. If set to None (default), a
random seed is generated for each sample operation.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">fraction</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 3   </span>
<span class="go"> 1   </span>
<span class="go"> 1   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">search_sorted</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">np.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SearchSortedSide</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'any'</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L2730-L2771"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Find indices where elements should be inserted to maintain order.</p>
<div class="math notranslate nohighlight">
\[a[i-1] &lt; v &lt;= a[i]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>element</strong></dt><dd><p>Expression or scalar value.</p>
</dd>
<dt><strong>side</strong><span class="classifier">{any, left, right}</span></dt><dd><p>If any, the index of the first suitable location found is given.
If left, the index of the leftmost suitable location found is given.
If right, return the rightmost suitable location found is given.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">search_sorted</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;zero&quot;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">search_sorted</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;three&quot;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">search_sorted</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;six&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (1, 3)</span>
<span class="go"></span>
<span class="go"> zero  three  six </span>
<span class="go"> ---   ---    --- </span>
<span class="go"> u32   u32    u32 </span>
<span class="go"></span>
<span class="go"> 0     2      4   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">set_sorted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descending</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11419-L11448"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Flags the expression as sorted.</p>
<p>Enables downstream code to user fast paths for sorted arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>descending</strong></dt><dd><p>Whether the <code class="code docutils literal notranslate"><span class="pre">Series</span></code> order is descending.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This can lead to incorrect results if this <code class="code docutils literal notranslate"><span class="pre">Series</span></code> is not sorted!!
Use with care!</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_sorted</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> values </span>
<span class="go"> ---    </span>
<span class="go"> i64    </span>
<span class="go"></span>
<span class="go"> 3      </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3014-L3090"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Shift values by the given number of indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong></dt><dd><p>Number of indices to shift forward. If a negative value is passed, values
are shifted in the opposite direction instead.</p>
</dd>
<dt><strong>fill_value</strong></dt><dd><p>Fill the resulting null values with this value.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.backward_fill.html#polars.Expr.backward_fill" title="polars.Expr.backward_fill"><code class="xref py py-obj docutils literal notranslate"><span class="pre">backward_fill</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.forward_fill.html#polars.Expr.forward_fill" title="polars.Expr.forward_fill"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward_fill</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This method is similar to the <code class="code docutils literal notranslate"><span class="pre">LAG</span></code> operation in SQL when the value for <code class="code docutils literal notranslate"><span class="pre">n</span></code>
is positive. With a negative value for <code class="code docutils literal notranslate"><span class="pre">n</span></code>, it is similar to <code class="code docutils literal notranslate"><span class="pre">LEAD</span></code>.</p>
<p class="rubric">Examples</p>
<p>By default, values are shifted forward by one index.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="go">shape: (4, 2)</span>
<span class="go"></span>
<span class="go"> a    shift </span>
<span class="go"> ---  ---   </span>
<span class="go"> i64  i64   </span>
<span class="go"></span>
<span class="go"> 1    null  </span>
<span class="go"> 2    1     </span>
<span class="go"> 3    2     </span>
<span class="go"> 4    3     </span>
<span class="go"></span>
</pre></div>
</div>
<p>Pass a negative value to shift in the opposite direction instead.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">shape: (4, 2)</span>
<span class="go"></span>
<span class="go"> a    shift </span>
<span class="go"> ---  ---   </span>
<span class="go"> i64  i64   </span>
<span class="go"></span>
<span class="go"> 1    3     </span>
<span class="go"> 2    4     </span>
<span class="go"> 3    null  </span>
<span class="go"> 4    null  </span>
<span class="go"></span>
</pre></div>
</div>
<p>Specify <code class="code docutils literal notranslate"><span class="pre">fill_value</span></code> to fill the resulting null values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="go">shape: (4, 2)</span>
<span class="go"></span>
<span class="go"> a    shift </span>
<span class="go"> ---  ---   </span>
<span class="go"> i64  i64   </span>
<span class="go"></span>
<span class="go"> 1    3     </span>
<span class="go"> 2    4     </span>
<span class="go"> 3    100   </span>
<span class="go"> 4    100   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">shift_and_fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11911-L11932"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Shift values by the given number of places and fill the resulting null values.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.12: </span>Use <a class="reference internal" href="api/polars.Expr.shift.html#polars.Expr.shift" title="polars.Expr.shift"><code class="xref py py-func docutils literal notranslate"><span class="pre">shift()</span></code></a> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fill_value</strong></dt><dd><p>Fill None values with the result of this expression.</p>
</dd>
<dt><strong>n</strong></dt><dd><p>Number of places to shift (may be negative).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">shrink_dtype</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11450-L11482"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Shrink numeric columns to the minimal required datatype.</p>
<p>Shrink to the dtype needed to fit the extrema of this [<code class="code docutils literal notranslate"><span class="pre">Series</span></code>].
This can be used to reduce memory pressure.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">30</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">112</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">112</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">112</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">129</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;g&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.32</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">shrink_dtype</span><span class="p">())</span>
<span class="go">shape: (3, 8)</span>
<span class="go"></span>
<span class="go"> a    b           c           d     e     f    g     h     </span>
<span class="go"> ---  ---         ---         ---   ---   ---  ---   ---   </span>
<span class="go"> i8   i64         i32         i8    i16   str  f32   bool  </span>
<span class="go"></span>
<span class="go"> 1    1           -1          -112  -112  a    0.1   true  </span>
<span class="go"> 2    2           2           2     2     b    1.32  null  </span>
<span class="go"> 3    8589934592  1073741824  112   129   c    0.12  false </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">shuffle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10649-L10674"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Shuffle the contents of this expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>seed</strong></dt><dd><p>Seed for the random number generator. If set to None (default), a
random seed is generated each time the shuffle is called.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 2   </span>
<span class="go"> 1   </span>
<span class="go"> 3   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sign</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10195-L10224"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise indication of the sign.</p>
<p>The returned values can be -1, 0, or 1:</p>
<ul class="simple">
<li><p>-1 if x  &lt; 0.</p></li>
<li><p>0 if x == 0.</p></li>
<li><p>1 if x  &gt; 0.</p></li>
</ul>
<p>(null values are preserved as-is).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">9.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sign</span><span class="p">())</span>
<span class="go">shape: (5, 1)</span>
<span class="go"></span>
<span class="go"> a    </span>
<span class="go"> ---  </span>
<span class="go"> i64  </span>
<span class="go"></span>
<span class="go"> -1   </span>
<span class="go"> 0    </span>
<span class="go"> 0    </span>
<span class="go"> 1    </span>
<span class="go"> null </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10226-L10248"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the sine.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sin</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 0.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sinh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10394-L10416"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the hyperbolic sine.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sinh</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 1.175201 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">skew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L9998-L10049"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the sample skewness of a data set.</p>
<p>For normally distributed data, the skewness should be about zero. For
unimodal continuous distributions, a skewness value greater than zero means
that there is more weight in the right tail of the distribution. The
function <code class="code docutils literal notranslate"><span class="pre">skewtest</span></code> can be used to determine if the skewness value
is close enough to zero, statistically speaking.</p>
<p>See scipy.stats for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>bias</strong><span class="classifier">bool, optional</span></dt><dd><p>If False, the calculations are corrected for statistical bias.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The sample skewness is computed as the Fisher-Pearson coefficient
of skewness, i.e.</p>
<div class="math notranslate nohighlight">
\[g_1=\frac{m_3}{m_2^{3/2}}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[m_i=\frac{1}{N}\sum_{n=1}^N(x[n]-\bar{x})^i\]</div>
<p>is the biased sample <span class="math notranslate nohighlight">\(i\texttt{th}\)</span> central moment, and
<span class="math notranslate nohighlight">\(\bar{x}\)</span> is
the sample mean.  If <code class="code docutils literal notranslate"><span class="pre">bias</span></code> is False, the calculations are
corrected for bias and the value computed is the adjusted
Fisher-Pearson standardized moment coefficient, i.e.</p>
<div class="math notranslate nohighlight">
\[G_1 = \frac{k_3}{k_2^{3/2}} = \frac{\sqrt{N(N-1)}}{N-2}\frac{m_3}{m_2^{3/2}}\]</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">skew</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 0.343622 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1389-L1424"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get a slice of this expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>offset</strong></dt><dd><p>Start index. Negative indexing is supported.</p>
</dd>
<dt><strong>length</strong></dt><dd><p>Length of the slice. If set to <code class="code docutils literal notranslate"><span class="pre">None</span></code>, all rows starting at the offset
will be selected.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> a    b   </span>
<span class="go"> ---  --- </span>
<span class="go"> i64  i64 </span>
<span class="go"></span>
<span class="go"> 9    4   </span>
<span class="go"> 10   4   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descending</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nulls_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L1959-L2036"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Sort this column.</p>
<p>When used in a projection/selection context, the whole column is sorted.
When used in a group by context, the groups are sorted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>descending</strong></dt><dd><p>Sort in descending order.</p>
</dd>
<dt><strong>nulls_last</strong></dt><dd><p>Place null values last.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">())</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> a    </span>
<span class="go"> ---  </span>
<span class="go"> i64  </span>
<span class="go"></span>
<span class="go"> null </span>
<span class="go"> 1    </span>
<span class="go"> 2    </span>
<span class="go"> 3    </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> a    </span>
<span class="go"> ---  </span>
<span class="go"> i64  </span>
<span class="go"></span>
<span class="go"> null </span>
<span class="go"> 3    </span>
<span class="go"> 2    </span>
<span class="go"> 1    </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">nulls_last</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> a    </span>
<span class="go"> ---  </span>
<span class="go"> i64  </span>
<span class="go"></span>
<span class="go"> 1    </span>
<span class="go"> 2    </span>
<span class="go"> 3    </span>
<span class="go"> null </span>
<span class="go"></span>
</pre></div>
</div>
<p>When sorting in a group by context, the groups are sorted.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">())</span>  
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> group  value      </span>
<span class="go"> ---    ---        </span>
<span class="go"> str    list[i64]  </span>
<span class="go"></span>
<span class="go"> two    [3, 4, 99] </span>
<span class="go"> one    [1, 2, 98] </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sort_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">IntoExpr</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">more_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">descending</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">nulls_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">multithreaded</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">maintain_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L2773-L2913"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Sort this column by the ordering of other columns.</p>
<p>When used in a projection/selection context, the whole column is sorted.
When used in a group by context, the groups are sorted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>by</strong></dt><dd><p>Column(s) to sort by. Accepts expression input. Strings are parsed as column
names.</p>
</dd>
<dt><strong>*more_by</strong></dt><dd><p>Additional columns to sort by, specified as positional arguments.</p>
</dd>
<dt><strong>descending</strong></dt><dd><p>Sort in descending order. When sorting by multiple columns, can be specified
per column by passing a sequence of booleans.</p>
</dd>
<dt><strong>nulls_last</strong></dt><dd><p>Place null values last; can specify a single boolean applying to all columns
or a sequence of booleans for per-column control.</p>
</dd>
<dt><strong>multithreaded</strong></dt><dd><p>Sort using multiple threads.</p>
</dd>
<dt><strong>maintain_order</strong></dt><dd><p>Whether the order should be maintained if elements are equal.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Pass a single column name to sort by that column.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;value1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;value2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="s2">&quot;value1&quot;</span><span class="p">))</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> group </span>
<span class="go"> ---   </span>
<span class="go"> str   </span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"> b     </span>
<span class="go"> a     </span>
<span class="go"> b     </span>
<span class="go"></span>
</pre></div>
</div>
<p>Sorting by expressions is also supported.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value1&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value2&quot;</span><span class="p">)))</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> group </span>
<span class="go"> ---   </span>
<span class="go"> str   </span>
<span class="go"></span>
<span class="go"> b     </span>
<span class="go"> a     </span>
<span class="go"> a     </span>
<span class="go"> b     </span>
<span class="go"></span>
</pre></div>
</div>
<p>Sort by multiple columns by passing a list of columns.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_by</span><span class="p">([</span><span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="s2">&quot;value2&quot;</span><span class="p">],</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> group </span>
<span class="go"> ---   </span>
<span class="go"> str   </span>
<span class="go"></span>
<span class="go"> b     </span>
<span class="go"> a     </span>
<span class="go"> b     </span>
<span class="go"> a     </span>
<span class="go"></span>
</pre></div>
</div>
<p>Or use positional arguments to sort by multiple columns in the same way.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="s2">&quot;value2&quot;</span><span class="p">))</span>
<span class="go">shape: (4, 1)</span>
<span class="go"></span>
<span class="go"> group </span>
<span class="go"> ---   </span>
<span class="go"> str   </span>
<span class="go"></span>
<span class="go"> a     </span>
<span class="go"> b     </span>
<span class="go"> a     </span>
<span class="go"> b     </span>
<span class="go"></span>
</pre></div>
</div>
<p>When sorting in a group by context, the groups are sorted.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="s2">&quot;value2&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (2, 2)</span>
<span class="go"></span>
<span class="go"> group  value1    </span>
<span class="go"> ---    ---       </span>
<span class="go"> str    list[i64] </span>
<span class="go"></span>
<span class="go"> a      [3, 1]    </span>
<span class="go"> b      [2, 4]    </span>
<span class="go"></span>
</pre></div>
</div>
<p>Take a single row from each group where a column attains its minimal value
within that group.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="s2">&quot;value2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="gp">... </span><span class="p">)</span>  
<span class="go">shape: (2, 3)</span>
<span class="go"></span>
<span class="go"> group  value1  value2 |</span>
<span class="go"> ---    ---     ---    </span>
<span class="go"> str    i64     i64    |</span>
<span class="go"></span>
<span class="go"> a      3       7      |</span>
<span class="go"> b      2       5      |</span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sqrt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L569-L588"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the square root of the elements.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;values&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">())</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> values   </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 1.0      </span>
<span class="go"> 1.414214 </span>
<span class="go"> 2.0      </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ddof</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3360-L3384"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ddof</strong></dt><dd><p>Delta Degrees of Freedom: the divisor used in the calculation is N - ddof,
where N represents the number of elements.
By default ddof is 1.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 1.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5892-L5921"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of subtraction operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">-</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>Numeric literal or expression value.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x-2&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cum_sum</span><span class="p">())</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x-expr&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> x    x-2  x-expr </span>
<span class="go"> ---  ---  ---    </span>
<span class="go"> i64  i64  i64    </span>
<span class="go"></span>
<span class="go"> 0    -2   0      </span>
<span class="go"> 1    -1   0      </span>
<span class="go"> 2    0    -1     </span>
<span class="go"> 3    1    -3     </span>
<span class="go"> 4    2    -6     </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">suffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L804-L848"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Add a suffix to the root column name of the expression.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.12: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.name.suffix.html#polars.Expr.name.suffix" title="polars.Expr.name.suffix"><code class="xref py py-func docutils literal notranslate"><span class="pre">name.suffix()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>suffix</strong></dt><dd><p>Suffix to add to the root column name.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.prefix.html#polars.Expr.prefix" title="polars.Expr.prefix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prefix</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This will undo any previous renaming operations on the expression.</p>
<p>Due to implementation constraints, this method can only be called as the last
expression in a chain.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_reverse&quot;</span><span class="p">))</span>
<span class="go">shape: (3, 4)</span>
<span class="go"></span>
<span class="go"> a    b    a_reverse  b_reverse </span>
<span class="go"> ---  ---  ---        ---       </span>
<span class="go"> i64  str  i64        str       </span>
<span class="go"></span>
<span class="go"> 1    x    3          z         </span>
<span class="go"> 2    y    2          y         </span>
<span class="go"> 3    z    1          x         </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3494-L3516"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get sum value.</p>
<p class="rubric">Notes</p>
<p>Dtypes in {Int8, UInt8, Int16, UInt16} are cast to
Int64 before summing to prevent overflow issues.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go">  0  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">tail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5278-L5303"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get the last <code class="code docutils literal notranslate"><span class="pre">n</span></code> rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong></dt><dd><p>Number of rows to return.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> foo </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 5   </span>
<span class="go"> 6   </span>
<span class="go"> 7   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">take</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Expr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">np.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L12059-L12074"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Take values by index.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.14: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.gather.html#polars.Expr.gather" title="polars.Expr.gather"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gather()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>indices</strong></dt><dd><p>An expression that leads to a UInt32 dtyped Series.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">take_every</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L12042-L12057"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Take every nth value in the Series and return as a new Series.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.19.14: </span>This method has been renamed to <a class="reference internal" href="api/polars.Expr.gather_every.html#polars.Expr.gather_every" title="polars.Expr.gather_every"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gather_every()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong></dt><dd><p>Gather every <em>n</em>-th row.</p>
</dd>
<dt><strong>offset</strong></dt><dd><p>Starting index.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">tan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10274-L10296"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the tangent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tan</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a    </span>
<span class="go"> ---  </span>
<span class="go"> f64  </span>
<span class="go"></span>
<span class="go"> 1.56 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">tanh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10442-L10464"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute the element-wise value for the hyperbolic tangent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tanh</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a        </span>
<span class="go"> ---      </span>
<span class="go"> f64      </span>
<span class="go"></span>
<span class="go"> 0.761594 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">to_physical</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L380-L421"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Cast to physical representation of the logical dtype.</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api/polars.datatypes.Date.html#polars.datatypes.Date" title="polars.datatypes.Date"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.datatypes.Date()</span></code></a> -&gt; <a class="reference internal" href="../api/polars.datatypes.Int32.html#polars.datatypes.Int32" title="polars.datatypes.Int32"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.datatypes.Int32()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/polars.datatypes.Datetime.html#polars.datatypes.Datetime" title="polars.datatypes.Datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.datatypes.Datetime()</span></code></a> -&gt; <a class="reference internal" href="../api/polars.datatypes.Int64.html#polars.datatypes.Int64" title="polars.datatypes.Int64"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.datatypes.Int64()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/polars.datatypes.Time.html#polars.datatypes.Time" title="polars.datatypes.Time"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.datatypes.Time()</span></code></a> -&gt; <a class="reference internal" href="../api/polars.datatypes.Int64.html#polars.datatypes.Int64" title="polars.datatypes.Int64"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.datatypes.Int64()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/polars.datatypes.Duration.html#polars.datatypes.Duration" title="polars.datatypes.Duration"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.datatypes.Duration()</span></code></a> -&gt; <a class="reference internal" href="../api/polars.datatypes.Int64.html#polars.datatypes.Int64" title="polars.datatypes.Int64"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.datatypes.Int64()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/polars.datatypes.Categorical.html#polars.datatypes.Categorical" title="polars.datatypes.Categorical"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.datatypes.Categorical()</span></code></a> -&gt; <a class="reference internal" href="../api/polars.datatypes.UInt32.html#polars.datatypes.UInt32" title="polars.datatypes.UInt32"><code class="xref py py-func docutils literal notranslate"><span class="pre">polars.datatypes.UInt32()</span></code></a></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">List(inner)</span></code> -&gt; <code class="code docutils literal notranslate"><span class="pre">List(physical</span> <span class="pre">of</span> <span class="pre">inner)</span></code></p></li>
</ul>
<p>Other data types will be left unchanged.</p>
<p class="rubric">Examples</p>
<p>Replicating the pandas
<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.factorize.html">pd.factorize</a>
function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;vals&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">]})</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;vals&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Categorical</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;vals&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Categorical</span><span class="p">)</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">to_physical</span><span class="p">()</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;vals_physical&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 2)</span>
<span class="go"></span>
<span class="go"> vals  vals_physical </span>
<span class="go"> ---   ---           </span>
<span class="go"> cat   u32           </span>
<span class="go"></span>
<span class="go"> a     0             </span>
<span class="go"> x     1             </span>
<span class="go"> null  null          </span>
<span class="go"> a     0             </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">top_k</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">nulls_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">maintain_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">multithreaded</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L2038-L2151"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return the <code class="code docutils literal notranslate"><span class="pre">k</span></code> largest elements.</p>
<p>This has time complexity:</p>
<div class="math notranslate nohighlight">
\[O(n + k \log{n})\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>k</strong></dt><dd><p>Number of elements to return.</p>
</dd>
<dt><strong>nulls_last</strong></dt><dd><p>Place null values last.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.31: </span>This parameter will be removed in the next breaking release.
Null values will be considered lowest priority and will only be
included if <code class="code docutils literal notranslate"><span class="pre">k</span></code> is larger than the number of non-null elements.</p>
</div>
</dd>
<dt><strong>maintain_order</strong></dt><dd><p>Whether the order should be maintained if elements are equal.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.31: </span>This parameter will be removed in the next breaking release.
There will be no guarantees about the order of the output.</p>
</div>
</dd>
<dt><strong>multithreaded</strong></dt><dd><p>Sort using multiple threads.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.31: </span>This parameter will be removed in the next breaking release.
Polars itself will determine whether to use multithreading or not.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.top_k_by.html#polars.Expr.top_k_by" title="polars.Expr.top_k_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">top_k_by</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.bottom_k.html#polars.Expr.bottom_k" title="polars.Expr.bottom_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bottom_k</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.bottom_k_by.html#polars.Expr.bottom_k_by" title="polars.Expr.bottom_k_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bottom_k_by</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Get the 5 largest values in series.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">top_k</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;top_k&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bottom_k</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;bottom_k&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 2)</span>
<span class="go"></span>
<span class="go"> top_k  bottom_k </span>
<span class="go"> ---    ---      </span>
<span class="go"> i64    i64      </span>
<span class="go"></span>
<span class="go"> 99     1        </span>
<span class="go"> 98     2        </span>
<span class="go"> 4      3        </span>
<span class="go"> 3      4        </span>
<span class="go"> 2      98       </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">top_k_by</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntoExpr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">IntoExpr</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IntoExprColumn</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">descending</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">nulls_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">maintain_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">multithreaded</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L2153-L2334"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return the elements corresponding to the <code class="code docutils literal notranslate"><span class="pre">k</span></code> largest elements of the <code class="code docutils literal notranslate"><span class="pre">by</span></code> column(s).</p>
<p>This has time complexity:</p>
<div class="math notranslate nohighlight">
\[O(n + k \log{n})\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>by</strong></dt><dd><p>Column(s) used to determine the largest elements.
Accepts expression input. Strings are parsed as column names.</p>
</dd>
<dt><strong>k</strong></dt><dd><p>Number of elements to return.</p>
</dd>
<dt><strong>descending</strong></dt><dd><p>Consider the <code class="code docutils literal notranslate"><span class="pre">k</span></code> smallest elements of the <code class="code docutils literal notranslate"><span class="pre">by</span></code> column(s) (instead of the <code class="code docutils literal notranslate"><span class="pre">k</span></code>
largest). This can be specified per column by passing a sequence of
booleans.</p>
</dd>
<dt><strong>nulls_last</strong></dt><dd><p>Place null values last.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.31: </span>This parameter will be removed in the next breaking release.
Null values will be considered lowest priority and will only be
included if <code class="code docutils literal notranslate"><span class="pre">k</span></code> is larger than the number of non-null elements.</p>
</div>
</dd>
<dt><strong>maintain_order</strong></dt><dd><p>Whether the order should be maintained if elements are equal.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.31: </span>This parameter will be removed in the next breaking release.
There will be no guarantees about the order of the output.</p>
</div>
</dd>
<dt><strong>multithreaded</strong></dt><dd><p>Sort using multiple threads.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.31: </span>This parameter will be removed in the next breaking release.
Polars itself will determine whether to use multithreading or not.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.top_k.html#polars.Expr.top_k" title="polars.Expr.top_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">top_k</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.bottom_k.html#polars.Expr.bottom_k" title="polars.Expr.bottom_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bottom_k</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="api/polars.Expr.bottom_k_by.html#polars.Expr.bottom_k_by" title="polars.Expr.bottom_k_by"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bottom_k_by</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Apple&quot;</span><span class="p">,</span> <span class="s2">&quot;Orange&quot;</span><span class="p">,</span> <span class="s2">&quot;Apple&quot;</span><span class="p">,</span> <span class="s2">&quot;Apple&quot;</span><span class="p">,</span> <span class="s2">&quot;Banana&quot;</span><span class="p">,</span> <span class="s2">&quot;Banana&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (6, 3)</span>
<span class="go"></span>
<span class="go"> a    b    c      </span>
<span class="go"> ---  ---  ---    </span>
<span class="go"> i64  i64  str    </span>
<span class="go"></span>
<span class="go"> 1    6    Apple  </span>
<span class="go"> 2    5    Orange </span>
<span class="go"> 3    4    Apple  </span>
<span class="go"> 4    3    Apple  </span>
<span class="go"> 5    2    Banana </span>
<span class="go"> 6    1    Banana </span>
<span class="go"></span>
</pre></div>
</div>
<p>Get the top 2 rows by column <code class="code docutils literal notranslate"><span class="pre">a</span></code> or <code class="code docutils literal notranslate"><span class="pre">b</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">top_k_by</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_top_by_a&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">top_k_by</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_top_by_b&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (2, 6)</span>
<span class="go"></span>
<span class="go"> a_top_by_a  b_top_by_a  c_top_by_a  a_top_by_b  b_top_by_b  c_top_by_b </span>
<span class="go"> ---         ---         ---         ---         ---         ---        </span>
<span class="go"> i64         i64         str         i64         i64         str        </span>
<span class="go"></span>
<span class="go"> 6           1           Banana      1           6           Apple      </span>
<span class="go"> 5           2           Banana      2           5           Orange     </span>
<span class="go"></span>
</pre></div>
</div>
<p>Get the top 2 rows by multiple columns with given order.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">top_k_by</span><span class="p">([</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_by_ca&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">top_k_by</span><span class="p">([</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="p">(</span><span class="s2">&quot;_by_cb&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (2, 6)</span>
<span class="go"></span>
<span class="go"> a_by_ca  b_by_ca  c_by_ca  a_by_cb  b_by_cb  c_by_cb </span>
<span class="go"> ---      ---      ---      ---      ---      ---     </span>
<span class="go"> i64      i64      str      i64      i64      str     </span>
<span class="go"></span>
<span class="go"> 2        5        Orange   2        5        Orange  </span>
<span class="go"> 5        2        Banana   6        1        Banana  </span>
<span class="go"></span>
</pre></div>
</div>
<p>Get the top 2 rows by column <code class="code docutils literal notranslate"><span class="pre">a</span></code> in each group.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">maintain_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">top_k_by</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">))</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 3)</span>
<span class="go"></span>
<span class="go"> c       a    b   </span>
<span class="go"> ---     ---  --- </span>
<span class="go"> str     i64  i64 </span>
<span class="go"></span>
<span class="go"> Apple   4    3   </span>
<span class="go"> Apple   3    4   </span>
<span class="go"> Orange  2    5   </span>
<span class="go"> Banana  6    1   </span>
<span class="go"> Banana  5    2   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">truediv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L5945-L5987"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of float division operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">/</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>Numeric literal or expression value.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="api/polars.Expr.floordiv.html#polars.Expr.floordiv" title="polars.Expr.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">floordiv</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Zero-division behaviour follows IEEE-754:</p>
<p>0/0: Invalid operation - mathematically undefined, returns NaN.
n/0: On finite operands gives an exact infinite result, eg: infinity.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">truediv</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x/2&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">truediv</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x/y&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (5, 4)</span>
<span class="go"></span>
<span class="go"> x    y     x/2   x/y   </span>
<span class="go"> ---  ---   ---   ---   </span>
<span class="go"> i64  f64   f64   f64   </span>
<span class="go"></span>
<span class="go"> -2   0.5   -1.0  -4.0  </span>
<span class="go"> -1   0.0   -0.5  -inf  </span>
<span class="go"> 0    0.0   0.0   NaN   </span>
<span class="go"> 1    -4.0  0.5   -0.25 </span>
<span class="go"> 2    -0.5  1.0   -4.0  </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">unique</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maintain_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3721-L3756"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get unique values of this expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>maintain_order</strong></dt><dd><p>Maintain order of data. This requires more work.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>  
<span class="go">shape: (2, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 2   </span>
<span class="go"> 1   </span>
<span class="go"></span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">maintain_order</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">shape: (2, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> i64 </span>
<span class="go"></span>
<span class="go"> 1   </span>
<span class="go"> 2   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">unique_counts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11247-L11277"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return a count of the unique values in the order of appearance.</p>
<p>This method differs from <code class="code docutils literal notranslate"><span class="pre">value_counts</span></code> in that it does not return the
values, only the counts and might be faster</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unique_counts</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> id  </span>
<span class="go"> --- </span>
<span class="go"> u32 </span>
<span class="go"></span>
<span class="go"> 1   </span>
<span class="go"> 2   </span>
<span class="go"> 3   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">upper_bound</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L10173-L10193"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate the upper bound.</p>
<p>Returns a unit Series with the highest value possible for the dtype of this
expression.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a                   </span>
<span class="go"> ---                 </span>
<span class="go"> i64                 </span>
<span class="go"></span>
<span class="go"> 9223372036854775807 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">value_counts</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'count'</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L11174-L11245"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Count the occurrences of unique values.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>sort</strong></dt><dd><p>Sort the output by count in descending order.
If set to <code class="code docutils literal notranslate"><span class="pre">False</span></code> (default), the order of the output is random.</p>
</dd>
<dt><strong>parallel</strong></dt><dd><p>Execute the computation in parallel.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This option should likely not be enabled in a group by context,
as the computation is already parallelized per group.</p>
</div>
</dd>
<dt><strong>name</strong></dt><dd><p>Give the resulting count field a specific name; defaults to count.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Expr</dt><dd><p>Expression of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">Struct</span></code> with mapping of unique values to
their count.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>  
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> color       </span>
<span class="go"> ---         </span>
<span class="go"> struct[2]   </span>
<span class="go"></span>
<span class="go"> {&quot;red&quot;,2}   </span>
<span class="go"> {&quot;green&quot;,1} </span>
<span class="go"> {&quot;blue&quot;,3}  </span>
<span class="go"></span>
</pre></div>
</div>
<p>Sort the output by (descending) count and customize the count field name.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">shape: (3, 1)</span>
<span class="go"></span>
<span class="go"> color       </span>
<span class="go"> ---         </span>
<span class="go"> struct[2]   </span>
<span class="go"></span>
<span class="go"> {&quot;blue&quot;,3}  </span>
<span class="go"> {&quot;red&quot;,2}   </span>
<span class="go"> {&quot;green&quot;,1} </span>
<span class="go"></span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">unnest</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">)</span>
<span class="go">shape: (3, 2)</span>
<span class="go"></span>
<span class="go"> color  n   </span>
<span class="go"> ---    --- </span>
<span class="go"> str    u32 </span>
<span class="go"></span>
<span class="go"> blue   3   </span>
<span class="go"> red    2   </span>
<span class="go"> green  1   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ddof</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L3386-L3410"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ddof</strong></dt><dd><p>Delta Degrees of Freedom: the divisor used in the calculation is N - ddof,
where N represents the number of elements.
By default ddof is 1.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>
<span class="go">shape: (1, 1)</span>
<span class="go"></span>
<span class="go"> a   </span>
<span class="go"> --- </span>
<span class="go"> f64 </span>
<span class="go"></span>
<span class="go"> 1.0 </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">where</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expr</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L4639-L4678"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Filter a single column.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.20.4: </span>Use <a class="reference internal" href="api/polars.Expr.filter.html#polars.Expr.filter" title="polars.Expr.filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter()</span></code></a> instead.</p>
</div>
<p>Alias for <a class="reference internal" href="api/polars.Expr.filter.html#polars.Expr.filter" title="polars.Expr.filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predicate</strong></dt><dd><p>Boolean expression.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;group_col&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;g1&quot;</span><span class="p">,</span> <span class="s2">&quot;g1&quot;</span><span class="p">,</span> <span class="s2">&quot;g2&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;group_col&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>  
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;lt&quot;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;gte&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;group_col&quot;</span><span class="p">)</span>
<span class="go">shape: (2, 3)</span>
<span class="go"></span>
<span class="go"> group_col  lt   gte </span>
<span class="go"> ---        ---  --- </span>
<span class="go"> str        i64  i64 </span>
<span class="go"></span>
<span class="go"> g1         1    2   </span>
<span class="go"> g2         0    3   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">xor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/pola-rs/polars/blob/py-0.20.31/py-polars/polars/expr/expr.py#L6019-L6078"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Method equivalent of bitwise exclusive-or operator <code class="code docutils literal notranslate"><span class="pre">expr</span> <span class="pre">^</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong></dt><dd><p>Integer or boolean value; accepts expression input.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;x ^ y&quot;</span><span class="p">))</span>
<span class="go">shape: (4, 3)</span>
<span class="go"></span>
<span class="go"> x      y      x ^ y </span>
<span class="go"> ---    ---    ---   </span>
<span class="go"> bool   bool   bool  </span>
<span class="go"></span>
<span class="go"> true   true   false </span>
<span class="go"> false  true   true  </span>
<span class="go"> true   false  true  </span>
<span class="go"> false  false  false </span>
<span class="go"></span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">binary_string</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="nb">bin</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">66</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>    <span class="n">schema</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">UInt8</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">UInt8</span><span class="p">},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="n">binary_string</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;bin_x&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="n">binary_string</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;bin_y&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;xor_xy&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="n">binary_string</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;bin_xor_xy&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">shape: (4, 6)</span>
<span class="go"></span>
<span class="go"> x    y    bin_x     bin_y     xor_xy  bin_xor_xy </span>
<span class="go"> ---  ---  ---       ---       ---     ---        </span>
<span class="go"> u8   u8   str       str       u8      str        </span>
<span class="go"></span>
<span class="go"> 10   1    00001010  00000001  11      00001011   </span>
<span class="go"> 8    2    00001000  00000010  10      00001010   </span>
<span class="go"> 250  3    11111010  00000011  249     11111001   </span>
<span class="go"> 66   4    01000010  00000100  70      01000110   </span>
<span class="go"></span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../series/api/polars.Series.dt.year.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">polars.Series.dt.year</p>
      </div>
    </a>
    <a class="right-next"
       href="aggregation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Aggregation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
       Copyright 2020, Ritchie Vink.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.4.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>